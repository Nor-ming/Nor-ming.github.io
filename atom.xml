<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Nor-ming</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2022-05-13T13:44:03.463Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Alien Wan（924704640@qq.com)</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>利用QQ和Wireshark抓取对方IP</title>
    <link href="http://example.com/2022/05/13/%E5%88%A9%E7%94%A8QQ%E5%92%8CWireshark%E6%8A%93%E5%8F%96%E5%AF%B9%E6%96%B9IP/"/>
    <id>http://example.com/2022/05/13/%E5%88%A9%E7%94%A8QQ%E5%92%8CWireshark%E6%8A%93%E5%8F%96%E5%AF%B9%E6%96%B9IP/</id>
    <published>2022-05-13T13:11:02.894Z</published>
    <updated>2022-05-13T13:44:03.463Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape><br>首先打开wireshark，wireshark会开始自动抓包</p><p>打QQ电话给你的好友，让他接电话，当电话接通后，等几秒停止抓包（不等几秒也可以，等几秒比较保险）<br>停止键如下所示<br><img src="https://img-blog.csdnimg.cn/12a9fb78a24f4c3586e523efee7481b6.png" alt="在这里插入图片描述"><br>然后ctrl+F，这一栏这样填（020048是QQ UDP 72字节的报文头）<br><img src="https://img-blog.csdnimg.cn/a0a0aecdb6e24f889638c5ab9a8a89e4.png" alt="在这里插入图片描述"><br>点击查找，通过比对自己的ip，就大致可以锁定对方的ip<br><img src="https://img-blog.csdnimg.cn/cb394f679a8b4c7bb5d844b3171c2f52.png" alt="在这里插入图片描述"><br>如上图，我的ip是192.168.2.6，另外一个183的ip就是我的好友的<br>中间可能还参杂着其它一些ip，应该是中转的web服务器的地址<br><img src="https://img-blog.csdnimg.cn/777a5faab6a24a69bf05b52ab186dea9.png" alt="请添加图片描述"><br>查找ip就可以知道大致的位置</p><p>如果想要精确的查找可以看这篇博客<a href="https://blog.csdn.net/qq_38626043/article/details/104562289">https://blog.csdn.net/qq_38626043/article/details/104562289</a></p><p>以上，完成~</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="WEB学习" scheme="http://example.com/categories/WEB%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="WEB" scheme="http://example.com/tags/WEB/"/>
    
  </entry>
  
  <entry>
    <title>小皮面板安装以及pikachu环境搭建</title>
    <link href="http://example.com/2022/05/13/%E5%B0%8F%E7%9A%AE%E9%9D%A2%E6%9D%BF%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8Apikachu%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <id>http://example.com/2022/05/13/%E5%B0%8F%E7%9A%AE%E9%9D%A2%E6%9D%BF%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8Apikachu%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</id>
    <published>2022-05-13T13:10:37.199Z</published>
    <updated>2022-05-13T13:43:46.698Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>学校实验课（终于开始学网安了），学一下WEB</p><h2 id="小皮面板（phpstudy-安装"><a href="#小皮面板（phpstudy-安装" class="headerlink" title="小皮面板（phpstudy)安装"></a>小皮面板（phpstudy)安装</h2><p><img src="https://img-blog.csdnimg.cn/f2b60323fcfd49729b054a7618965511.png" alt="在这里插入图片描述"><br>这是一个PHP集成环境，比较方便<br>下载地址：<a href="https://www.xp.cn/">https://www.xp.cn/</a><br>我下载的是WINDOWS版本的<br>下载之后直接双击安装就好了<br>安装好后打开如下图所示<br><img src="https://img-blog.csdnimg.cn/c756f9051056418087878c94a09809e9.png" alt="在这里插入图片描述"></p><h2 id="pikachu靶场配置"><a href="#pikachu靶场配置" class="headerlink" title="pikachu靶场配置"></a>pikachu靶场配置</h2><p>pikachu下载地址：<a href="https://github.com/zhuifengshaonianhanlu/pikachu">https://github.com/zhuifengshaonianhanlu/pikachu</a><br>下载好后，将pikachu.zip放到phpstudy安装目录下的WWW文件夹下进行解压<br><img src="https://img-blog.csdnimg.cn/ec4ebb558edf4bf4961ca3905695682b.png" alt="在这里插入图片描述"><br>先在phpstudy里面看我们的数据库的用户名和密码：<br><img src="https://img-blog.csdnimg.cn/2bfe57b9f0e7494dbd132d10431024df.png" alt="在这里插入图片描述"></p><p>进入C:\phpstudy_pro\WWW\pikachu\inc目录中修改config.inc文件里的数据库用户名密码<br><img src="https://img-blog.csdnimg.cn/28082520392f4e589d5778a55573be2f.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5dab415cfc70434f9dc37cff4b90d458.png" alt="在这里插入图片描述"><br>保存</p><p>接下来我们可以开启Apache和mysql：<br><img src="https://img-blog.csdnimg.cn/a633aa1257674b9e8f0a847a8f881cc6.png" alt="在这里插入图片描述"></p><h3 id="当Apache无法启动，报错80端口被system占用的解决办法"><a href="#当Apache无法启动，报错80端口被system占用的解决办法" class="headerlink" title="当Apache无法启动，报错80端口被system占用的解决办法"></a>当Apache无法启动，报错80端口被system占用的解决办法</h3><p>方法一（不推荐）：<br>既然80 端口被占用，那我们换一个端口就可以了，不推荐的原因是因为不使用80可能会导致页面很多资源文件无法加载，不过这里还是介绍一下方法：<br>我们首先找到Apache所在的文件夹：<br>配置文件在这里<br><img src="https://img-blog.csdnimg.cn/d8e248951a1b4c4c9ecb1590566d0fe1.png" alt="在这里插入图片描述"><br>我们搜索到端口配置的部分：<br><img src="https://img-blog.csdnimg.cn/782fa3ca50a64ecc86895b8c06eb0555.png" alt="在这里插入图片描述"><br>可以看到现在是80，我们可以把它改成8080，然后保存<br>回到phpstudy，如图所示操作<br><img src="https://img-blog.csdnimg.cn/2cc7bbe071b542b0aa57cca3d3f84136.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/57860e7b72f940da80b7402163f77f05.png" alt="在这里插入图片描述"><br>这样就可以了</p><p>方法二：<br>一般来说，都是被 SQL Server 2008 里面的组件——SQL Server Reporting Services (MSSQLSERVER)占用的，我们找到它关掉就可以<br>win+R输入<code>services.msc</code>,找到SQL Server Reporting Services （图片中已经被我改过了）<br><img src="https://img-blog.csdnimg.cn/d20d0d442e944f6a914ef6b1e1dadb01.png" alt="在这里插入图片描述"><br>右键将它停止，然后再右键点击属性，改成手动，然后应用<br><img src="https://img-blog.csdnimg.cn/a677ff88041947f3b955cf7aef8f8537.png" alt="在这里插入图片描述"><br>这里说一下如何判断是被什么占用的</p><p>进入CMD（win+R输入cmd回车)，输入命令<code>netstat –ano</code>，就可以看到本机所有端口的使用情况，一般80端口在第一行，截图显示，端口已经被占用，PID中写明 LISTENING 4。<br><img src="https://img-blog.csdnimg.cn/9ffb479e47e74dee9d5c2eecf222abfc.png" alt="在这里插入图片描述"><br>接下来，在输入指令tasklist ，列出所有当前运行的进程，发现 PID=4 的进程是system 。<br><img src="https://img-blog.csdnimg.cn/63acf67d09fe4740b644f5902cf90ef8.png" alt="在这里插入图片描述"><br>这也是确定了我们确实是被system占用了，接下来看看具体是被什么占用了<br>使用命令<code>netsh http show servicestate</code>查看当前的http服务状态<br><img src="https://img-blog.csdnimg.cn/7bda1257bb174ee79a6d43eedd650feb.png" alt="在这里插入图片描述"><br>一般第一个箭头所指的地方会显示被占用的名称，这里由于我已经改好占用了，所以没有显示<br>图中可以看出进程ID为5436（这个一般不太一样），那么就继续查这个进程对应什么，进入任务管理器，找到PID5436的进程，右键转到服务，可以看到当前的进程所在的服务，如图所示：<br><img src="https://img-blog.csdnimg.cn/db20e45f21f94d489a059c91659872bf.png" alt="在这里插入图片描述"><br>这里由于我已经关掉了，所以和端口并没有关系，只是举个例子，我们可以看到这个pid前面的名称，那么接下来我们去把它关掉然后改成手动开启就行了，方法如一开始所示的</p><p>接下来，我们回到正题，继续配置Pikachu的环境<br>都启动成功后，我们在浏览器中输入127.0.0.1/pikachu（以实际命名的文件名为准）就是这里的名字<br><img src="https://img-blog.csdnimg.cn/3dfab9d6dc374f59b3cb10e7b3e133ab.png" alt="在这里插入图片描述"><br>会出现这个<br><img src="https://img-blog.csdnimg.cn/40d759f26b494a738d330305cb6d96a0.png" alt="在这里插入图片描述"><br>点击红色字体，点击安装/初始化<br><img src="https://img-blog.csdnimg.cn/b8e2d690381547cfb8f3873b00b81608.png" alt="在这里插入图片描述"><br>完成啦！<br><img src="https://img-blog.csdnimg.cn/841145c4aa63454a81d00451d6e1a454.png" alt="在这里插入图片描述"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="WEB学习" scheme="http://example.com/categories/WEB%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="WEB" scheme="http://example.com/tags/WEB/"/>
    
  </entry>
  
  <entry>
    <title>C语言指针</title>
    <link href="http://example.com/2021/09/14/C%E8%AF%AD%E8%A8%80%E6%8C%87%E9%92%88/"/>
    <id>http://example.com/2021/09/14/C%E8%AF%AD%E8%A8%80%E6%8C%87%E9%92%88/</id>
    <published>2021-09-14T13:28:06.537Z</published>
    <updated>2021-09-14T13:30:59.252Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p><strong>指针</strong>是内存地址<br><strong>指针变量</strong>是用来存放内存地址的变量<br>指针变量的值是地址（即指针）<br>指针变量可以有空值，即不指向任何变量<br>p=NULL;<br>如果两个指针变量都指向同一个数组中的元素，则两个指针变量值之差是两个指针之间的元素个数。<br>若两个指针指向同一个数组的元素，则可以进行比较，指向前面的元素的指针变量“小于”格向后面元素的指针变量。</p><p>*：取值操作符<br>&amp;:  取址操作符<br>以下代码示例：<br>（1）</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">2000</span>;</span><br><span class="line"><span class="keyword">int</span> *pointer;<span class="comment">//此处*表示定义了一个指针变量，指针变量名是pointer,而不是*pointer</span></span><br><span class="line">pointer=&amp;i;<span class="comment">//pointer==i的地址</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,*pointer);<span class="comment">//取出pointer所指向地址的值</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/fa2a4cd8cf4e4383a7762171f76bdd57.png" alt="在这里插入图片描述"><br>（2）在函数中运用</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line"><span class="keyword">int</span> *pointer_1,*pointer_2;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *p1,<span class="keyword">int</span> *p2)</span></span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">pointer_1=&amp;a;</span><br><span class="line">pointer_2=&amp;b;</span><br><span class="line"><span class="keyword">if</span>(a&lt;b)</span><br><span class="line">&#123;</span><br><span class="line">swap(pointer_1,pointer_2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,a,b);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *p1,<span class="keyword">int</span> *p2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> temp;</span><br><span class="line">temp=*p1;</span><br><span class="line">*p1=*p2;</span><br><span class="line">*p2=temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c7df86ebaaa54e4fb6521b5b270b77f8.png" alt="在这里插入图片描述"><br>*和&amp;的优先级相同，按照自右向左的顺序<br>例：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）现令pointer=&amp;a;</span><br><span class="line">则&amp;*pointer==&amp;a</span><br><span class="line">（<span class="number">2</span>）*&amp;a==a;</span><br></pre></td></tr></table></figure><p>C语言运算符优先级表<br><img src="https://img-blog.csdnimg.cn/a487d2f39e9e46a39706fe84ab71078f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAXk5vcm1pbmc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>赋值时，指针变量和变量的类型需要一样<br>指针变量可以赋值给另一个指针变量</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pointer_1=pointer_2</span><br></pre></td></tr></table></figure><p>示例程序：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line"><span class="keyword">int</span> *pointer_1,*pointer_2;</span><br><span class="line">a=<span class="number">3</span>;</span><br><span class="line">b=<span class="number">5</span>;</span><br><span class="line">pointer_1=&amp;a;</span><br><span class="line">pointer_2=&amp;b;</span><br><span class="line">pointer_1=pointer_2;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,*pointer_1,*pointer_2);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/df82352d5ddf41f0ae614d15cc45262c.png" alt="在这里插入图片描述"><br><strong>数组和指针</strong><br>当引用一个数组元素时，可以使用：<br>（1）下标法：如a[i]<br>（2）指针法，如*(a+i)<br>由于数组名指向的是数组的第一个元素的地址，故，假设a是数组名，p是指向数组元素的指针变量，其初值p=a，即p=&amp;a[0]，上面的指针法中的a也可以写成p.<br>（3）指针变量<br>使用指针变量指向数组元素</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">10</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">int</span> *p;</span><br><span class="line"><span class="keyword">for</span>(p=a;p&lt;(a+<span class="number">10</span>);p++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,*p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/0ecbe4cab3e9404d8506e073d10be1d8.png" alt="在这里插入图片描述"><br>使用数组名作为函数参数：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"><span class="comment">//在编译时将arr按指针变量处理，相当于函数首部写成f（int *arr,int n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">10</span>];</span><br><span class="line">    ……</span><br><span class="line">    f(<span class="built_in">array</span>,<span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>补充一下函数里面实参和形参的内容：<br>形参（形式参数）：<br>在函数定义中出现的参数可以看做是一个占位符，它没有数据，只能等到函数被调用时接收传递进来的数据，所以称为形式参数，简称形参。<br>实参（实际参数）：<br>函数被调用时给出的参数包含了实实在在的数据，会被函数内部的代码使用，所以称为实际参数，简称实参。<br>形参和实参的功能是传递数据，发生函数调用时，实参的值会传递给形参。</p><p><strong>多维数组和指针</strong><br><img src="https://img-blog.csdnimg.cn/9d4b341360544b4fb819ec054d9f6dfe.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAXk5vcm1pbmc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/b4dd7e11926c4c938782922a046691ef.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAXk5vcm1pbmc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>类型说明符 (*指针变量名)[长度]<br>例如：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> (*p)[<span class="number">4</span>]</span><br></pre></td></tr></table></figure><p>表示p是一个指针变量，指向包含4个元素的一维数组。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*（p+i）+j 二维数组i行j列的元素的地址</span><br><span class="line">*（*（p+i)+j)i行j列元素的值</span><br></pre></td></tr></table></figure><p><strong>字符串和指针</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> *<span class="built_in">string</span>=<span class="string">&quot;HelloWorld!&quot;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,<span class="built_in">string</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f415bda8494a4448b1937be5900a5c6a.png" alt="在这里插入图片描述"><br>字符串也可以用下标法和指针法</p><p>下标法：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[]=<span class="string">&quot;HelloWorld!&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;*(a+i)!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">*(b+i)=*(a+i);</span><br><span class="line">&#125;</span><br><span class="line">*(b+i)=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;b[i]!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,b[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/8d76215d473449bc9fac8273f3880312.png" alt="在这里插入图片描述"><br>指针法：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[]=<span class="string">&quot;HelloWorld!&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> *p1,*p2;</span><br><span class="line">p1=a;</span><br><span class="line">p2=b;</span><br><span class="line"><span class="keyword">for</span>( ;*p1!=<span class="string">&#x27;\0&#x27;</span>;p1++,p2++)</span><br><span class="line">&#123;</span><br><span class="line">*p2=*p1;</span><br><span class="line">&#125;</span><br><span class="line">*p2=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;b[i]!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,b[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f9b58ceadc7f479485952ecef60a24f5.png" alt="在这里插入图片描述"><br><strong>字符指针变量和字符数组</strong><br>1.字符数组由若干个元素组成，每个元素中放一个字符，而字符指针变量中存放的是地址（字符串第1个字符的地址)，不是将字符串放到字符指针变量中。<br>2.赋值方式。对字符数组只能对各个元素赋值，<strong>不能</strong>用以下办法对字符数组赋值。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> str[<span class="number">20</span>];</span><br><span class="line">str = <span class="string">&quot;Hello World!&quot;</span></span><br></pre></td></tr></table></figure><p>而对字符指针变量，可以采用下面方法赋值</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> *a;</span><br><span class="line">a = <span class="string">&quot;HelloWorld!&quot;</span>;</span><br></pre></td></tr></table></figure><p>注意赋给a的不是字符，而是字符串第一个元素的地址。<br><strong>指向函数的指针</strong><br>可用于在函数中调用别的函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span>(*fun)(<span class="keyword">int</span>,<span class="keyword">int</span>))</span></span>;</span><br><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">process(a,b,max);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>返回指针值的函数</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> score[][<span class="number">2</span>] = &#123;&#123;<span class="number">10</span>,<span class="number">20</span>&#125;,&#123;<span class="number">20</span>,<span class="number">40</span>&#125;,&#123;<span class="number">30</span>,<span class="number">60</span>&#125;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">search</span><span class="params">(<span class="keyword">int</span>(*pointer)[<span class="number">2</span>],<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="keyword">int</span> *p;</span><br><span class="line"><span class="keyword">int</span> i,m;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;m);</span><br><span class="line">p=search(score,m);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\t&quot;</span>,*(p+i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">search</span><span class="params">(<span class="keyword">int</span> (*pointer)[<span class="number">2</span>],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> *pt;</span><br><span class="line">pt=*(pointer+n);</span><br><span class="line"><span class="keyword">return</span> pt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/9255071dbf5b4b0c986d07443d2d0144.png" alt="在这里插入图片描述"><br><strong>指针函数和函数指针</strong><br>指针函数是指带指针的函数，本质是一个函数。<br>函数指针是指向函数的指针变量，因而函数指针本身首先应是指针变量了，只不过该指针变量指向函数。<br><strong>指针数组</strong><br>一个数组，若其元素均为指针类型数据，称为指针数组，也就是说，指针数组中的每一个元素都相当于一个指针变量。一维指针数组的定义形式为：<br>int *name[4];<br><strong>指向指针的指针</strong><br>例如：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> **p;<span class="comment">//相当于*(*p)</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/ee6e01bce8ed423e90bfd0a29117eb75.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAXk5vcm1pbmc=,size_17,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="C" scheme="http://example.com/categories/C/"/>
    
    
    <category term="C" scheme="http://example.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>实验室暑期CTF训练赛--第三、四周</title>
    <link href="http://example.com/2021/08/27/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9A%91%E6%9C%9FCTF%E8%AE%AD%E7%BB%83%E8%B5%9B--%E7%AC%AC%E4%B8%89%E3%80%81%E5%9B%9B%E5%91%A8/"/>
    <id>http://example.com/2021/08/27/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9A%91%E6%9C%9FCTF%E8%AE%AD%E7%BB%83%E8%B5%9B--%E7%AC%AC%E4%B8%89%E3%80%81%E5%9B%9B%E5%91%A8/</id>
    <published>2021-08-27T09:19:23.713Z</published>
    <updated>2021-08-27T09:21:50.458Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>由于生病一直没有写博客，在此补上<br>题目链接:<br>链接：<a href="https://pan.baidu.com/s/12jKBrLCVMHM-vx5qe-FBww">https://pan.baidu.com/s/12jKBrLCVMHM-vx5qe-FBww</a><br>提取码：21bt</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="game"><a href="#game" class="headerlink" title="game"></a>game</h3><p>unity游戏，我们可以先玩一下<br><img src="https://img-blog.csdnimg.cn/ddbc29b9fbb849b2ad968afd392a032f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>游戏是控制一个白球吃分，全部吃掉一共能得到12分<br>题目是第13个数在哪，所以猜测需要改程序得到13分</p><p>由于unity是用C#开发，所以用dnspy<br>在Cheat Engine_Data\Managed文件夹中找到Assembly-CSharp.dll<br>这是程序的源码，用来存放C#工程<br>凭借经验找到的start()函数<br><img src="https://img-blog.csdnimg.cn/cf13db3481b441b8b28eff81e6ce8464.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/08ebaa7a40b14cf4a64b9130eb99382f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这里是对游戏的初始化设置，我们将开始的分数改为12<br><img src="https://img-blog.csdnimg.cn/685b7e68b28e45beace95f3eae7ce76d.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/dc4a28fc8ada4912a9585e33d5797a50.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>编译完成之后看到<br><img src="https://img-blog.csdnimg.cn/345ef90f75794a828e2ee0f9850d7eca.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>打开发现需要分数达到14以上才可以获得flag<br><img src="https://img-blog.csdnimg.cn/6ec9afdea9c34d8d9728df7dffe2d16d.png" alt="在这里插入图片描述"><br>现在保存<br><img src="https://img-blog.csdnimg.cn/199629ae5b0a43ddbab88e32f91fd7f8.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5e2f9d0c75644b0ebd5449a9c14698ee.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以发现已经被替换了<br><img src="https://img-blog.csdnimg.cn/59676cbf845d4ef898b8811b9278c94c.png" alt="在这里插入图片描述"><br>再次打开游戏玩<br><img src="https://img-blog.csdnimg.cn/7f1b30be9055430da9dc539c0fbd6ba6.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以看到初始分数已经变成了12<br>我们吃掉两分之后即可发现屏幕上出现了flag<br><img src="https://img-blog.csdnimg.cn/9626333fd5344f3998f2815e026cdac0.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：ThEFLAGGGGGGG</p><h3 id="really-CTF"><a href="#really-CTF" class="headerlink" title="really_CTF"></a>really_CTF</h3><p>UPX壳<br><img src="https://img-blog.csdnimg.cn/b5e0758eb0474942ae4804425fe29504.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>kali脱壳<br><img src="https://img-blog.csdnimg.cn/7e37ea6a72ac4978a24f05924b800b3a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/81c10cec9aa34ffa9e7383baab716dee.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>IDA打开，通过字符串搜索找到了关键函数<br><img src="https://img-blog.csdnimg.cn/a75d1c415c2d44469fdf597e84b48cb3.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/f376dfe949ff4a5f801f82e0d619d575.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看样子是输入的字符串经过函数<code>sub_401000</code>的处理之后和字符串<code>NUCTF&#123;I_am_flag&#125;</code>比较<br>查看函数<code>sub_401000</code><br><img src="https://img-blog.csdnimg.cn/64115f23f44942e4b44a56be6cba5b35.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>该程序算法：<br>获取输入的字符串a，将a[i]换成<code>byte_402FF8[a[i]的ASCII码]</code>，再将处理后的a和<code>NUCTF&#123;I_am_flag&#125;</code>比较，相等即为flag</p><p>查看<code>byte_402FF8</code><br><img src="https://img-blog.csdnimg.cn/96694c2fe3dd4f63a9c0e74fc20bc135.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>00402FF8处的byte_402FF8没有显示数据，但是往下翻00403018处却有不同寻常的字符串<br>这其中的地址刚好差了0x20<br>由于ASCII码表中第一个可以显示出来的字符的值刚好是0x20<br><img src="https://img-blog.csdnimg.cn/51ec2f1faad5464abd84e52bf2c49597.png" alt="在这里插入图片描述"><br>所以可以设想byte_402FF8的地址与实际数组有一些偏移<br>由于输入的可见字符最小下标就是空格的0x20，因此byte_402FF8这个地址实际上也是真正的表地址<code>(0x403018)-0x20=0x402ff8</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">table = <span class="string">&#x27;&#x27;&#x27;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(&#x27;&amp;%$#&quot;! &#x27;&#x27;&#x27;</span></span><br><span class="line">s = <span class="string">&#x27;NUCTF&#123;I_am_flag&#125;&#x27;</span></span><br><span class="line"> </span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">    flag += <span class="built_in">chr</span>(table.find(c) + <span class="number">0x20</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>flag是：PI[JX#U?=1?82=7!<br>（看起来奇奇怪怪哈~）</p><h3 id="simple"><a href="#simple" class="headerlink" title="simple"></a>simple</h3><p>IDA打开通过字符串发现特殊字符找到关键函数<br><img src="https://img-blog.csdnimg.cn/f9cf7aca4b6341d59012bcd3a6402f78.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>time() 获取时间，很显然需要动态调试绕过<br>打开OD，搜素字符串<br><img src="https://img-blog.csdnimg.cn/3d350f26982c40ddaedb6e87fa8bc8f6.png" alt="在这里插入图片描述"><br>跟随过去，看到有三个跳转<br><img src="https://img-blog.csdnimg.cn/96ae36b0072e49229bf20d787ee63690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>用 nop 指令填冲三个跳转<br><img src="https://img-blog.csdnimg.cn/2c9798cddcd24becb25f62539b725a63.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>直接运行，获得flag</p><p><img src="https://img-blog.csdnimg.cn/c57c12de102b4117ac3fcc6710bf00a1.png" alt="在这里插入图片描述"><br>flag是：flag{h4ppy520}</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Least"><a href="#Least" class="headerlink" title="Least"></a>Least</h3><p><img src="https://img-blog.csdnimg.cn/6803df0feb1347ffa6f261fd71e72507.png" alt="在这里插入图片描述"><br>使用 stegsolve 查看，这个题目名称很容易让人想到LSB<br><img src="https://img-blog.csdnimg.cn/7bd6309c1e6d4f369602630dbeb72b76.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这里不知道为什么要用BGR，感觉遇到的这一类题目大多数不是RGB就是BGR，没有找到很好的参考资料，有懂得大佬麻烦指教一下~<br>保存之后foremost了一下<br><img src="https://img-blog.csdnimg.cn/2d5a7da6690d454797e334e67c5dc238.png" alt="在这里插入图片描述"><br>得到了一个压缩包<br><img src="https://img-blog.csdnimg.cn/e15f63d9f5e64c6c9614ea0ff16318a2.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解压即可得到flag</p><p>flag是：flag{c6ed6d6318005debbca17c7b1d7096d8}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="比赛" scheme="http://example.com/categories/%E6%AF%94%E8%B5%9B/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>WUSTCTF2020level3-[BJDCTF2020]BJD hamburger competition-[FlareOn6]Overlong-[WUSTCTF2020]Cr0ssfun</title>
    <link href="http://example.com/2021/08/01/WUSTCTF2020level3-[BJDCTF2020]BJD%20hamburger%20competition-[FlareOn6]Overlong-[WUSTCTF2020]Cr0ssfun/"/>
    <id>http://example.com/2021/08/01/WUSTCTF2020level3-[BJDCTF2020]BJD%20hamburger%20competition-[FlareOn6]Overlong-[WUSTCTF2020]Cr0ssfun/</id>
    <published>2021-08-01T06:53:23.267Z</published>
    <updated>2021-08-01T06:54:28.882Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="WUSTCTF2020-level3"><a href="#WUSTCTF2020-level3" class="headerlink" title="[WUSTCTF2020]level3"></a>[WUSTCTF2020]level3</h3><p><img src="https://img-blog.csdnimg.cn/f89c94090bfc4ec8bb208959e723e98e.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>64位IDA打开，看main函数<br><img src="https://img-blog.csdnimg.cn/8ca8233d9b704afca65231fb4a2e55de.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>根据它的提示应该是变换的base64加密<br>点击15行的函数base_encode<br><img src="https://img-blog.csdnimg.cn/9447864f4b6942da880ee6dc8589332f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>加密流程和base64一样的，那应该就是对加密表进行了变换<br>双击base_table[]，通过交叉引用我们可以看到有其他的函数调用了它，过去看看<br><img src="https://img-blog.csdnimg.cn/e4843c669f2047e2b9107d8feeb0ac47.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/e721501e11634aac86ec34c5163bd91c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>一个换表，将原来base64中的前20位倒过来<br>编写脚本解决：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">table = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span></span><br><span class="line">model = <span class="built_in">list</span>(<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span>)</span><br><span class="line">s = <span class="string">&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;</span><span class="comment">##此处为加密后的字符串</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    model[i], model[<span class="number">19</span>-i] = model[<span class="number">19</span>-i], model[i]<span class="comment">##此处为还原规律，本脚本为将前20位颠倒</span></span><br><span class="line">model = <span class="string">&#x27;&#x27;</span>.join(model)</span><br><span class="line"><span class="built_in">print</span> (model)</span><br><span class="line">table = <span class="built_in">str</span>.maketrans(model, table)</span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(s.translate(table)))</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d73ce4325d404d2394bccea488ccd5f5.png" alt="在这里插入图片描述"><br>flag是：flag{Base64_is_the_start_of_reverse}</p><h3 id="BJDCTF2020-BJD-hamburger-competition"><a href="#BJDCTF2020-BJD-hamburger-competition" class="headerlink" title="[BJDCTF2020]BJD hamburger competition"></a>[BJDCTF2020]BJD hamburger competition</h3><p>很有意思的一个游戏<br><img src="https://img-blog.csdnimg.cn/93281b534338459598bd0d6bda280b4b.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>由于unity是用C#开发，所以用dnspy<br>在<code>BJD hamburger competition_Data\Managed</code>文件夹中找到<code>Assembly-CSharp.dll</code>这是程序的源码，用来存放C#工程<br>打开，搜索字符串<br><img src="https://img-blog.csdnimg.cn/2029af3fd28f40c6a1fbe47dd3301741.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/21b95920c94b4c8192a33c871f052c19.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>逻辑是选择了正确的配料得到一个值，这个值sha1加密之后是DD01903921EA24941C26A48F2CEC24E0BB0E8CC7，最后有一个MD5加密<br><img src="https://img-blog.csdnimg.cn/4812480877f34637b2b47fba7786b1fb.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>SHA1解密为1001<br>看MD5函数<br><img src="https://img-blog.csdnimg.cn/906ba37ce7804c42b8f089d522c7fb23.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>X2是变成大写，然后后面写的是取0-20位<br>flag是：flag{B8C37E33DEFDE51CF91E}</p><h3 id="FlareOn6-Overlong"><a href="#FlareOn6-Overlong" class="headerlink" title="[FlareOn6]Overlong"></a>[FlareOn6]Overlong</h3><p>运行一下，发现就一句话，像是冒号后面还有东西的样子<br><img src="https://img-blog.csdnimg.cn/8c8b3437ae88452bb37d53f327b14202.png" alt="在这里插入图片描述"><br>看看主函数<br><img src="https://img-blog.csdnimg.cn/e8c519d56dab4acc919cd9fe32205b4d.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>第7行是写入了什么，代码给的是长度28位，但是打开<code>unk_402008</code>发现很长，有127位<br><img src="https://img-blog.csdnimg.cn/f74758f7715a4bbc8fbf106a38bacb13.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以写代码改变然后解密，这里使用OD，更加快捷<br><img src="https://img-blog.csdnimg.cn/41832d07b1814d5196ff90cef4865544.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看这一行，我们要在栈中修改它的值，在这一行右键-&gt;Binary-&gt;Edit<br><img src="https://img-blog.csdnimg.cn/917f1f8ce44d4a47840ff576f421a55c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>改成AF<br><img src="https://img-blog.csdnimg.cn/6ba13faf36174a0cafd509542514735c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/bbc54cac13554cdbba23b315dc5b5c68.png" alt="在这里插入图片描述"><br>然后在OD中运行<br><img src="https://img-blog.csdnimg.cn/7e17ba5a79ea4ffe83bfd4bb7174085f.png" alt="在这里插入图片描述"><br>flag是：flag{I_a_M_t_h_e_e_n_C_o_D_i_n_g@flare-on.com}</p><h3 id="WUSTCTF2020-Cr0ssfun"><a href="#WUSTCTF2020-Cr0ssfun" class="headerlink" title="[WUSTCTF2020]Cr0ssfun"></a>[WUSTCTF2020]Cr0ssfun</h3><p>ida64打开，从主函数看有个check，打开全都是这样的一个套一个<img src="https://img-blog.csdnimg.cn/6fc98f74069549f08c46060e1dad7f45.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>都复制了跑一下，按顺序输出</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a1[<span class="number">49</span>];</span><br><span class="line">a1[<span class="number">10</span>] = <span class="number">112</span> ;</span><br><span class="line">a1[<span class="number">13</span>] = <span class="number">64</span> ;</span><br><span class="line">a1[<span class="number">3</span>] = <span class="number">102</span> ;</span><br><span class="line">a1[<span class="number">26</span>] = <span class="number">114</span> ;</span><br><span class="line">a1[<span class="number">20</span>] = <span class="number">101</span> ;</span><br><span class="line">a1[<span class="number">7</span>] = <span class="number">48</span> ;</span><br><span class="line">a1[<span class="number">16</span>] = <span class="number">95</span> ;</span><br><span class="line">a1[<span class="number">11</span>] = <span class="number">112</span> ;</span><br><span class="line">a1[<span class="number">23</span>] = <span class="number">101</span> ;</span><br><span class="line">a1[<span class="number">30</span>] = <span class="number">117</span>  ;</span><br><span class="line">a1[<span class="number">0</span>] = <span class="number">119</span>   ;</span><br><span class="line">a1[<span class="number">6</span>] = <span class="number">50</span> ;</span><br><span class="line">a1[<span class="number">22</span>] = <span class="number">115</span>;</span><br><span class="line">a1[<span class="number">31</span>] = <span class="number">110</span> ;</span><br><span class="line">a1[<span class="number">12</span>] = <span class="number">95</span>;</span><br><span class="line">a1[<span class="number">15</span>] = <span class="number">100</span>;</span><br><span class="line">a1[<span class="number">8</span>] = <span class="number">123</span> ;</span><br><span class="line">a1[<span class="number">18</span>] = <span class="number">51</span> ;</span><br><span class="line">a1[<span class="number">28</span>] = <span class="number">95</span> ;</span><br><span class="line">a1[<span class="number">21</span>] = <span class="number">114</span> ;</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">116</span> ;</span><br><span class="line">a1[<span class="number">9</span>] = <span class="number">99</span> ;</span><br><span class="line">a1[<span class="number">32</span>] = <span class="number">125</span>;</span><br><span class="line">a1[<span class="number">19</span>] = <span class="number">118</span> ;</span><br><span class="line">a1[<span class="number">5</span>] = <span class="number">48</span> ;</span><br><span class="line">a1[<span class="number">14</span>] = <span class="number">110</span>;</span><br><span class="line">a1[<span class="number">4</span>] = <span class="number">50</span>   ;</span><br><span class="line">a1[<span class="number">17</span>] = <span class="number">114</span>  ;</span><br><span class="line">a1[<span class="number">29</span>] = <span class="number">102</span>   ;</span><br><span class="line">a1[<span class="number">17</span>] = <span class="number">114</span>   ;</span><br><span class="line">a1[<span class="number">24</span>] = <span class="number">95</span>  ;</span><br><span class="line">a1[<span class="number">1</span>] = <span class="number">99</span>   ;</span><br><span class="line">a1[<span class="number">25</span>] = <span class="number">64</span>   ;</span><br><span class="line">a1[<span class="number">27</span>] = <span class="number">101</span>;</span><br><span class="line">a1[<span class="number">48</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,a1);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e6a39024beba4de285564c662ec08af9.png" alt="在这里插入图片描述"><br>flag是：flag{cpp_@nd_r3verse_@re_fun}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>实验室暑期CTF训练赛--第二周</title>
    <link href="http://example.com/2021/07/30/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9A%91%E6%9C%9FCTF%E8%AE%AD%E7%BB%83%E8%B5%9B--%E7%AC%AC%E4%BA%8C%E5%91%A8/"/>
    <id>http://example.com/2021/07/30/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9A%91%E6%9C%9FCTF%E8%AE%AD%E7%BB%83%E8%B5%9B--%E7%AC%AC%E4%BA%8C%E5%91%A8/</id>
    <published>2021-07-30T01:55:27.622Z</published>
    <updated>2021-07-30T02:00:49.052Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>题目链接：<br>链接：<a href="https://pan.baidu.com/s/1VX6DZrI03kNTaijI7xoD3g">https://pan.baidu.com/s/1VX6DZrI03kNTaijI7xoD3g</a><br>提取码：r37q</p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h3><p>wireshark保存的文件<br>打开搜索flag<br><img src="https://img-blog.csdnimg.cn/3de17971aece4c819b27807758e4e3a7.png" alt="在这里插入图片描述"><br>打开搜到的包发现有很多文件<br><img src="https://img-blog.csdnimg.cn/062ab5daa42246658158b2aa4835097e.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用foremost分离文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foremost <span class="number">02</span>_misc01.pcapng</span><br></pre></td></tr></table></figure><p>得到一个压缩包<br><img src="https://img-blog.csdnimg.cn/ff2eaaed7a1a4f1a87ee19a64d9cd30d.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>需要解压密码<br>爆破不出来，回到wireshark中寻找<br>接着搜flag，发现1150的包多了jpg文件<br><img src="https://img-blog.csdnimg.cn/d3b94952a898494db133ad5f4112ce0b.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>对这个包追踪TCP流量</p><p>FFD8 FFD9分别是jpg文件的开头和结尾<br><img src="https://img-blog.csdnimg.cn/37a83ef16be44fa38b9474c16d217a81.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>复制下这一段，使用脚本恢复<br><img src="https://img-blog.csdnimg.cn/00d7450ce3934351bdb3b9b1ddf54eae.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在项目文件夹里面打开图片<br><img src="https://img-blog.csdnimg.cn/91957e7ef7674ec39fcb26d676e9f385.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>输入密码<br>flag是：flag{3OpWdJ-JP6FzK-koCMAK-VkfWBq-75Un2z}</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="junkcode"><a href="#junkcode" class="headerlink" title="junkcode"></a>junkcode</h3><p>看名字还以为是花指令，结果不是…<br>这个题是SMC（Self-modifying code 自修改代码）：自修改代码是一种编程原理，开发人员可以编写一个程序，在执行时可以更改自己的代码。</p><p>查壳无壳<br><img src="https://img-blog.csdnimg.cn/367f8f345d2340999dd8dc08c7445429.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>IDA打开，发现分析不出什么有效的信息<br>看它的Entry point<br><img src="https://img-blog.csdnimg.cn/2f0354a251084773b4d87608c3361185.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以看到入口点在nop处，查看nop<br><img src="https://img-blog.csdnimg.cn/ecf18959b194427ea67db1cccf996c87.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以发现从check到nop这段被异或加密了<br>我们看一下check函数，F5无法反编译<br><img src="https://img-blog.csdnimg.cn/a3ff38b7b08a4549b1170b66797bc989.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用IDC脚本解密，先找到开头和结尾<br><img src="https://img-blog.csdnimg.cn/c7846b8d4ca5468e907a1358c29ba4a6.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/0807444af1b9439c8fd0e81afd0e6ba3.png" alt="在这里插入图片描述"><br>编写脚本</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0x80484fb</span>;i&lt;=<span class="number">0x80485fa</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">PatchByte(i,Byte(i)^<span class="number">0x22</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>shift+F2打开IDC编译器<br><img src="https://img-blog.csdnimg.cn/16eaf439e4504dcfa7e2659b321c4ba2.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>运行完成后check函数变成了这样<br><img src="https://img-blog.csdnimg.cn/cb072710c41c4349ac1c2baa0bebb6f2.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>我们可以看到此时check函数的地址还是红色的，说明需要我们构建函数才可以反编译成C的伪代码。<br>点击check函数的开头地址<br><img src="https://img-blog.csdnimg.cn/2bc6f58fc5c240dfaf37010e9ce89e50.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>按P键<br><img src="https://img-blog.csdnimg.cn/eaebe8455afa41d094de4f6800a5cbe7.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>即可F5查看check函数的伪代码<br><img src="https://img-blog.csdnimg.cn/ac77e19db7cd4b6f80076102cc28ad29.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>很简单的异或<br>将<code>byte_80486A0</code>和<code>byte_80486B9</code>中的数据提取出来<br><img src="https://img-blog.csdnimg.cn/b69d8f6104804123bc235a1266cae040.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>编写Python脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">str1 = [<span class="number">0xFC</span>, <span class="number">0xE8</span>, <span class="number">0x64</span>, <span class="number">0xE1</span>, <span class="number">0xDD</span>, <span class="number">0x96</span>, <span class="number">0x18</span>, <span class="number">0x9A</span>, <span class="number">0x8D</span>, <span class="number">0x18</span>,</span><br><span class="line">  <span class="number">0x0D</span>, <span class="number">0xFA</span>, <span class="number">0xA1</span>, <span class="number">0x2C</span>, <span class="number">0x01</span>, <span class="number">0x54</span>, <span class="number">0xE0</span>, <span class="number">0x38</span>, <span class="number">0x08</span>, <span class="number">0xB3</span>,</span><br><span class="line">  <span class="number">0x82</span>, <span class="number">0x67</span>, <span class="number">0x55</span>, <span class="number">0x38</span>]</span><br><span class="line">str2 = [<span class="number">0xD6</span>, <span class="number">0x8B</span>, <span class="number">0x10</span>, <span class="number">0x87</span>, <span class="number">0xA6</span>, <span class="number">0xFC</span>, <span class="number">0x6D</span>, <span class="number">0xF4</span>, <span class="number">0xE6</span>, <span class="number">0x38</span>,</span><br><span class="line">  <span class="number">0x6E</span>, <span class="number">0x95</span>, <span class="number">0xC5</span>, <span class="number">0x49</span>, <span class="number">0x21</span>, <span class="number">0x3A</span>, <span class="number">0x8F</span>, <span class="number">0x4C</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>,</span><br><span class="line">  <span class="number">0xF7</span>, <span class="number">0x09</span>, <span class="number">0x3E</span>, <span class="number">0x45</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">flag += <span class="built_in">chr</span>(str1[i] ^ str2[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/7a7b0e6106304f009cf630c820e0cf57.png" alt="在这里插入图片描述"><br>flag是：ctf{junk code not junk}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="比赛" scheme="http://example.com/categories/%E6%AF%94%E8%B5%9B/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>解决kali连不上网的问题（网卡不工作）</title>
    <link href="http://example.com/2021/07/29/%E8%A7%A3%E5%86%B3kali%E8%BF%9E%E4%B8%8D%E4%B8%8A%E7%BD%91%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%88%E7%BD%91%E5%8D%A1%E4%B8%8D%E5%B7%A5%E4%BD%9C%EF%BC%89/"/>
    <id>http://example.com/2021/07/29/%E8%A7%A3%E5%86%B3kali%E8%BF%9E%E4%B8%8D%E4%B8%8A%E7%BD%91%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%88%E7%BD%91%E5%8D%A1%E4%B8%8D%E5%B7%A5%E4%BD%9C%EF%BC%89/</id>
    <published>2021-07-29T09:06:24.353Z</published>
    <updated>2021-07-29T09:08:28.363Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>参考了<a href="https://blog.csdn.net/like98k/article/details/79873320">郁离歌</a>的博客<br>ifconfig之后发现只有localhost<br><img src="https://img-blog.csdnimg.cn/0e1f5fc346274282ac85be2b681c8443.png" alt="在这里插入图片描述"><br>ifconfig -a<br><img src="https://img-blog.csdnimg.cn/92ecb541eb144935a98bf36c015d8ac3.png" alt="在这里插入图片描述"><br>看到网卡还活着，只是罢工了<br>在终端运行这个命令</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">leafpad /etc/network/interfaces</span><br></pre></td></tr></table></figure><p>在最后加上方框中的两行<br><img src="https://img-blog.csdnimg.cn/4c5c9b15ad994c76bcdc0470487c6270.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>保存，终端执行命令重启网络</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/networking restart  </span><br></pre></td></tr></table></figure><p>即可<br><img src="https://img-blog.csdnimg.cn/2e2eb9c285b14dcb8e46a278de0235a1.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Kali" scheme="http://example.com/tags/Kali/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(5)</title>
    <link href="http://example.com/2021/07/29/buuctf-misc%E7%BB%83%E4%B9%A0(5)/"/>
    <id>http://example.com/2021/07/29/buuctf-misc%E7%BB%83%E4%B9%A0(5)/</id>
    <published>2021-07-29T06:39:25.978Z</published>
    <updated>2021-07-29T07:11:34.064Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="被劫持的神秘礼物"><a href="#被劫持的神秘礼物" class="headerlink" title="被劫持的神秘礼物"></a>被劫持的神秘礼物</h3><p>流量包文件，搜索http，发现POST提交<br><img src="https://img-blog.csdnimg.cn/012be9a90ba94832921d86ec22634249.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>右键追踪HTTP流，因为题目提示要把用户名密码连在一起<br><img src="https://img-blog.csdnimg.cn/f8115fb00d7b46b8a889769c0515c4f8.png" alt="在这里插入图片描述"><br>拼接用户名密码得到adminaadminb<br>md5处理：<br>1d240aafe21a86afc11f38a45b541a49</p><p>flag是：flag{1d240aafe21a86afc11f38a45b541a49}</p><h3 id="刷新过的图片"><a href="#刷新过的图片" class="headerlink" title="刷新过的图片"></a>刷新过的图片</h3><p>开局一张图片，根据题目提示判断为F5隐写、</p><p>F5-steganography在kali下的安装方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/matthewgao/F5-steganography</span><br></pre></td></tr></table></figure><p>使用<br><img src="https://img-blog.csdnimg.cn/046be5f0b9794ddab18e1e95347c70d8.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在文件夹下面找到output文件<br><img src="https://img-blog.csdnimg.cn/79699ce2f3c14a799b061f1f00b3dc6b.png" alt="在这里插入图片描述"><br>是个zip压缩文件<br>将文件拖出虚拟机，改txt后缀为zip，然后发现是个伪加密，使用工具解决<br><img src="https://img-blog.csdnimg.cn/827f2cf9d2c047ba992efa75c2474a10.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解压缩即可得到flag<br>flag是：flag{96efd0a2037d06f34199e921079778ee}</p><h3 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h3><p>binwalk一下，得到一个压缩包和两个文件了，压缩包解压之后也是这两个文件：key和cipher文件，将key放入winhex中<br><img src="https://img-blog.csdnimg.cn/6655b4e042fb4c92af548cb0b1d9777b.png" alt="在这里插入图片描述"><br>base64<br><img src="https://img-blog.csdnimg.cn/fb7b83e365ae4a6f9e49383879f62afb.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/dd1dc1737bda441b8a197e32c92823c2.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>What is Nicki Minaj’s favorite song that refers to snakes?<br>百度Nicki Minaj<br><img src="https://img-blog.csdnimg.cn/0da1a6e2bc284372b272b019b56ab568.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>key知道了，还需要知道加密算法<br>蛇在英语中还有一个翻译：Serpent。Serpent是一个加密算法<br>可以使用这个网站<a href="http://serpent.online-domain-tools.com/">http://serpent.online-domain-tools.com/</a><br><img src="https://img-blog.csdnimg.cn/bec6fdfb46c642659fb16b1eb00cccc2.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：flag{who_knew_serpent_cipher_existed}</p><h3 id="梅花香之苦寒来"><a href="#梅花香之苦寒来" class="headerlink" title="梅花香之苦寒来"></a>梅花香之苦寒来</h3><p>winhex打开发现图片文件尾部有大量16进制数据<br><img src="https://img-blog.csdnimg.cn/838f1c6a01704b6cbceb03482795c0cb.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将后面的16进制数导出，使用脚本转换可以得到其ASCII码形式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;hex.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> h:</span><br><span class="line">    h = h.read()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./ascii.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> a:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(h), <span class="number">2</span>):</span><br><span class="line">        tmp = <span class="string">&#x27;0x&#x27;</span>+h[i]+h[i+<span class="number">1</span>]</span><br><span class="line">        tmp = <span class="built_in">int</span>(tmp, base=<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(tmp) != <span class="string">&#x27;(&#x27;</span> <span class="keyword">and</span> <span class="built_in">chr</span>(tmp) != <span class="string">&#x27;)&#x27;</span>:</span><br><span class="line">            a.write(<span class="built_in">chr</span>(tmp))</span><br></pre></td></tr></table></figure><p>得到这样一个全是坐标的文件<br><img src="https://img-blog.csdnimg.cn/63843126f48543b9b4f3083fec6e13ce.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>脚本画图</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x, y = np.loadtxt(<span class="string">&#x27;./ascii.txt&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>, unpack=<span class="literal">True</span>)</span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/5bf66b094a194b6baaa9e2a2dba200e3.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/c48d2b087c0146bcbaaa500c8da38a27.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：flag{40fc0a979f759c8892f4dc045e28b820}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>HDCTF2019Maze-[FlareOn4]IgniteMe-[MRCTF2020]Xor-[MRCTF2020]hello_world_go</title>
    <link href="http://example.com/2021/07/24/HDCTF2019Maze-[FlareOn4]IgniteMe-[MRCTF2020]Xor-[MRCTF2020]hello_world_go/"/>
    <id>http://example.com/2021/07/24/HDCTF2019Maze-[FlareOn4]IgniteMe-[MRCTF2020]Xor-[MRCTF2020]hello_world_go/</id>
    <published>2021-07-24T14:17:13.104Z</published>
    <updated>2021-07-24T14:19:46.100Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="HDCTF2019-Maze"><a href="#HDCTF2019-Maze" class="headerlink" title="[HDCTF2019]Maze"></a>[HDCTF2019]Maze</h3><p>查壳，存在UPX壳<br><img src="https://img-blog.csdnimg.cn/5479c387ab634da5aedc2576e401adaa.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>kali脱壳，一开始不知道为什么脱不掉，后来重命名了个简短的名字就可以<br><img src="https://img-blog.csdnimg.cn/4ade3ed9d553446382c5face51d9aa45.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida打开，打开之后看到这里有一个花指令<br><img src="https://img-blog.csdnimg.cn/f1e012e538fe4ac0a25d05015c38902c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>关于花指令：<br>花指令是，由设计者特别构思，希望使反汇编的时候出错，让破解者无法清楚正确地反汇编程序的内容，迷失方向。经典的是，目标位置是另一条指令的中间，这样在反汇编的时候便会出现混乱。花指令有可能利用各种指令：jmp, call, ret的一些堆栈技巧，位置运算，等等。</p><p>打开OD，根据ida找到出现花指令位置的地址<br><img src="https://img-blog.csdnimg.cn/bce09d837ac642b0a111d6849e9b5553.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>NOP掉跳转<br>然后保存修改后的程序<br><img src="https://img-blog.csdnimg.cn/32083a8e9c9347179f9b07fcc420c22f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/0ebdbda22e7a40eb8c6b8812d9c95847.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/a6e016de6ebe4e47a631fffc7e971c67.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将保存过后的程序拖进IDA看看<br>字符串中有这样一串*号<br><img src="https://img-blog.csdnimg.cn/4e1d549134a84406ad2dc8e785828c1c.png" alt="在这里插入图片描述"><br>又通过下面的flag提示找到关键函数，可以知道这是一个迷宫题<br><img src="https://img-blog.csdnimg.cn/27ee1b23f6fb451a8e83caf114cd3b17.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>控制的有两个数据，一个是dword_408078，另一个是dword_40807C<br>双击进去查看初始数据。<br>初始状态：<br>dword_408078=7<br>dword_40807C=0<br>经过14次移动需要使<br>dword_408078=5<br>dword_40807C=-4<br>绘制迷宫</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*******+**</span><br><span class="line">******* **</span><br><span class="line">****    **</span><br><span class="line">**   *****</span><br><span class="line">** **F****</span><br><span class="line">**    ****</span><br><span class="line">**********</span><br></pre></td></tr></table></figure><p>行走路径为ssaaasaassdddw<br>flag是：flag{ssaaasaassdddw}</p><h3 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h3><p><img src="https://img-blog.csdnimg.cn/6e45e0230b174c408c52988b5ee45225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/ac31b6456ab042078ff990b5ecd5cb5c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看函数 <code>sub_401050()</code><br><img src="https://img-blog.csdnimg.cn/4041f5cb3f3b456789f8f0902e6045db.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>v0是输入，v4是一个处理函数，然后经过循环的异或脚本，最后和<code>byte_403000</code>比较<br>byte_403000:<br><img src="https://img-blog.csdnimg.cn/65897972b2f5499eb7bd0b55f690eccc.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看一下对v4的处理<br><img src="https://img-blog.csdnimg.cn/ee454f18a8274cfe9f0e9b6dc3fd4f30.png" alt="在这里插入图片描述"><br>不明白，动态调试一下<br><img src="https://img-blog.csdnimg.cn/38eccdfd72de4f38a89deee90abad3ad.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="请添加图片描述"><br>可以看到v4=0x4<br>编写脚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">arr2 = [<span class="number">0x0D</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x2A</span>,<span class="number">0x17</span>,<span class="number">0x78</span>,<span class="number">0x44</span>,<span class="number">0x2B</span>,<span class="number">0x6C</span>,<span class="number">0x5D</span>,<span class="number">0x5E</span>,<span class="number">0x45</span>,<span class="number">0x12</span>,<span class="number">0x2F</span>,<span class="number">0x17</span>,</span><br><span class="line"><span class="number">0x2B</span>,<span class="number">0x44</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x56</span>,<span class="number">0x09</span>,<span class="number">0x5F</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x13</span>,<span class="number">0x17</span>,<span class="number">0x48</span>,</span><br><span class="line"><span class="number">0x42</span>,<span class="number">0x01</span>,<span class="number">0x40</span>,<span class="number">0x4D</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x69</span>]</span><br><span class="line"></span><br><span class="line">arr1 = []</span><br><span class="line">v4 = <span class="number">4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arr2)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    arr1.append(arr2[i] ^ v4)</span><br><span class="line">    v4 = arr1[-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> arr1[::-<span class="number">1</span>]])+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>flag是：flag{R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com}</p><h3 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h3><p><img src="https://img-blog.csdnimg.cn/f4c8c02faf6b48d4be03d1c8a046489a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>通过字符串跳转<br><img src="https://img-blog.csdnimg.cn/dbb10f7641ce41ed9242b02bcef90f1a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>交叉引用，按F5发现无法分析call<br><img src="https://img-blog.csdnimg.cn/a393916abdbd40978913967aeb82597d.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看401095处<br><img src="https://img-blog.csdnimg.cn/2af32d28997b491b8db5e6b6846ebfd7.png" alt="在这里插入图片描述"><br>调用了函数<code>sub_401020</code></p><p>双击函数F5查看，发现它有多个参数<br><img src="https://img-blog.csdnimg.cn/5b684d1c849e4994824435b06db67d05.png" alt="在这里插入图片描述"></p><p>我们返回401095处，看这一行上面的push命令<br><img src="https://img-blog.csdnimg.cn/d4531af40cee444f9d78cf5cdd26847a.png" alt="在这里插入图片描述"><br>只有一个push，是一个字符串的地址，32位，所以只有一个参数<br>回到<code>sub_401020</code>，点击函数名按y键，将参数修改为一个<br><img src="https://img-blog.csdnimg.cn/9d691134877c4f668357f4bca349ad13.png" alt="在这里插入图片描述"><br>现在401095处可以F5了<br><img src="https://img-blog.csdnimg.cn/6dea3808b029443486cbbea514693c18.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>19行可知v0和byte_4212c0进行异或，得到byte_41EA08<br>byte_41EA08函数查看内容<br><img src="https://img-blog.csdnimg.cn/5941d4deac9b4d83bfa720d54819f544.png" alt="在这里插入图片描述"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;MSAWB~FXZ:J:`tQJ\&quot;N@ bpdd&#125;8g&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(i ^<span class="built_in">ord</span>(a[i]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>MRCTF{@_R3@1ly_E2_R3verse!}<br>flag是：flag{@_R3@1ly_E2_R3verse!}</p><h3 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h3><p>64位ida打开<br><img src="https://img-blog.csdnimg.cn/1606ab4050bc4a0fb74ac6324ae921d1.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>搜索main函数，打开main_main<br>go语言写的，看别的师傅都是直接搜到的，我也不知道为什么师傅们知道搜就可以emmm<br>总之标黄的地方<br><img src="https://img-blog.csdnimg.cn/69ca3c541f4f422c8faf080d30966e7c.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/987d1cc3b023415cb2a8d9ae136a7877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：flag{hello_world_gogogo}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(4)</title>
    <link href="http://example.com/2021/07/23/buuctf-misc%E7%BB%83%E4%B9%A0(4)/"/>
    <id>http://example.com/2021/07/23/buuctf-misc%E7%BB%83%E4%B9%A0(4)/</id>
    <published>2021-07-23T07:06:08.782Z</published>
    <updated>2021-07-23T07:11:50.729Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h3><p>爆破出密码<br><img src="https://img-blog.csdnimg.cn/a9a7b96d8608431481a3907be068f21a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>打开，使用<a href="https://tool.bugku.com/brainfuck/?wafcloud=1">此网站</a>解密<br>flag是：flag{e4bbef8bdf9743f8bf5b727a9f6332a8}</p><h3 id="后门查杀"><a href="#后门查杀" class="headerlink" title="后门查杀"></a>后门查杀</h3><p>下载下来的文件解压之后使用D盾扫描<br><img src="https://img-blog.csdnimg.cn/4d7f5963a44b400ea5a02427b870e8b0.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将标红的文件打开，因为提示给了md5，所以搜索md5<br><img src="https://img-blog.csdnimg.cn/ca0e40e2f9ef4a889ebd9fbdadcbc254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>关于md5的都是<code>$k</code>或者<code>$pass</code><br>搜索这两个<br><img src="https://img-blog.csdnimg.cn/b05efef5bc2b491585367ad1a87cdc6e.png" alt="在这里插入图片描述"><br>flag是：flag{6ac45fb83b3bc355c024f5034b947dd3}</p><h3 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h3><p>本题<a href="https://blog.csdn.net/fi0stBlooder/article/details/118398330?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-7.pc_relevant_baidujshouduan&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-7.pc_relevant_baidujshouduan">参考博客</a><br>文件是conf.bin，是宽带数据文件，用RouterPassView打开<br>没有给出flag，猜测是账户名或者是密码<br><img src="https://img-blog.csdnimg.cn/b8884edc6b224cb5b35d0d21cf2ae574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：flag{053700357621}</p><h3 id="数据包中的线索"><a href="#数据包中的线索" class="headerlink" title="数据包中的线索"></a>数据包中的线索</h3><p>过滤http，追踪http最后一个包，发现base64编码<br><img src="https://img-blog.csdnimg.cn/30bd119800dd4cb39ac3c7161e8cf1f6.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/c28ec310db754dc2bf8d8f184cdb63c6.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用<a href="https://the-x.cn/base64">此网站</a>解密<br><img src="https://img-blog.csdnimg.cn/828059cdf1904de9916089a07bcc5e76.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：flag{209acebf6324a09671abc31c869de72c}</p><h3 id="来首歌吧"><a href="#来首歌吧" class="headerlink" title="来首歌吧"></a>来首歌吧</h3><p><img src="https://img-blog.csdnimg.cn/971d458416974e90bb29010f26428b08.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>摩斯密码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..... -... -.-. ----. ..--- ..... -.... ....- ----. -.-. -... ----- .---- ---.. ---.. ..-. ..... ..--- . -.... .---- --... -.. --... ----- ----. ..--- ----. .---- ----. .---- -.-.</span><br></pre></td></tr></table></figure><p>5BC925649CB0188F52E617D70929191C</p><p>flag是：flag{5BC925649CB0188F52E617D70929191C}</p><h3 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h3><p>使用binwalk分离文件，得到一个压缩包和一个文件夹，文件夹里面有一个有密码的压缩包和一张图片<br><img src="https://img-blog.csdnimg.cn/f1dfd8ecc85f4fbab15f9f5bc10a773b.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/3b29cb36479a40939b53a2e5844b25cf.png" alt="在这里插入图片描述"><br>使用steghide分析这张图片发现隐藏信息<br>steghide的安装：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install steghide</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/facc34da99104e75b54fd280364b4118.png" alt="在这里插入图片描述"><br>打开ko.txt，得到密码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bV1g6t5wZDJif^J7</span><br></pre></td></tr></table></figure><p>输入即可解压缩，得到flag<br>flag是：flag{1RTo8w@&amp;4nK@z*XL}</p><h3 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h3><p>使用binwalk分离图片，得到虚拟机磁盘文件<br><img src="https://img-blog.csdnimg.cn/2ba51ee2bfb64f3886b7481c8493568f.png" alt="在这里插入图片描述"><br>用以下命令解压</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>z x flag.vmdk -o./</span><br></pre></td></tr></table></figure><p>得到四个文件夹，打开这两个文件夹<br><img src="https://img-blog.csdnimg.cn/28ac4aeb1a24471f8643d1ebc29b0bd1.png" alt="在这里插入图片描述"><br>里面的内容用<a href="https://tool.bugku.com/brainfuck/?wafcloud=1">这个网站</a>解密<br>flag是：flag{N7F5_AD5_i5_funny!}</p><h3 id="webshell后门"><a href="#webshell后门" class="headerlink" title="webshell后门"></a>webshell后门</h3><p>D盾扫一下，打开那个多功能大木马，搜索pass<br>flag是：flag{ba8e6c6f35a53933b871480bb9a9545c}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(3)</title>
    <link href="http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(3)/"/>
    <id>http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(3)/</id>
    <published>2021-07-22T15:04:13.249Z</published>
    <updated>2021-07-22T15:06:51.459Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="镜子里的世界"><a href="#镜子里的世界" class="headerlink" title="镜子里的世界"></a>镜子里的世界</h3><p>因为是镜子里的世界，所以模糊一些，所以像素低，所以是LSB<br><img src="https://img-blog.csdnimg.cn/img_convert/37d93a7c439d4aa56d91a6120c112144.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-a4MYbgry-1626942462358)(https://csdn-img-blog.oss-cn-beijing.aliyuncs.com/e295f60bb66349cfad19648bc573c8de.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70)]"><br>flag是：flag{st3g0_saurus_wr3cks}</p><h3 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h3><p>binwalk分离出来一个压缩包，爆破密码<br><img src="https://img-blog.csdnimg.cn/img_convert/944c148d9d1252838966cf00d11e9c86.png" alt="在这里插入图片描述"><br>flag是：flag{75a3d68bf071ee188c418ea6cf0bb043}</p><h3 id="爱因斯坦"><a href="#爱因斯坦" class="headerlink" title="爱因斯坦"></a>爱因斯坦</h3><p>Stegsolve扫出来两个文件，binwalk分离，需要密码，爆破不出来，在属性里面发现密码<br><img src="https://img-blog.csdnimg.cn/img_convert/07654442b44c84a5699830065304d7d0.png" alt="在这里插入图片描述"></p><p>flag是：flag{dd22a92bf2cceb6c0cd0d6b83ff51606}</p><h3 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h3><p>打开之后发现都是TCP包，所以直接追踪TCP流量<br><img src="https://img-blog.csdnimg.cn/img_convert/100de17ae40997ba444d0c197f741b68.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/25ab31df68529a5ed39c83f6f41b978a.png" alt="在这里插入图片描述"><br>flag是：flag{385b87afc8671dee07550290d16a8071}</p><h3 id="另外一个世界"><a href="#另外一个世界" class="headerlink" title="另外一个世界"></a>另外一个世界</h3><p>WinHEX打开，最后又一串二进制数字<br><img src="https://img-blog.csdnimg.cn/img_convert/e241c3c9f2647b324139cd5adef98675.png" alt="在这里插入图片描述"><br>八个数字一组转ASCII码<br><img src="https://img-blog.csdnimg.cn/img_convert/d7522752c8b714155870fc2fd190539a.png" alt="在这里插入图片描述"><br>flag是：flag{koekj3s}</p><h3 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h3><p>WinHEX打开，搜索flag<br><img src="https://img-blog.csdnimg.cn/caa42108730043dc8fe9d6647df85c6c.png" alt="在这里插入图片描述"><br>base64解密<br>flag是：flag{377cbadda1eca2f2f73d36277781f00a}</p><h3 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h3><p>LSB，发现为zip文件，将它导出<br><img src="https://img-blog.csdnimg.cn/fb70715b7b034908bbc8fb889dccb2a7.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>导出之后发现zip文件损坏，使用<a href="http://forspeed.onlinedown.net/down/95222_20170619151215.zip">修复软件</a><br><img src="https://img-blog.csdnimg.cn/d8ce27e2996946069a4d986d4152061f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>修复完成，解压，有一个文件，改后缀为.txt<br>搜索flag没有，搜索  {  符号，得到<br><img src="https://img-blog.csdnimg.cn/217af219f4e640ee86f7b920f4743850.png" alt="在这里插入图片描述"><br>flag是：flag{dd0gf4c3tok3yb0ard4g41n~~~}</p><h3 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h3><p>有一串盲文，对照翻译得到kmdonowg<br>用这个来解压压缩包，是一个音频，听一下是摩斯密码的声音，听不清可以使用Audacity来看<br><img src="https://img-blog.csdnimg.cn/e98bc931cf4f44de92691fe7d7dc64fe.png" alt="在这里插入图片描述"><br>这样方便分析<br>得到</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-.-. - ..-. .-- .--. . .. ----- ---.. --... ...-- ..--- ..--.. ..--- ...-- -.. --..</span><br></pre></td></tr></table></figure><p><a href="http://www.metools.info/other/o105.html">网站</a><br><img src="https://img-blog.csdnimg.cn/aa902cd782a14a6c84788df870e998ae.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提交不对，改成小写字母即可<br>flag是：flag{wpei08732?23dz}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(2)</title>
    <link href="http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(2)/"/>
    <id>http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(2)/</id>
    <published>2021-07-22T08:13:01.302Z</published>
    <updated>2021-07-22T08:14:37.696Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>既然是LSB<br>使用Stegsolve<br><img src="https://img-blog.csdnimg.cn/img_convert/452ac2d6adff729f81eb08fcf7c3eb20.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/d2d24741676aee0013ced6a9705d86ce.png" alt="在这里插入图片描述"><br>得到二维码，扫一扫即可<br><img src="https://img-blog.csdnimg.cn/img_convert/c1281bc6749dc1d02fb01926f6fab148.png" alt="在这里插入图片描述"><br>flag是：flag{1sb_i4_s0_Ea4y}</p><h3 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h3><p>右键属性详细信息<br><img src="https://img-blog.csdnimg.cn/img_convert/ea9beb738791736736766cf6de3e34b9.png" alt="在这里插入图片描述"><br>flag是：flag{870c5a72806115cb5439345d8b014396}</p><h3 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h3><p>给了提示是登录登录方法，就直接过滤搜</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.request.method==POST</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/d029384b2b1b2ba0958ddb9dd8374894.png" alt="在这里插入图片描述"><br>flag是：flag{ffb7567a1d4f4abdffdb54e022f8facd}</p><h3 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h3><p>4位数字爆破<br><img src="https://img-blog.csdnimg.cn/img_convert/84b5bbe196b16c4f438f6c40b1940ced.png" alt="在这里插入图片描述"><br>flag是：flag{1773c5da790bd3caff38e3decd180eb7}</p><h3 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/9ddc024cf7ae2b60723dab00477a53fe.png" alt="在这里插入图片描述"><br>flag是：flag{878865ce73370a4ce607d21ca01b5e59}</p><h3 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h3><p>Winhex打开，看到是zip伪加密<br><img src="https://img-blog.csdnimg.cn/img_convert/95cb7ac1a816bde1d5d58eb3e6943062.png" alt="在这里插入图片描述"><br>使用工具ZipCenOp，把它和压缩包放在同一个文件夹里，打开cmd切换到ZipCenOp的文件夹执行：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ZipCenOp.jar r 文件名.zip </span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/d371deda28690f5bff41861e5988bb37.png" alt="在这里插入图片描述"><br>现在可以正常解压了，打开就有flag了<br>flag是：flag{Adm1N-B2G-kU-SZIP}</p><h3 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h3><p>binwalk分离一下，然后爆破密码<br><img src="https://img-blog.csdnimg.cn/img_convert/c64c133715ccdcee565f4fe9c1926687.png" alt="在这里插入图片描述"><br>flag是：flag{b025fc9ca797a67d2103bfbc407a6d5f}</p><h3 id="被嗅探的能量"><a href="#被嗅探的能量" class="headerlink" title="被嗅探的能量"></a>被嗅探的能量</h3><p>因为题目说抓取的文件，所以直接搜索flag就好了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains <span class="string">&quot;flag&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/370250d1eb7c7ad85f0553e26a75fefc.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/img_convert/6724af088214fad026a5fc33a26d7537.png" alt="在这里插入图片描述"><br>flag是：flag{da73d88936010da1eeeb36e945ec4b97}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(1)</title>
    <link href="http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(1)/"/>
    <id>http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(1)/</id>
    <published>2021-07-22T02:27:02.431Z</published>
    <updated>2021-07-22T02:38:13.706Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h3><p>图片隐写，使用Stegsolve<br><img src="https://img-blog.csdnimg.cn/img_convert/9875d9b601f0b2165fb649e1d313b300.png" alt="在这里插入图片描述"><br>左右移动看到<br><img src="https://img-blog.csdnimg.cn/img_convert/7ffa777615512af3e657a9111fe5135c.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/6d5dc630f59fce50b77506aa3fbbc8cb.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/087df19e333f81021885d069394ebc25.png" alt="在这里插入图片描述"><br>flag是：flag{he11ohongke}</p><h3 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h3><p>一张二维码，扫一扫没有flag<br>使用binwalk分离<br><img src="https://img-blog.csdnimg.cn/img_convert/496d8344261f7d2f691dae94881f5bcf.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/3a7106b0067aa71da6c8effeab71adf1.png" alt="在这里插入图片描述"><br>得到的文件里面有一个压缩包<br><img src="https://img-blog.csdnimg.cn/img_convert/13c340dc9feb260213d80bcf06de7146.png" alt="在这里插入图片描述"><br>需要密码，有文件名可知密码是四个数字，可以采用下面显示的软件爆破<br><img src="https://img-blog.csdnimg.cn/img_convert/dbf599981a471e2daa2862221b7bb4ac.png" alt="在这里插入图片描述"><br>输入解压，打开文本文件<br>flag是：flag{vjpw_wnoei}</p><h3 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h3><p>一个exe文件，无法运行，改后缀为txt，打开看到base64提示，全选复制</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/<span class="number">396</span>Tx564G1UouicKg19hwPCDcrMJ9m7/<span class="number">7</span>n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+<span class="number">3</span>pnDp9yF7tneQvvmcZu/<span class="number">2l</span>f78zhU+<span class="number">5</span>i9yxv4T3T2O0/<span class="number">7</span>eud68OT2H3LCft0l/ae9ZlTo+<span class="number">23</span>pPvX7/rwJHbfcsI+<span class="number">3</span>aW9Z33m1Gj7Len+<span class="number">9b</span>s+PIndt5ywT3dp71mfOTXafku6f/<span class="number">2u</span>D09i9y0n7NNd2nvWZ06Ntt+S7l+/<span class="number">68</span>MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/<span class="number">68</span>MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/<span class="number">6</span>cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/<span class="number">31</span>rectP0Wu2/<span class="number">5Lu</span>n+<span class="number">9b</span>s+PMnu/XZvfctJ22+x+<span class="number">5b</span>vku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+<span class="number">5l</span>3+tK935vApyd+<span class="number">8</span>y5/<span class="number">29</span>c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/<span class="number">3</span>VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+<span class="number">4b</span>ds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+<span class="number">4b</span>ds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+<span class="number">5</span>RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+<span class="number">2</span>tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/<span class="number">9</span>tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+<span class="number">5</span>M1G+<span class="number">1</span>o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+<span class="number">0</span>xppM32HpfWTIxPbMzeNtJmS3Zyw/<span class="number">7</span>RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+<span class="number">5</span>SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/<span class="number">8</span>Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI<span class="comment">//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==</span></span><br></pre></td></tr></table></figure><p>使用<a href="http://tool.chinaz.com/tools/imgtobase/">在线工具</a>解密<br>得到一张二维码，使用QR Research解密<br><img src="https://img-blog.csdnimg.cn/img_convert/831a832f668b085bcd76160839c5a6f8.png" alt="在这里插入图片描述"><br>flag是：flag{dca57f966e4e4e31fd5b15417da63269}</p><h3 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h3><p>Winhex打开搜索flag<br><img src="https://img-blog.csdnimg.cn/img_convert/858e196e5ade27b1ba264672a7c80c29.png" alt="在这里插入图片描述"><br>flag是：flag{stego_is_s0_bor1ing}</p><h3 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h3><p>根据提示，需要改宽度和高度<br>winhex打开，从第二行开始，前四位是宽，后四位是高<br><img src="https://img-blog.csdnimg.cn/img_convert/7d7ef9f80954f70cea33a5b4539ac753.png" alt="在这里插入图片描述"><br>将01改为02（Edit-Modify Data)<br><img src="https://img-blog.csdnimg.cn/img_convert/7b27cb5465c9528c826d3bd683a14ee5.png" alt="在这里插入图片描述"><br>Save as 保存，查看新图片<br><img src="https://img-blog.csdnimg.cn/img_convert/dad913cb9ff8e385e0e2deddb82ec5cb.png" alt="在这里插入图片描述"><br>flag{He1l0_d4_ba1}</p><h3 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h3><p>有一个压缩包，提示了密码是4位数字，使用[ARCHPR]爆破可得(<a href="http://www.ddooo.com/softdown/176170.htm">http://www.ddooo.com/softdown/176170.htm</a>)<br><img src="https://img-blog.csdnimg.cn/img_convert/aa5e22544adb8500c9b5ae62dadc93b7.png" alt="在这里插入图片描述"><br>压缩包密码为2563，打开有base64加密的字符串<br>ZmxhZ3s3MDM1NDMwMGE1MTAwYmE3ODA2ODgwNTY2MWI5M2E1Y30=<br>解密得到flag<br>flag是：flag{70354300a5100ba78068805661b93a5c}</p><h3 id="乌镇峰会种图"><a href="#乌镇峰会种图" class="headerlink" title="乌镇峰会种图"></a>乌镇峰会种图</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/ac102555a7b306a6bbcfcabc4a26a46e.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/123e9ae24394bdb3fd79846eac09f661.png" alt="在这里插入图片描述"><br>flag是：flag{97314e7864a8f62627b26f3f998c37f1}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>实验室暑期CTF训练赛--第一周</title>
    <link href="http://example.com/2021/07/20/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9A%91%E6%9C%9FCTF%E8%AE%AD%E7%BB%83%E8%B5%9B--%E7%AC%AC%E4%B8%80%E5%91%A8/"/>
    <id>http://example.com/2021/07/20/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9A%91%E6%9C%9FCTF%E8%AE%AD%E7%BB%83%E8%B5%9B--%E7%AC%AC%E4%B8%80%E5%91%A8/</id>
    <published>2021-07-20T02:13:32.453Z</published>
    <updated>2021-07-21T12:40:07.420Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>只做了MISC和RE<br>题目和部分需要的工具链接：<br>链接：<a href="https://pan.baidu.com/s/1dwyK4jjlA44fFKZ3oQxQNg">https://pan.baidu.com/s/1dwyK4jjlA44fFKZ3oQxQNg</a><br>提取码：1uat</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="MISC2"><a href="#MISC2" class="headerlink" title="MISC2"></a>MISC2</h3><p>打开文件发现有一个音频，一个文件，文件记事本打开写着 <code>H4vFunWTHthisMP3</code> </p><p>一个音频加一串密钥的方式，所以使用MP3Steno<br><img src="https://img-blog.csdnimg.cn/20210718084454642.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将音频放入MP3Steno的文件夹</p><p>cmd打开，输入命令<br><img src="https://img-blog.csdnimg.cn/20210718084616264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210718084655108.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>生成txt文件，打开有一串字符，包上flag即可</p><p>flag是：flag{07715d8b6390495daa744cc22a62e2ef}</p><h3 id="timg-IN"><a href="#timg-IN" class="headerlink" title="timg_IN"></a>timg_IN</h3><p><img src="https://img-blog.csdnimg.cn/20210718085029287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>只有一张图片，binwalk扫了一下没有隐藏两张，发现也没有改长度和高度</p><p>使用工具Stegsolve.jar</p><p>找到自己java安装地址，cmd窗口打开bin文件，在该目录下输入如下命令<br><img src="https://img-blog.csdnimg.cn/20210718085637640.png" alt="在这里插入图片描述"><br>即可打开Stegsolve<br><img src="https://img-blog.csdnimg.cn/20210718085756889.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>操作图中红框里的按键左右移动</p><p>Blue 0 通道有一个二维码，扫一扫，得到一串字符</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- -.+++ +++.&lt; ++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; ++++[ -&gt;--- -&lt;]&gt;- ----- .&lt;+++ ++++[ -&gt;--- ----&lt; ]&gt;--- .&lt;+++ ++++[ -&gt;+++ ++++&lt; ]&gt;++. ++.&lt;+ +++++ [-&gt;-- ----&lt; ]&gt;--- ----- ---.- ----- .++++ ++++. &lt;++++ ++[-&gt; +++++ +&lt;]&gt;+ +++++ +++.. .---- .+.-- .&lt;+++ +++[- &gt;---- --&lt;]&gt; ----- -.--- .&lt;</span><br></pre></td></tr></table></figure><p>利用这个<a href="https://tool.bugku.com/brainfuck/?wafcloud=1">网站</a><br><img src="https://img-blog.csdnimg.cn/20210718101846818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>可以得到flag的前半段</p><p>通过观察我们发现图片的三色低像素通道都有一些像素块的样子<br>Green 0:<br><img src="https://img-blog.csdnimg.cn/20210718091629946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Red 0:<br><img src="https://img-blog.csdnimg.cn/20210718091726590.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以猜测是lsb </p><p>点这里<br><img src="https://img-blog.csdnimg.cn/20210718091818171.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>按下图设置，然后导出<br><img src="https://img-blog.csdnimg.cn/20210718092349531.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Notepad++打开，左边还有不需要的东西，按住ctrl+alt，拉取删掉，密文中间的空格同理，去掉了每一行的回车<br>得到如下字符</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">..... ..... ..... ...!? !!.?. ..... ..... ..... ..?.? !.?.. ..... </span><br><span class="line">............ ..... ..... ..... !.!.. ..... !.?.. ..... ..... ...!? !!.?! </span><br><span class="line">!!!!!..!!!!! !!!?. ?!.?! !!!!! !.?.. ..... ..... ...!? !!.?. ..... ..... </span><br><span class="line">...?...?!.?. ..... ..!.! !!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? </span><br><span class="line">.?!.?..!.?.. ..... ..... .!?!! .?... ..... ....? .?!.? ..... ..... ..... </span><br><span class="line">...........! .!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? .?!.? !!!!! </span><br><span class="line">.......!.... ..... !.?.. ..... ..... .!?!! .?... ..... ....? .?!.? ..... </span><br><span class="line">............ ..... !.?.. ..... ..... .!?!! .?!!! !!!!! !!!!? .?!.? !!!!! </span><br><span class="line">!!!!!..!!!!! !!.?. ..... ..... ..!?! !.?.. ..... ..... ?.?!. ?.... ..... </span><br><span class="line">.........!.? ..... ..... ..... !?!!. ?!!!! !!!!! !!!!! ?.?!. ?!!!! !!!.? </span><br><span class="line">............ ..... !?!!. ?.... ..... ..... ?.?!. ?..!. ?.... ..... ..!?! </span><br><span class="line">!.?......... ...?. ?!.?. ...!. ?....</span><br></pre></td></tr></table></figure><p>每过几个组就会有一个12个字符为一组的，12个的字符中间都是两个“<code>..</code>“，把他们换成空格<br><img src="https://img-blog.csdnimg.cn/20210718101705463.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后再取消换行，整理好之后的密文是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..... ..... ..... ...!? !!.?. ..... ..... ..... ..?.? !.?.. ..... ..... ..... ..... ..... ..... !.!.. ..... !.?.. ..... ..... ...!? !!.?! !!!!! !!!!! !!!?. ?!.?! !!!!! !.?.. ..... ..... ...!? !!.?. ..... ..... ...?. ?!.?. ..... ..!.! !!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? .?!.? !.?.. ..... ..... .!?!! .?... ..... ....? .?!.? ..... ..... ..... ..... ....! .!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? .?!.? !!!!! ..... !.... ..... !.?.. ..... ..... .!?!! .?... ..... ....? .?!.? ..... ..... ..... ..... !.?.. ..... ..... .!?!! .?!!! !!!!! !!!!? .?!.? !!!!! !!!!! !!!!! !!.?. ..... ..... ..!?! !.?.. ..... ..... ?.?!. ?.... ..... ..... ..!.? ..... ..... ..... !?!!. ?!!!! !!!!! !!!!! ?.?!. ?!!!! !!!.? ..... ..... ..... !?!!. ?.... ..... ..... ?.?!. ?..!. ?.... ..... ..!?! !.?.. ..... ...?. ?!.?. ...!. ?....</span><br></pre></td></tr></table></figure><p>还是使用那个网站<br><img src="https://img-blog.csdnimg.cn/20210718102001457.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>合起来就是flag了<br>flag是：flag{e1df719fffbca74aad0ed3cc026d8d0b}</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="ez-re"><a href="#ez-re" class="headerlink" title="ez_re"></a>ez_re</h3><p>这题有一个虚假的flag，我们可以先来看一看<br>通过搜索字符串我们发现了Game start字符<br>来到main函数<br><img src="https://img-blog.csdnimg.cn/20210720091051382.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>想着这里有一个判断，便跟进去看</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">v4 = <span class="number">99</span>;</span><br><span class="line">  v5 = <span class="number">23</span>;</span><br><span class="line">  v6 = <span class="number">113</span>;</span><br><span class="line">  v7 = <span class="number">2</span>;</span><br><span class="line">  v8 = <span class="number">106</span>;</span><br><span class="line">  v1 = a1 + <span class="number">1</span>;</span><br><span class="line">  v9 = <span class="number">5</span>;</span><br><span class="line">  v10 = <span class="number">114</span>;</span><br><span class="line">  v11 = <span class="number">9</span>;</span><br><span class="line">  v12 = <span class="number">109</span>;</span><br><span class="line">  v13 = <span class="number">2</span>;</span><br><span class="line">  v14 = <span class="number">93</span>;</span><br><span class="line">  v15 = <span class="number">36</span>;</span><br><span class="line">  v16 = <span class="number">75</span>;</span><br><span class="line">  v17 = <span class="number">62</span>;</span><br><span class="line">  v18 = <span class="number">97</span>;</span><br><span class="line">  v19 = <span class="number">13</span>;</span><br><span class="line">  v20 = <span class="number">100</span>;</span><br><span class="line">  v21 = <span class="number">15</span>;</span><br><span class="line">  v22 = <span class="number">106</span>;</span><br><span class="line">  v23 = <span class="number">53</span>;</span><br><span class="line">  v24 = <span class="number">83</span>;</span><br><span class="line">  v25 = <span class="number">50</span>;</span><br><span class="line">  v26 = <span class="number">89</span>;</span><br><span class="line">  v27 = <span class="number">60</span>;</span><br><span class="line">  v28 = <span class="number">3</span>;</span><br><span class="line">  v29 = <span class="number">60</span>;</span><br><span class="line">  v30 = <span class="number">65</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = *v1++;                                 <span class="comment">// v1是输入的字符串</span></span><br><span class="line">    *(v1 - <span class="number">1</span>) = ~(*(v1 - <span class="number">2</span>) &amp; v2) &amp; (*(v1 - <span class="number">2</span>) ^ v2);</span><br><span class="line">  &#125;                                             <span class="comment">// 这段的逻辑就是，v1[i] = ~(v1[i-1]&amp;v1[i])&amp;(v1[i-1]^v1[i])</span></span><br><span class="line">  <span class="keyword">while</span> ( Buf1 + <span class="number">27</span> != v1 );</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">memcmp</span>(Buf1, Buf2, <span class="number">0x1B</span>u) == <span class="number">0</span>;        <span class="comment">// 判断结果是否相等</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>感觉不错，写个脚本爆破，因为是与运算不容易逆回去</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">buf = [<span class="number">99</span>, <span class="number">23</span>, <span class="number">113</span>, <span class="number">2</span>, <span class="number">106</span>, <span class="number">5</span>, <span class="number">114</span>, <span class="number">9</span>, <span class="number">109</span>, <span class="number">2</span>, <span class="number">93</span>, <span class="number">36</span>, <span class="number">75</span>, <span class="number">62</span>, <span class="number">97</span>, <span class="number">13</span>, <span class="number">100</span>, <span class="number">15</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">83</span>, <span class="number">50</span>, <span class="number">89</span>, <span class="number">60</span>, <span class="number">3</span>, <span class="number">60</span>, <span class="number">65</span>]</span><br><span class="line">result = [<span class="number">0</span>] * <span class="number">27</span></span><br><span class="line">result[<span class="number">0</span>] = buf[<span class="number">0</span>]</span><br><span class="line">print(<span class="built_in">len</span>(buf))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(buf)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">        tmp = ~(buf[i-<span class="number">1</span>] &amp; j) &amp; (buf[i-<span class="number">1</span>] ^ j)</span><br><span class="line">        <span class="keyword">if</span> tmp == buf[i]:</span><br><span class="line">            result[i] = j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> result)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>得到ctfshow{do_you_like_fake??}</p><p>假的，都是假的，重新来过</p><p>那只能看main函数的第一个函数了，发现它没什么用<br><img src="https://img-blog.csdnimg.cn/20210720091901526.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>通过交叉引用，发现它还和这个函数有关。<br><img src="https://img-blog.csdnimg.cn/20210720091720827.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>跳转过去，F5<br><img src="https://img-blog.csdnimg.cn/20210720092026964.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>跟进上面红框中的函数<br><img src="https://img-blog.csdnimg.cn/20210720093840366.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>进入分析，发现有一个dword_402010，这里面有几个函数。<br><img src="https://img-blog.csdnimg.cn/20210720093924345.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210720093956158.png" alt="在这里插入图片描述"><br>分析一下是经过改变的RC4<br>本来应该是i，这里改了<br><img src="https://img-blog.csdnimg.cn/20210720094049642.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 我们看一下sub_4012D0函数<br> <img src="https://img-blog.csdnimg.cn/20210720094213375.png" alt="在这里插入图片描述"><br>onexit函数表示的是：在main函数结束之后还可以继续执行一段函数<br><img src="https://img-blog.csdnimg.cn/2021072009532646.png" alt="在这里插入图片描述"><br>将这个byte_403000中的数据拿出来，进行解密。然后再将每个值-7，即可得到flag<br>写脚本：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*key, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> k[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) </span><br><span class="line">&#123;</span><br><span class="line">s[i]=<span class="number">256</span> - i;</span><br><span class="line">k[i]=key[i%Len];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) </span><br><span class="line">&#123;</span><br><span class="line">j=(j+s[i]+k[i])%<span class="number">256</span>;</span><br><span class="line">tmp=s[i];</span><br><span class="line">s[i]=s[j];</span><br><span class="line">s[j]=tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*Data,<span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> k=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp;</span><br><span class="line"><span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;Len;k++)</span><br><span class="line">&#123;</span><br><span class="line">i=(i+<span class="number">1</span>)%<span class="number">256</span>;</span><br><span class="line">j=(j+s[i])%<span class="number">256</span>;</span><br><span class="line">tmp=s[i];</span><br><span class="line">s[i]=s[j];</span><br><span class="line">s[j]=tmp;</span><br><span class="line">t=(s[i]+s[j])%<span class="number">256</span>;</span><br><span class="line">Data[k]^=s[t];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> s[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i,j,k;</span><br><span class="line"><span class="keyword">char</span> key[<span class="number">256</span>] = <span class="string">&quot;keykeykey&quot;</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> data[] =</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">0xDC</span>, <span class="number">0x47</span>, <span class="number">0x7F</span>, <span class="number">0x6E</span>, <span class="number">0x9A</span>, <span class="number">0xD8</span>, <span class="number">0x60</span>, <span class="number">0x77</span>, <span class="number">0xF4</span>, <span class="number">0xB0</span>, </span><br><span class="line"><span class="number">0x8C</span>, <span class="number">0x54</span>, <span class="number">0xB0</span>, <span class="number">0xAA</span>, <span class="number">0x26</span>, <span class="number">0x23</span>, <span class="number">0x02</span>, <span class="number">0x42</span>, <span class="number">0x8E</span>, <span class="number">0xBA</span>, </span><br><span class="line"><span class="number">0x90</span>, <span class="number">0x8C</span>, <span class="number">0xAB</span>, <span class="number">0x86</span>, <span class="number">0x24</span>, <span class="number">0x6E</span>, <span class="number">0xF8</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> data_len = <span class="number">27</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> key_len = <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rc4_init(s,(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)key,key_len);</span><br><span class="line">rc4_crypt(s,(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)data,data_len);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">27</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%x &quot;</span>,data[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210720095837782.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>再做处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">buf2 = [<span class="number">0x6a</span>,<span class="number">0x7b</span>,<span class="number">0x6d</span>,<span class="number">0x7a</span>,<span class="number">0x6f</span>,<span class="number">0x76</span>,<span class="number">0x7e</span>,<span class="number">0x82</span>,<span class="number">0x80</span>,<span class="number">0x37</span>,<span class="number">0x7c</span>,<span class="number">0x66</span>,<span class="number">0x6e</span>,<span class="number">0x37</span>,<span class="number">0x7b</span>,<span class="number">0x66</span>,<span class="number">0x7b</span>,<span class="number">0x3b</span>,<span class="number">0x6c</span>,<span class="number">0x66</span>,<span class="number">0x3c</span>,<span class="number">0x6c</span>,<span class="number">0x6a</span>,<span class="number">0x79</span>,<span class="number">0x6c</span>,<span class="number">0x7b</span>,<span class="number">0x84</span>]</span><br><span class="line">buf = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(buf2)):</span><br><span class="line">    buf.append(buf2[i] - <span class="number">7</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> buf)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>flag是：ctfshow{y0u_g0t_t4e_5ecret}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="比赛" scheme="http://example.com/categories/%E6%AF%94%E8%B5%9B/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>2021CISCN初赛部分RE</title>
    <link href="http://example.com/2021/07/16/2021CISCN%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86RE/"/>
    <id>http://example.com/2021/07/16/2021CISCN%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86RE/</id>
    <published>2021-07-16T06:50:34.009Z</published>
    <updated>2021-07-21T12:40:23.107Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="glass"><a href="#glass" class="headerlink" title="glass"></a>glass</h2><p>题目解压之后发现是apk文件，更改后缀为.zip，再次解压<br><img src="https://img-blog.csdnimg.cn/20210714081212743.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210714081237754.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看到有.dex文件。dex文件是Android系统的可执行文件，包含应用程序的全部操作指令以及运行时数据。我们使用dex2jar反编译该文件。<br>把class.dex复制到dex2jar.bat所在目录，即dex2jar目录下。打开cmd，进入dex2jar所在的目录然后运行dex2jar.bat classes.dex，生成classes-dex2jar.jar就是所要转化jar包。<br><img src="https://img-blog.csdnimg.cn/20210714082432516.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210714082730723.png" alt="在这里插入图片描述"><br>使用jd-gui打开classes-dex2jar.jar</p><p><img src="https://img-blog.csdnimg.cn/20210714083246656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210714083645906.png" alt="在这里插入图片描述"></p><p>我们可以看到函数里面存在native定义，并且，在整个java代码里面没有checkFlag的定义，只有一个声明，这些都说明函数是定义在so文件之中的。<br>我们来寻找需要的so文件。<br>题目的lib文件里面只有一个so文件，正好也是寻找的native的so文件。<img src="https://img-blog.csdnimg.cn/20210714084434689.png" alt="在这里插入图片描述"><br>使用ida对其进行反编译。<br>通过搜索checkFlag函数找到该函数<br><img src="https://img-blog.csdnimg.cn/20210714084953594.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>我们可以知道flag的长度应该是39位的<br>接下来看函数<code>sub_FFC</code>和<code>sub_1088</code><br>sub_FFC:<br><img src="https://img-blog.csdnimg.cn/20210714085334146.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>sub_1088:<br><img src="https://img-blog.csdnimg.cn/20210714085415538.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以很明显的可以看出来是RC4加密，不清楚的同学可以对照<a href="https://baike.baidu.com/item/RC4/3454548?fr=aladdin">百度百科</a>上面的代码比较，会发现非常相像。同时，RC4的加密脚本也就是它的解密脚本。<br>那么checkFlag中的12345678就是key。<br>我们再查看函数<code>sub_10D4</code>：<br>可以看到对RC4处理完成的字符串再次进行处理，先进行异或，后面还有一些处理，看似复杂但是不用太在意，写脚本的时候直接倒回去就可以。<br>返回主checkFlag，我们发现最后得到的字符要和<code>unk_497C</code>进行比较。<br>unk_497C：<br>Shift+E提取一下<br><img src="https://img-blog.csdnimg.cn/20210714092601335.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>写脚本破解</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*key, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> k[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) </span><br><span class="line">&#123;</span><br><span class="line">        s[i]=i;</span><br><span class="line">        k[i]=key[i%Len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) </span><br><span class="line">&#123;</span><br><span class="line">        j=(j+s[i]+k[i])%<span class="number">256</span>;</span><br><span class="line">        tmp=s[i];</span><br><span class="line">        s[i]=s[j];</span><br><span class="line">        s[j]=tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*Data,<span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;Len;k++)</span><br><span class="line">    &#123;</span><br><span class="line">        i=(i+<span class="number">1</span>)%<span class="number">256</span>;</span><br><span class="line">        j=(j+s[i])%<span class="number">256</span>;</span><br><span class="line">        tmp=s[i];</span><br><span class="line">        s[i]=s[j];</span><br><span class="line">        s[j]=tmp;</span><br><span class="line">        t=(s[i]+s[j])%<span class="number">256</span>;</span><br><span class="line">        Data[k]^=s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> s[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i,j,k;</span><br><span class="line"><span class="keyword">char</span> key[<span class="number">256</span>] = <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> data[] =</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">0xA3</span>, <span class="number">0x1A</span>, <span class="number">0xE3</span>, <span class="number">0x69</span>, <span class="number">0x2F</span>, <span class="number">0xBB</span>, <span class="number">0x1A</span>, <span class="number">0x84</span>, <span class="number">0x65</span>, <span class="number">0xC2</span>, </span><br><span class="line"><span class="number">0xAD</span>, <span class="number">0xAD</span>, <span class="number">0x9E</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x1F</span>, <span class="number">0x8E</span>, <span class="number">0x36</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0xE1</span>, <span class="number">0xEB</span>, <span class="number">0xAF</span>, <span class="number">0xF0</span>, <span class="number">0xEA</span>, <span class="number">0xC4</span>, <span class="number">0xA8</span>, <span class="number">0x2D</span>, <span class="number">0x42</span>, <span class="number">0xC7</span>, </span><br><span class="line"><span class="number">0x6E</span>, <span class="number">0x3F</span>, <span class="number">0xB0</span>, <span class="number">0xD3</span>, <span class="number">0xCC</span>, <span class="number">0x78</span>, <span class="number">0xF9</span>, <span class="number">0x98</span>, <span class="number">0x3F</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> data_len = <span class="number">39</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> key_len = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; data_len; j += key_len )</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> ( k = <span class="number">0</span>; (key_len &amp; ~(key_len &gt;&gt; <span class="number">31</span>)) != k &amp;&amp; j + k &lt; data_len; ++k )</span><br><span class="line">data[j + k] ^= key[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; data_len;i += <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">data[i+<span class="number">1</span>] = data[i] ^ data[i+<span class="number">1</span>];</span><br><span class="line">data[i+<span class="number">2</span>] = data[i+<span class="number">1</span>] ^ data[i+<span class="number">2</span>];</span><br><span class="line">data[i] = data[i+<span class="number">2</span>] ^ data[i];</span><br><span class="line">&#125;</span><br><span class="line">rc4_init(s,(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)key,key_len);</span><br><span class="line">rc4_crypt(s,(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)data,data_len);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">39</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flag是：CISCN{6654d84617f627c88846c172e0f4d46c}</p><h2 id="baby-bc"><a href="#baby-bc" class="headerlink" title="baby.bc"></a>baby.bc</h2><p>查看文件类型<br><img src="https://img-blog.csdnimg.cn/20210714144413296.png" alt="在这里插入图片描述"><br>LLVM IR bitcode，二进制文件。需要转换成.s，然后再转成可执行文件。<br>在当前目录下打开终端，输入如下命令：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang baby.bc -o baby</span><br></pre></td></tr></table></figure><p>可以看到生成的文件已经是可执行文件了<br><img src="https://img-blog.csdnimg.cn/20210714150655595.png" alt="在这里插入图片描述"><br>将该生成的文件使用IDA打开<br>查看main函数<br><img src="https://img-blog.csdnimg.cn/20210714154407888.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>那么接下来就查看<code>fill_number</code>和<code>docheck</code>两个函数了<br>fill_number():</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">fill_number</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v2; <span class="comment">// [rsp+1h] [rbp-69h]</span></span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// [rsp+11h] [rbp-59h]</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [rsp+21h] [rbp-49h]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [rsp+31h] [rbp-39h]</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+40h] [rbp-2Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+41h] [rbp-29h]</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 v8; <span class="comment">// [rsp+4Ah] [rbp-20h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+52h] [rbp-18h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+5Ah] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = v10;</span><br><span class="line">    v8 = <span class="number">5</span> * v10;</span><br><span class="line">    v7 = *(_BYTE *)(a1 + <span class="number">5</span> * v10);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v7 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10] = v7 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = *(_BYTE *)(a1 + v8 + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">1</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v5 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">1</span>] = v5 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v4 = *(_BYTE *)(a1 + v8 + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">2</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">2</span>] = v4 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v3 = *(_BYTE *)(a1 + v8 + <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">3</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">3</span>] = v3 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v2 = *(_BYTE *)(a1 + v8 + <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">4</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v2 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">4</span>] = v2 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v10;</span><br><span class="line">    v6 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v9 + <span class="number">1</span> &lt; <span class="number">5</span> );</span><br><span class="line">  <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由这段代码可得，五个字符是一循环，分别判断其每一行的1~5位的数字。分析if/else，主要就是说map[]不为0时，当前的输入字符必须是’0’；如果map[]为0，当前的map字符为输入字符的ASCII码减去48。</p><p>map[]是一个二维数组，我们可以查看它的值。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>,   <span class="number">0</span>,   </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>fill_number函数的功能是：<br>当5*5的map二维矩阵中的值为0时，将该值转化为输入字符的ASCII码减去48；不为0时，对应的输入值为字符一定要为’0’。因为返回的是v6&amp;1，这个值需要返回是真值才可以出flag</p><p>docheck():<br>第一部分就是说map每行和每一列没有重复的数字<br>循环取输入的值，然后将取到值的对应位置写1，然后在后面循环中，如果该位置已经是1了，说明之前有出现过相同的数字，就是这样判断的。<br><img src="https://img-blog.csdnimg.cn/20210716143339279.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>接下来的row和col：<br>我们可以通过分析循环的次数和判断条件来得出如下的结果，代码比较长，需要耐心分析才行<br><img src="https://img-blog.csdnimg.cn/20210715085528211.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210715105804914.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最后得到的应该是如上的数独图<br>数独大佬可以自己解，变成大佬可以写代码用Z3<br>14253</p><p>53142</p><p>35421</p><p>21534</p><p>42315</p><p>根据上面的要求改map[2][2]和map[3][3]为0，md5之后得到flag<br><img src="https://img-blog.csdnimg.cn/20210716104956235.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag:CISCN{8a04b4597ad08b83211d3adfa1f61431}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="比赛" scheme="http://example.com/categories/%E6%AF%94%E8%B5%9B/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>动态分析之OllyDbg</title>
    <link href="http://example.com/2021/07/11/%E5%8A%A8%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8BOllyDbg/"/>
    <id>http://example.com/2021/07/11/%E5%8A%A8%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8BOllyDbg/</id>
    <published>2021-07-11T03:13:49.832Z</published>
    <updated>2021-07-11T03:15:53.318Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="OllyDbg调试器"><a href="#OllyDbg调试器" class="headerlink" title="OllyDbg调试器"></a>OllyDbg调试器</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>使用之前要设置UDD文件和插件的路径，一般设置成绝对路径。</p><p>单击“Options”-“Appearance”打开界面选项对话框，单击“Directories”。<br><img src="https://img-blog.csdnimg.cn/20210711082923320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>主界面：<br><img src="https://img-blog.csdnimg.cn/20210711082441268.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在反汇编面板窗口的列中，双击可以完成如下操作。<br>●Address列:显示被双击行地址的相对地址，再次双击返回标准地址模式。<br>●Hex dump列:设置或取消无条件断点，对应的快捷键是“F2” 键。<br>●Disassembly 列:调用汇编器，可直接修改汇编代码，对应的快捷键是空格键。<br>●Comment 列:允许增加或编辑注释，对应的快捷键是“;”键。</p><p>OllyDbg界面的外观由“Appearance”对话框里的“Fonts” “Colours” “Code highlighting” 标签页控制，可以定制。</p><p>可以将OllyDbg 关联到Windows资源管理器的右键快捷菜单里。关联后，当调试程序时，只需要在EXE或DLL文件上单击右键，就会出现“Open with Ollydbg”菜单项。要想实现关联，只需要先单击“Options” →“Add to Explorer”选项，再单击“Add llyDbg to menu in Windows Explorer”按钮。</p><p>为了让OllyDbg中断在程序的入口点，单击“Options”→“Debugging options” 选项，单击“Event” ，设置<br>OllyDbg对中断入口点、模块加载/卸载、线程创建/结束等事件的处理方式，将断点设置在“WinMain”处。<br><img src="https://img-blog.csdnimg.cn/20210711085408292.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="调试技术"><a href="#调试技术" class="headerlink" title="调试技术"></a>调试技术</h3><p><img src="https://img-blog.csdnimg.cn/20210711090417274.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>“F7”键和“F8”键的主要区别在于，若遇到call、loop等指令，按“F8”键会路过，按“F7”键会跟进。</p><p>当要重复按“F7” 键或“F8” 键时，OllyDbg提供了快捷键“Ctrl+F7” 和“Ctrl+F8”， 直到用户按“Esc”键、F12”键或遇到其他断点时停止。</p><p>若想回看之前单步跟踪的代码，可以按“-” (减号)键;若想让光标回到当前EIP所指向的语句，可以单击C按钮或双击EIP寄存器（EIP指向当前将要执行的指令）。</p><p>当位于某个call 指令中，想返回调用这个call 指令的位置时，可以按“Ctrl+F9” 快捷键执行“Execute till return” 命令, OllyDbg会停在遇到的第1个返回命令处( ret、retf或iret )。</p><p>如果已经进入系统DLL提供的API函数，当要返回应用程序领空（指在某一时刻CPU的CS:EIP指向的某段代码的所有者）时，可以按快捷键“Alt+F9”<br>执行”Execute till user code” 命令。</p><p>程序进入死循环可以按F12暂停程序。</p><p>反汇编窗口右键选择<code>search for（查找）</code>-&gt;<code>Name(label) in current module(当前模块中的名称(标签))</code>。可以查找API函数名下断点。</p><p>API函数大都采用_ stdeall 调用约定，即函数入口参数按从右到左的顺序入栈，由被调用者清理栈中的参数，返回值放在eax寄存器中。因此，对相关的API函数，要分析其前面的push指令,这些指令将参数放入栈，以传送给API调用。</p><p>修改内存中的数据后，为了使修改一直有效，必须将这个变化写进磁盘文件。选中修改后的代码，单击右键，点击“Copy to executable”→“Selection”<br>命令，将会打开文件编辑窗口。单击右键，执行快<br>捷菜单中的“Save File” 命令，即可将修改保存到文件中。</p><p><strong>Hit trace</strong><br>Hit trace能够让调试者辨别哪一部分代码被执行了，哪一部分没有。<br>在选中区域的每一条命令处设置一个INT3断点，当中断发生时，OllyDbg便把它去除。在使用Hit trace时，不能在数据中设置断点，否则程序可能会崩溃。<br>当遇到一段跳转分支比较多的代码，需要了解程序的执行线路时，可以使用Hit trace。选中这段代码，单击右键快捷菜单中的“Hit trace”→“Add selection”命令，将需要监视的代码选中，然后按“F9”键让程序运行，OllyDbg 就会在已被执行的指令前用不同的颜色添加标记。</p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p><strong>1、乱码问题</strong><br>使用OllyDbg跟踪程序时，可能会出现如下情况。<br><img src="https://img-blog.csdnimg.cn/2021071111040597.png" alt="在这里插入图片描述"><br>这是因为OllyDbg将这段代码当成了数据，没有进行反汇编识别。此时，只要执行OllyDbg 右键快捷菜单中的“Analysis” →“Analyse code” (“分析”→“分析代码”)命令或按“Ctrl+A” 快捷键，强迫OllyDbg重新分析代码即可。如果还是无法识别，可以尝试执行右键快捷菜单中的“Analysis”→“Remove analysis from module”(“分析”→“从模块中删除分析”)命令或在UDD目录中删除相应的UDD文件。</p><p><strong>2. OllyDbg 修改EIP</strong><br>将光标移到需要修改的地址上，执行右键快捷菜单中的“New origin here” (在此处新建EIP )命<br>令或使用快捷键“Ctrl+*” 即可修改EIP。</p><p><strong>3.已经删除了断点，OllyDbg重新加载时这些断点重新出现</strong><br>将配置文件olydbg.ini中的相应内容改成“ Backup UDD files=1”即可解决。</p><p><strong>4.在OllyDbg反汇编窗口输入“push E000”会提示未知标识符</strong><br>这是因为OllyDbg的反汇编引擎不能正确识别字符“E000” 中的“E”是字母还是数字。解决方法是:在字母前加一个“0”， 表示这是数字，即“push 0E000”。<br><img src="https://img-blog.csdnimg.cn/20210711110919295.png" alt="在这里插入图片描述"><br><strong>5. OllyDbg 出现“假死”现象</strong><br>用OllyDbg调试一些加壳程序，程序运行到断点(包括硬件断点)时，OllyDbg 会出现“假死”现象。解决方法是:打开配置文件ollydbgini,如果“ Restore windows“是一个很大的值，就设置“Restore windows 0”。</p><p><strong>6.执行复制到可执行文件时，提示错误信息“Unable to locate data in executable file”</strong><br>这里要修改的地方不在RawSize范围内。修改PE文件，使“RawSize = VirtualSize”。</p><p><strong>7.把call调用改成函数名的形式</strong><br>例如“call 401496”,假设401496h处是amsg_ exit 函数,将光标停在该处，按“Shift +;”快捷键，会弹出一个标签框，在其中输人字符“amsg _exit”, 所有调用401496h处的call指令都会变成“call <amsg _exit>““的形式。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="逆向学习笔记" scheme="http://example.com/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>MRCTF2020Transform-[WUSTCTF2020]level1-[WUSTCTF2020]level2-[GWCTF 2019]xxor</title>
    <link href="http://example.com/2021/06/04/[MRCTF2020]Transform-[WUSTCTF2020]level1-[WUSTCTF2020]level2-[GWCTF%202019]xxor/"/>
    <id>http://example.com/2021/06/04/[MRCTF2020]Transform-[WUSTCTF2020]level1-[WUSTCTF2020]level2-[GWCTF%202019]xxor/</id>
    <published>2021-06-04T01:23:29.114Z</published>
    <updated>2021-06-04T01:26:44.851Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="MRCTF2020-Transform"><a href="#MRCTF2020-Transform" class="headerlink" title="[MRCTF2020]Transform"></a>[MRCTF2020]Transform</h2><p><img src="https://img-blog.csdnimg.cn/20210603202732366.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida64打开，找到main函数<br><img src="https://img-blog.csdnimg.cn/20210603204022765.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>dword_40F040：<img src="https://img-blog.csdnimg.cn/20210603204049211.png" alt="在这里插入图片描述"><br>注意：<br><img src="https://img-blog.csdnimg.cn/20210603204128108.png" alt="在这里插入图片描述"><br>所以上面<code>dword_40f040</code>最后那个 <code>8 dup(0)</code> 的数据不是8，而是0</p><p>byte_40F0E0：<br><img src="https://img-blog.csdnimg.cn/20210603204410995.png" alt="在这里插入图片描述"><br>倒回去就行了，写脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dword_40F040 = [<span class="number">0x9</span>, <span class="number">0x0A</span>, <span class="number">0x0F</span>, <span class="number">0x17</span>, <span class="number">0x7</span>, <span class="number">0x18</span>, <span class="number">0x0C</span>, <span class="number">0x6</span>, <span class="number">0x1</span>, <span class="number">0x10</span>, <span class="number">0x3</span>, <span class="number">0x11</span>, <span class="number">0x20</span>, <span class="number">0x1D</span>, <span class="number">0x0B</span>, <span class="number">0x1E</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">0x4</span>, <span class="number">0x0D</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x2</span>, <span class="number">0x19</span>, <span class="number">0x5</span>, <span class="number">0x1F</span>, <span class="number">0x8</span>, <span class="number">0x12</span>, <span class="number">0x1A</span>, <span class="number">0x1C</span>, <span class="number">0x0E</span>, <span class="number">0</span>]</span><br><span class="line">byte_40F0E0 = [<span class="number">0x67</span>, <span class="number">0x79</span>, <span class="number">0x7B</span>, <span class="number">0x7F</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>, <span class="number">0x3C</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x79</span>, <span class="number">0x57</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x42</span>, <span class="number">0x7B</span>, <span class="number">0x2D</span>, <span class="number">0x2A</span>, <span class="number">0x66</span>, <span class="number">0x42</span>, <span class="number">0x7E</span>, <span class="number">0x4C</span>, <span class="number">0x57</span>, <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0x3C</span>, <span class="number">0x5C</span>, <span class="number">0x45</span>, <span class="number">0x6F</span>, <span class="number">0x62</span>, <span class="number">0x4D</span>]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">33</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dword_40F040)):</span><br><span class="line">    byte_40F0E0[i] ^= dword_40F040[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dword_40F040)):</span><br><span class="line">    flag[dword_40F040[i]] = byte_40F0E0[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag]))</span><br></pre></td></tr></table></figure><p>MRCTF{Tr4nsp0sltiON_Clph3r_1s_3z}</p><p>flag是：flag{Tr4nsp0sltiON_Clph3r_1s_3z}</p><h2 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h2><p>两个文件，有一个是OUTPUT，打开发现是一串数字，猜测是程序输出的东西<br><img src="https://img-blog.csdnimg.cn/20210603210415974.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看另外一个文件</p><p><img src="https://img-blog.csdnimg.cn/20210603210442293.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida64打开，看main函数<br><img src="https://img-blog.csdnimg.cn/20210603210734559.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>打开flag文件读取内容，之后将里面的内容按照12行到18行的语句进行处理后输出，输出的按照之前的猜测就是OUTPUT文件里面的内容。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">&#x27;0&#x27;</span>,<span class="number">198</span>,<span class="number">232</span>,<span class="number">816</span>,<span class="number">200</span>,<span class="number">1536</span>,<span class="number">300</span>,<span class="number">6144</span>,<span class="number">984</span>,<span class="number">51200</span>,<span class="number">570</span>,<span class="number">92160</span>,<span class="number">1200</span>,<span class="number">565248</span>,<span class="number">756</span>,<span class="number">1474560</span>,<span class="number">800</span>,<span class="number">6291456</span>,<span class="number">1782</span>,<span class="number">65536000</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span> (i &amp; <span class="number">1</span>):</span><br><span class="line">        print(<span class="built_in">chr</span>(a[i] &gt;&gt; (i)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="built_in">chr</span>(a[i] // (i)),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>ctf2020{d9-dE6-20c}</p><p>flag是：flag{d9-dE6-20c}</p><h2 id="WUSTCTF2020-level2"><a href="#WUSTCTF2020-level2" class="headerlink" title="[WUSTCTF2020]level2"></a>[WUSTCTF2020]level2</h2><p><img src="https://img-blog.csdnimg.cn/20210603212204971.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>UPX壳，kali脱壳<br><img src="https://img-blog.csdnimg.cn/20210603213822963.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/20210603213942818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70"><br>ida64打开<br>不知道为什么64说要用32，32说要用64，只好先查看字符串<br><img src="https://img-blog.csdnimg.cn/20210603214613747.png" alt="在这里插入图片描述"><br>结果在最下面发现了这个，就是flag</p><p>flag是：flag{Just_upx_-d}</p><h2 id="GWCTF-2019-xxor"><a href="#GWCTF-2019-xxor" class="headerlink" title="[GWCTF 2019]xxor"></a>[GWCTF 2019]xxor</h2><p><img src="https://img-blog.csdnimg.cn/20210603220727955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida64<br><img src="https://img-blog.csdnimg.cn/20210603222435517.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>首先输入一个字符串，然后进行中间部分的操作，最后需要满足44行的if判断，看一下函数<code>sub_400770</code><br><img src="https://img-blog.csdnimg.cn/2021060322294313.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到这样的关系式，求解</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a1[<span class="number">2</span>] - a1[<span class="number">3</span>] = <span class="number">2225223423</span></span><br><span class="line">a1[<span class="number">3</span>] + a1[<span class="number">4</span>] = <span class="number">4201428739</span></span><br><span class="line">a1[<span class="number">2</span>] - a1[<span class="number">4</span>] = <span class="number">1121399208</span></span><br><span class="line">a1[<span class="number">0</span>] = <span class="number">3746099070</span> </span><br><span class="line">a1[<span class="number">5</span>] = <span class="number">550153460</span></span><br><span class="line">a1[<span class="number">1</span>] = <span class="number">550153460</span></span><br></pre></td></tr></table></figure><p>利用z3<br>安装z3的命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install z3-solver</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a2,a3,a4 = BitVecs(<span class="string">&#x27;a2 a3 a4&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(a2 - a3 == <span class="number">2225223423</span>)</span><br><span class="line">s.add(a3 + a4 == <span class="number">4201428739</span>)</span><br><span class="line">s.add(a2 - a4 == <span class="number">1121399208</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        print(<span class="string">&quot;%s = %ld&quot;</span> % (i, m[i].as_long()))</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210604090658981.png" alt="在这里插入图片描述"><br>现在a1数组里的值就都知道了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a1=[<span class="number">3746099070</span>, <span class="number">550153460</span>, <span class="number">3774025685</span>, <span class="number">1548802262</span>, <span class="number">2652626477</span>, <span class="number">2230518816</span>]</span><br></pre></td></tr></table></figure><p>程序在main函数的36~43行进行了操作，看一下函数<code>sub_400686</code><br><img src="https://img-blog.csdnimg.cn/20210604090848704.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这是一个利用已知数组unk_601060对我们输入的整型数组进行异或操作，因此只需要将整个过程逆过来，for循环那段，将异或过程看成一个整体，最后就能得到输入的整型数组。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> xorm[<span class="number">6</span>];</span><br><span class="line">xorm[<span class="number">0</span>] = <span class="number">3746099070</span>;</span><br><span class="line">xorm[<span class="number">1</span>] = <span class="number">550153460</span>;</span><br><span class="line">xorm[<span class="number">2</span>] = <span class="number">3774025685</span>;</span><br><span class="line">xorm[<span class="number">3</span>] = <span class="number">1548802262</span>;</span><br><span class="line">xorm[<span class="number">4</span>] = <span class="number">2652626477</span>;</span><br><span class="line">xorm[<span class="number">5</span>] = <span class="number">2230518816</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>,j=<span class="number">0</span>,sum;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> temp[<span class="number">2</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> data[<span class="number">4</span>] = &#123; <span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">temp[<span class="number">0</span>] = xorm[i];</span><br><span class="line">temp[<span class="number">1</span>] = xorm[i + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">sum = <span class="number">0x458BCD42</span> * <span class="number">64</span>;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">temp[<span class="number">1</span>] -= (temp[<span class="number">0</span>] + sum + <span class="number">20</span>) ^ ((temp[<span class="number">0</span>] &lt;&lt; <span class="number">6</span>) + <span class="number">3</span>) ^ ((temp[<span class="number">0</span>] &gt;&gt; <span class="number">9</span>) + <span class="number">4</span>) ^ <span class="number">0x10</span>;</span><br><span class="line">temp[<span class="number">0</span>] -= (temp[<span class="number">1</span>] + sum + <span class="number">11</span>) ^ ((temp[<span class="number">1</span>] &lt;&lt; <span class="number">6</span>) + <span class="number">2</span>) ^ ((temp[<span class="number">1</span>] &gt;&gt; <span class="number">9</span>) + <span class="number">2</span>) ^ <span class="number">0x20</span>;</span><br><span class="line">sum -= <span class="number">0x458BCD42</span>;</span><br><span class="line">&#125;</span><br><span class="line">xorm[i] = temp[<span class="number">0</span>];</span><br><span class="line">xorm[i + <span class="number">1</span>] = temp[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x&quot;</span>,xorm[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210604091455605.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210604091932424.png" alt="在这里插入图片描述"><br>所以要将16进制转换成字符串<br>利用<a href="https://zixuephp.net/tool-str-hex.html">在线工具</a><br><img src="https://img-blog.csdnimg.cn/20210604092125277.png" alt="在这里插入图片描述"><br>flag是：flag{re_is_great!}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>github突然无法使用hexo g上传博客问题的解决</title>
    <link href="http://example.com/2021/06/03/github%E7%AA%81%E7%84%B6%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8hexo%20g%E4%B8%8A%E4%BC%A0%E5%8D%9A%E5%AE%A2%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/"/>
    <id>http://example.com/2021/06/03/github%E7%AA%81%E7%84%B6%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8hexo%20g%E4%B8%8A%E4%BC%A0%E5%8D%9A%E5%AE%A2%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/</id>
    <published>2021-06-03T12:19:56.486Z</published>
    <updated>2021-06-03T12:22:01.437Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>输入<code>hexo g</code>后<br> 报错：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can not read a block mapping entry; a multiline key may not be an implicit key</span><br></pre></td></tr></table></figure><p> 显示文章上传失败</p><p>有可能是因为文章的标题开头使用了不可以放在开头的字符</p><p>例如：<br>本来是：<code>[2021BUUCTF]RE</code><br>改成：<code>2021BUUCTF]RE</code>就可以了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="工具使用" scheme="http://example.com/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>GUET-CTF2019re-[SUCTF2019]SignIn-相册-[ACTF新生赛2020]usualCrypt</title>
    <link href="http://example.com/2021/06/03/[GUET-CTF2019]re-[SUCTF2019]SignIn-%E7%9B%B8%E5%86%8C-[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]usualCrypt/"/>
    <id>http://example.com/2021/06/03/[GUET-CTF2019]re-[SUCTF2019]SignIn-%E7%9B%B8%E5%86%8C-[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]usualCrypt/</id>
    <published>2021-06-03T03:34:20.151Z</published>
    <updated>2021-06-03T12:09:57.971Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="GUET-CTF2019-re"><a href="#GUET-CTF2019-re" class="headerlink" title="[GUET-CTF2019]re"></a>[GUET-CTF2019]re</h2><p><img src="https://img-blog.csdnimg.cn/20210603085928634.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>UPX壳，Kali脱壳<br><img src="https://img-blog.csdnimg.cn/20210603090143551.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210603090357732.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>elf文件，IDA64打开<br>通过字符串找到这里<br><img src="https://img-blog.csdnimg.cn/2021060309053181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看if判断里面的函数<code>sub_4009AE()</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BOOL8 __fastcall <span class="title">sub_4009AE</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">1629056</span> * *a1 != <span class="number">166163712</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6771600</span> * a1[<span class="number">1</span>] != <span class="number">731332800</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3682944</span> * a1[<span class="number">2</span>] != <span class="number">357245568</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">10431000</span> * a1[<span class="number">3</span>] != <span class="number">1074393000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3977328</span> * a1[<span class="number">4</span>] != <span class="number">489211344</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5138336</span> * a1[<span class="number">5</span>] != <span class="number">518971936</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7532250</span> * a1[<span class="number">7</span>] != <span class="number">406741500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5551632</span> * a1[<span class="number">8</span>] != <span class="number">294236496</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3409728</span> * a1[<span class="number">9</span>] != <span class="number">177305856</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">13013670</span> * a1[<span class="number">10</span>] != <span class="number">650683500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6088797</span> * a1[<span class="number">11</span>] != <span class="number">298351053</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7884663</span> * a1[<span class="number">12</span>] != <span class="number">386348487</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8944053</span> * a1[<span class="number">13</span>] != <span class="number">438258597</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5198490</span> * a1[<span class="number">14</span>] != <span class="number">249527520</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4544518</span> * a1[<span class="number">15</span>] != <span class="number">445362764</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3645600</span> * a1[<span class="number">17</span>] != <span class="number">174988800</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">10115280</span> * a1[<span class="number">16</span>] != <span class="number">981182160</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">9667504</span> * a1[<span class="number">18</span>] != <span class="number">493042704</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5364450</span> * a1[<span class="number">19</span>] != <span class="number">257493600</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">13464540</span> * a1[<span class="number">20</span>] != <span class="number">767478780</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5488432</span> * a1[<span class="number">21</span>] != <span class="number">312840624</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">14479500</span> * a1[<span class="number">22</span>] != <span class="number">1404511500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6451830</span> * a1[<span class="number">23</span>] != <span class="number">316139670</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6252576</span> * a1[<span class="number">24</span>] != <span class="number">619005024</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7763364</span> * a1[<span class="number">25</span>] != <span class="number">372641472</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7327320</span> * a1[<span class="number">26</span>] != <span class="number">373693320</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8741520</span> * a1[<span class="number">27</span>] != <span class="number">498266640</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8871876</span> * a1[<span class="number">28</span>] != <span class="number">452465676</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4086720</span> * a1[<span class="number">29</span>] != <span class="number">208422720</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">9374400</span> * a1[<span class="number">30</span>] == <span class="number">515592000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5759124</span> * a1[<span class="number">31</span>] == <span class="number">719890500</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输入的每一位乘上一个数字之后是另一个数字用来检验，那么除回去就行了，记得取整除</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">a0 = <span class="number">166163712</span> // <span class="number">1629056</span></span><br><span class="line">a1 = <span class="number">731332800</span> // <span class="number">6771600</span></span><br><span class="line">a2 = <span class="number">357245568</span> // <span class="number">3682944</span></span><br><span class="line">a3= <span class="number">1074393000</span> // <span class="number">10431000</span></span><br><span class="line">a4= <span class="number">489211344</span> // <span class="number">3977328</span></span><br><span class="line">a5 = <span class="number">518971936</span> // <span class="number">5138336</span></span><br><span class="line">a6=<span class="string">&#x27;_&#x27;</span></span><br><span class="line">a7= <span class="number">406741500</span> // <span class="number">7532250</span></span><br><span class="line">a8= <span class="number">294236496</span> // <span class="number">5551632</span></span><br><span class="line">a9= <span class="number">177305856</span> // <span class="number">3409728</span></span><br><span class="line">a10= <span class="number">650683500</span> // <span class="number">13013670</span></span><br><span class="line">a11= <span class="number">298351053</span> // <span class="number">6088797</span></span><br><span class="line">a12= <span class="number">386348487</span> // <span class="number">7884663</span></span><br><span class="line">a13= <span class="number">438258597</span> // <span class="number">8944053</span></span><br><span class="line">a14= <span class="number">249527520</span> // <span class="number">5198490</span></span><br><span class="line">a15= <span class="number">445362764</span> // <span class="number">4544518</span></span><br><span class="line">a16= <span class="number">981182160</span> //<span class="number">10115280</span></span><br><span class="line">a17= <span class="number">174988800</span> // <span class="number">3645600</span></span><br><span class="line">a18= <span class="number">493042704</span> // <span class="number">9667504</span></span><br><span class="line">a19= <span class="number">257493600</span> // <span class="number">5364450</span></span><br><span class="line">a20= <span class="number">767478780</span> // <span class="number">13464540</span></span><br><span class="line">a21= <span class="number">312840624</span> // <span class="number">5488432</span></span><br><span class="line">a22= <span class="number">1404511500</span> // <span class="number">14479500</span></span><br><span class="line">a23= <span class="number">316139670</span> // <span class="number">6451830</span></span><br><span class="line">a24= <span class="number">619005024</span> // <span class="number">6252576</span></span><br><span class="line">a25= <span class="number">372641472</span> // <span class="number">7763364</span></span><br><span class="line">a26= <span class="number">373693320</span> // <span class="number">7327320</span></span><br><span class="line">a27= <span class="number">498266640</span> // <span class="number">8741520</span></span><br><span class="line">a28= <span class="number">452465676</span> // <span class="number">8871876</span></span><br><span class="line">a29= <span class="number">208422720</span> // <span class="number">4086720</span></span><br><span class="line">a30= <span class="number">515592000</span> // <span class="number">9374400</span></span><br><span class="line">a31= <span class="number">719890500</span> // <span class="number">5759124</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">chr</span>(a0),<span class="built_in">chr</span>(a1),<span class="built_in">chr</span>(a2),<span class="built_in">chr</span>(a3),<span class="built_in">chr</span>(a4),<span class="built_in">chr</span>(a5),a6,<span class="built_in">chr</span>(a7),<span class="built_in">chr</span>(a8),<span class="built_in">chr</span>(a9),<span class="built_in">chr</span>(a10),<span class="built_in">chr</span>(a11),<span class="built_in">chr</span>(a12),<span class="built_in">chr</span>(a13),<span class="built_in">chr</span>(a14),<span class="built_in">chr</span>(a15),<span class="built_in">chr</span>(a16),<span class="built_in">chr</span>(a17),<span class="built_in">chr</span>(a18),<span class="built_in">chr</span>(a19),<span class="built_in">chr</span>(a20),<span class="built_in">chr</span>(a21),<span class="built_in">chr</span>(a22),<span class="built_in">chr</span>(a23),<span class="built_in">chr</span>(a24),<span class="built_in">chr</span>(a25),<span class="built_in">chr</span>(a26),<span class="built_in">chr</span>(a27),<span class="built_in">chr</span>(a28),<span class="built_in">chr</span>(a29),<span class="built_in">chr</span>(a30),<span class="built_in">chr</span>(a31))</span><br></pre></td></tr></table></figure><p>flag{e_65421110ba03099a1c039337}<br>少了第6位，爆破得到1<br>flag是flag{e165421110ba03099a1c039337}</p><h2 id="SUCTF2019-SignIn"><a href="#SUCTF2019-SignIn" class="headerlink" title="[SUCTF2019]SignIn"></a>[SUCTF2019]SignIn</h2><p><img src="https://img-blog.csdnimg.cn/20210603092003666.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这题以前做过，elf文件，ida64打开<br><img src="https://img-blog.csdnimg.cn/20210603092445239.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>程序调用了 <code>__gmpz_init_set_str</code> 函数，这是一个 GNU 高精度算法库，在RSA加密中见过几次，看下格式确定了这是RSA加密</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mpz_init_set_str</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">char</span> *str, <span class="keyword">int</span> base)</span></span></span><br><span class="line">mpz_t rop:多精度整数变量</span><br><span class="line"><span class="keyword">char</span> *str: 字符串</span><br><span class="line"><span class="keyword">int</span> base: 进制</span><br><span class="line">将str按照base进制转换为rop</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">void mpz_powm (mpz_t rop, const mpz_t base, const mpz_t exp, const mpz_t mod) [Function]</span><br><span class="line">函数功能： rop = base^<span class="built_in">exp</span>取余mod</span><br></pre></td></tr></table></figure><p>从题目中得到数据</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span><br><span class="line">N(十进制)：<span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">E：<span class="number">65537</span></span><br></pre></td></tr></table></figure><p>分解N得到p,q，分解教程参考<a href="https://www.mrskye.cn/archives/18/">这个</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">q = <span class="number">282164587459512124844245113950593348271</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line">n = p * q</span><br><span class="line">d = gmpy2.invert(e, (p-<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line">m = gmpy2.powmod(c, d, n)</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]).decode(encoding=<span class="string">&quot;utf-8&quot;</span>))</span><br></pre></td></tr></table></figure><p>suctf{Pwn_@_hundred_years}</p><p>flag是：flag{Pwn_@_hundred_years}</p><h2 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h2><p>apk逆向，打开jeb，通过字符串找到关键函数<br><img src="https://img-blog.csdnimg.cn/20210603094712547.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210603094953889.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最下面有一个函数，跟进去查看<img src="https://img-blog.csdnimg.cn/20210603095104406.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210603095527164.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提示了邮箱，这里有new了新的邮箱，点击MAILUSER那一行跟进去查看<br><img src="https://img-blog.csdnimg.cn/20210603095620911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以看到MAILSERVER，这是是加载外部so文件中NativeMethod.m()函数所返回的值，再进行base64解密。因此我们只需要找到so文件中经过base64加密的字符串。<br><img src="https://img-blog.csdnimg.cn/20210603095856354.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>导出，使用ida打开，通过字符串搜索找到类似base64加密后的字符串<br>有3个都解一下发现第二个是个邮箱地址<br><img src="https://img-blog.csdnimg.cn/20210603100351989.png" alt="在这里插入图片描述"><br>flag是：flag{18218465125@163.com}</p><h2 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h2><p><img src="https://img-blog.csdnimg.cn/20210603110711799.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>找到main函数<br><img src="https://img-blog.csdnimg.cn/2021060311142982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>12 和 26 行的sub_403CF8是输出函数，21 - 25 行的while()是字符串比较的过程，<br>输入 flag 加密验证正确性的模型<br>看19行的函数<code>sub_401080</code><br><img src="https://img-blog.csdnimg.cn/20210603111827795.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>先执行了<code>sub_401000</code>，这是一个改变密钥对应表的函数，后面是base64加密算法，最后还有一个函数<code>sub_401030</code>，这是交换大小写字母的。</p><p>看函数<code>sub_401000</code><br><img src="https://img-blog.csdnimg.cn/20210603112613651.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将两个数组里的数据进行了交换，根据地址两个数组连在一起，也可以当成一个数组看，从下标为6开始到下标为15，往后偏移了10（0xA）位，也就是QRSTUVWXY和GHIJKLMNOP相互交换了一下<br>新的密码表是<code>ABCDEFQRSTUVWXYGHIJKLMNOPZabcdefghijklmnopqrstuvwxyz0123456789+/</code></p><p>逆向推导：<br>首先要对<code>byte_40E0E4</code>数组进行大小写转换；然后是还原经 base64（更改密钥表后）加密字符的原含义；最后得到了真实的加密字符串</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>; <span class="built_in">dict</span> = &#123;&#125;; offset = <span class="number">10</span></span><br><span class="line">orgin = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(orgin)):</span><br><span class="line">    <span class="built_in">dict</span>[orgin[i]] = orgin[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>, <span class="number">15</span>): <span class="comment">#sub_401000()</span></span><br><span class="line">    <span class="built_in">dict</span>[orgin[i]] , <span class="built_in">dict</span>[orgin[i+offset]] = <span class="built_in">dict</span>[orgin[i+offset]] , <span class="built_in">dict</span>[orgin[i]] <span class="comment"># 恢复base64密钥表</span></span><br><span class="line">secret = <span class="string">&#x27;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&#x27;</span>.swapcase() <span class="comment">#sub_401030()</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret)):</span><br><span class="line">    flag += <span class="built_in">dict</span>[secret[i]] </span><br><span class="line">flag = base64.b64decode(flag)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210603113236509.png" alt="在这里插入图片描述"><br>flag是：flag{bAse64_h2s_a_Surprise}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>2019红帽杯easyRE-ACTF新生赛2020rome-[FlareOn4]login-Youngterdrive</title>
    <link href="http://example.com/2021/06/03/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020rome-[FlareOn4]login-Youngterdrive/"/>
    <id>http://example.com/2021/06/03/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020rome-[FlareOn4]login-Youngterdrive/</id>
    <published>2021-06-02T17:26:51.770Z</published>
    <updated>2021-06-02T17:29:34.155Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>@<a href="BUUCTF">TOC</a></p><h2 id="2019红帽杯-easyRE"><a href="#2019红帽杯-easyRE" class="headerlink" title="[2019红帽杯]easyRE"></a>[2019红帽杯]easyRE</h2><p><img src="https://img-blog.csdnimg.cn/20210602153821792.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>elf文件，ida64打开，感兴趣的同学也可以开Linux系统看一看文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"> v56 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v14 = <span class="number">73</span>;</span><br><span class="line">  v15 = <span class="number">111</span>;</span><br><span class="line">  v16 = <span class="number">100</span>;</span><br><span class="line">  v17 = <span class="number">108</span>;</span><br><span class="line">  v18 = <span class="number">62</span>;</span><br><span class="line">  v19 = <span class="number">81</span>;</span><br><span class="line">  v20 = <span class="number">110</span>;</span><br><span class="line">  v21 = <span class="number">98</span>;</span><br><span class="line">  v22 = <span class="number">40</span>;</span><br><span class="line">  v23 = <span class="number">111</span>;</span><br><span class="line">  v24 = <span class="number">99</span>;</span><br><span class="line">  v25 = <span class="number">121</span>;</span><br><span class="line">  v26 = <span class="number">127</span>;</span><br><span class="line">  v27 = <span class="number">121</span>;</span><br><span class="line">  v28 = <span class="number">46</span>;</span><br><span class="line">  v29 = <span class="number">105</span>;</span><br><span class="line">  v30 = <span class="number">127</span>;</span><br><span class="line">  v31 = <span class="number">100</span>;</span><br><span class="line">  v32 = <span class="number">96</span>;</span><br><span class="line">  v33 = <span class="number">51</span>;</span><br><span class="line">  v34 = <span class="number">119</span>;</span><br><span class="line">  v35 = <span class="number">125</span>;</span><br><span class="line">  v36 = <span class="number">119</span>;</span><br><span class="line">  v37 = <span class="number">101</span>;</span><br><span class="line">  v38 = <span class="number">107</span>;</span><br><span class="line">  v39 = <span class="number">57</span>;</span><br><span class="line">  v40 = <span class="number">123</span>;</span><br><span class="line">  v41 = <span class="number">105</span>;</span><br><span class="line">  v42 = <span class="number">121</span>;</span><br><span class="line">  v43 = <span class="number">61</span>;</span><br><span class="line">  v44 = <span class="number">126</span>;</span><br><span class="line">  v45 = <span class="number">121</span>;</span><br><span class="line">  v46 = <span class="number">76</span>;</span><br><span class="line">  v47 = <span class="number">64</span>;</span><br><span class="line">  v48 = <span class="number">69</span>;</span><br><span class="line">  v49 = <span class="number">67</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v50, <span class="number">0</span>, <span class="keyword">sizeof</span>(v50));</span><br><span class="line">  v51 = <span class="number">0</span>;</span><br><span class="line">  v52 = <span class="number">0</span>;</span><br><span class="line">  v0 = v50;</span><br><span class="line">  sub_4406E0(<span class="number">0LL</span>, v50, <span class="number">37LL</span>);</span><br><span class="line">  v52 = <span class="number">0</span>;</span><br><span class="line">  v1 = v50;</span><br><span class="line">  <span class="keyword">if</span> ( sub_424BA0(v50) == <span class="number">36</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = v50;</span><br><span class="line">      <span class="keyword">if</span> ( i &gt;= (<span class="keyword">unsigned</span> __int64)sub_424BA0(v50) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)(v50[i] ^ i) != *(&amp;v14 + i) )</span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="number">4294967294LL</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_410CC0((__int64)<span class="string">&quot;continue!&quot;</span>);           <span class="comment">// 第一部分处理</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;v53, <span class="number">0</span>, <span class="number">0x40</span>uLL);</span><br><span class="line">    v55 = <span class="number">0</span>;</span><br><span class="line">    v0 = &amp;v53;</span><br><span class="line">    sub_4406E0(<span class="number">0LL</span>, &amp;v53, <span class="number">64LL</span>);</span><br><span class="line">    v54 = <span class="number">0</span>;</span><br><span class="line">    v1 = &amp;v53;</span><br><span class="line">    <span class="keyword">if</span> ( sub_424BA0(&amp;v53) == <span class="number">39</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = sub_400E44((__int64)&amp;v53);           <span class="comment">// 十次base64处理</span></span><br><span class="line">      v4 = sub_400E44(v3);</span><br><span class="line">      v5 = sub_400E44(v4);</span><br><span class="line">      v6 = sub_400E44(v5);</span><br><span class="line">      v7 = sub_400E44(v6);</span><br><span class="line">      v8 = sub_400E44(v7);</span><br><span class="line">      v9 = sub_400E44(v8);</span><br><span class="line">      v10 = sub_400E44(v9);</span><br><span class="line">      v11 = sub_400E44(v10);</span><br><span class="line">      v12 = sub_400E44(v11);</span><br><span class="line">      v0 = off_6CC090;</span><br><span class="line">      v1 = (<span class="keyword">char</span> *)v12;</span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_400360(v12, off_6CC090) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_410CC0((__int64)<span class="string">&quot;You found me!!!&quot;</span>);</span><br><span class="line">        v1 = <span class="string">&quot;bye bye~&quot;</span>;</span><br><span class="line">        sub_410CC0((__int64)<span class="string">&quot;bye bye~&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      result = <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">4294967293LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) != v56 )</span><br><span class="line">    sub_444020(v1, v0);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第一部分的处理是个异或，第二部分打开函数之后发现是base64的运算（10次），而且得到的结果与off_6cc090比较<br>先解出第一部分</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = [<span class="number">73</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">108</span>,<span class="number">62</span>,<span class="number">81</span>,<span class="number">110</span>,<span class="number">98</span>,<span class="number">40</span>,<span class="number">111</span>,<span class="number">99</span>,<span class="number">121</span>,<span class="number">127</span>,<span class="number">121</span>,<span class="number">46</span>,<span class="number">105</span>,<span class="number">127</span>,<span class="number">100</span>,<span class="number">96</span>,<span class="number">51</span>,<span class="number">119</span>,<span class="number">125</span>,<span class="number">119</span>,<span class="number">101</span>,<span class="number">107</span>,<span class="number">57</span>,<span class="number">123</span>,<span class="number">105</span>,<span class="number">121</span>,<span class="number">61</span>,<span class="number">126</span>,<span class="number">121</span>,<span class="number">76</span>,<span class="number">64</span>,<span class="number">69</span>,<span class="number">67</span>]</span><br><span class="line">input1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">str</span>)):</span><br><span class="line">   input1 += <span class="built_in">chr</span>(<span class="built_in">str</span>[i]^i)</span><br><span class="line">print(input1)</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210602235638257.png" alt="在这里插入图片描述"><br>第二部分用在线工具解十次base64，解出来发现是个网站<br><a href="https://bbs.pediy.com/thread-254172.htm">https://bbs.pediy.com/thread-254172.htm</a><br>打开发现没有用，是个干扰项<br>看了其他师傅的wp后才知道，在我们base64加密结束后，下面有调用一个sub_400D35的函数<br><img src="https://img-blog.csdnimg.cn/20210603011038491.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>过去看看<br><img src="https://img-blog.csdnimg.cn/202106030112157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>24行判断第一个和第四个是不是f和g，那就猜测这四个字符是flag。</p><p>然后循环24次做异或操作。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">num2=[<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line">text2=<span class="string">&#x27;flag&#x27;</span></span><br><span class="line">key=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">    key=key+<span class="built_in">chr</span>(<span class="built_in">ord</span>(text2[i])^num2[i])</span><br><span class="line"><span class="built_in">print</span>（key）</span><br></pre></td></tr></table></figure><p>得到v5 == &amp;YA1<br>在求出v2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">num2=[<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line">key=<span class="string">&#x27;&amp;YA1&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):</span><br><span class="line">    flag=flag+<span class="built_in">chr</span>(num2[i]^<span class="built_in">ord</span>(key[i%<span class="number">4</span>]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>flag是：flag{Act1ve_Defen5e_Test}</p><h2 id="ACTF新生赛2020-rome"><a href="#ACTF新生赛2020-rome" class="headerlink" title="[ACTF新生赛2020]rome"></a>[ACTF新生赛2020]rome</h2><p><img src="https://img-blog.csdnimg.cn/20210601200743438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida 32 ，通过main函数或者字符串搜索都可以找到函数<code>func()</code><br>发现其实就是将输入的字符串大写和小写分开进行变换，然后比较输出<br><img src="https://img-blog.csdnimg.cn/20210601202029949.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>写一个脚本跑一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">v15= [<span class="number">81</span>,<span class="number">115</span>,<span class="number">119</span>,<span class="number">51</span>,<span class="number">115</span>,<span class="number">106</span>,<span class="number">95</span>,<span class="number">108</span>,<span class="number">122</span>,<span class="number">52</span>,<span class="number">95</span>,<span class="number">85</span>,<span class="number">106</span>,<span class="number">119</span>,<span class="number">64</span>,<span class="number">108</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        x=j</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(x).isupper():</span><br><span class="line">            x=(x-<span class="number">51</span>)%<span class="number">26</span>+<span class="number">65</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(x).islower():</span><br><span class="line">            x=(x-<span class="number">79</span>)%<span class="number">26</span>+<span class="number">97</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(x)==<span class="built_in">chr</span>(v15[i]):</span><br><span class="line">            flag+=<span class="built_in">chr</span>(j)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;flag&#123;&#x27;</span>+flag+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>flag{Cae3ar_th4_Gre@t}</p><h2 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="[FlareOn4]login"></a>[FlareOn4]login</h2><p>网页打开，F12查看HTML源码<br><img src="https://img-blog.csdnimg.cn/20210601203029493.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><code>var rotFlag = flag.replace(/[a-zA-Z]/g, function(c)&#123;return String.fromCharCode((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13) ? c : c - 26);&#125;);</code>这句代码的意思就是将字符后移13位，越界了就转回字母开头，最后得到了字符串<code>PyvragFvqrYbtvafNerRnfl@syner-ba.pbz</code><br>其实就是ROT13，找一个在线网站解一下，得到：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ClientSideLoginsAreEasy@flare-on.com</span><br></pre></td></tr></table></figure><p>flag是：flag{ClientSideLoginsAreEasy@flare-on.com}</p><h2 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h2><p><img src="https://img-blog.csdnimg.cn/20210601204809958.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>kali脱壳<br><img src="https://img-blog.csdnimg.cn/2021060121331293.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210601213425335.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida打开，找到主函数<br><img src="https://img-blog.csdnimg.cn/20210602111549876.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>大致是这样，我们依次看一下<br>函数<code>sub_4110FF()</code><br><img src="https://img-blog.csdnimg.cn/2021060211165982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>输出部分：函数<code>sub_411190()</code><br><img src="https://img-blog.csdnimg.cn/20210602112248690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后着重看一下两个线程的处理<br>线程1：<code>StartAddress</code><br><img src="https://img-blog.csdnimg.cn/20210602111914328.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看函数<code>sub_41112C</code>，函数<code>sub_411940</code><br>这里会出现报错，函数<code>sub_411940</code>无法反编译<br><img src="https://img-blog.csdnimg.cn/20210602151817781.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>是由于堆栈不平衡的问题，一般是程序有一些干扰代码，让IDA的反汇编分析出现错误。比如用push + n条指令 + retn来跳转。搜索这个函数，看汇编窗口：<br><img src="https://img-blog.csdnimg.cn/202106021518528.png" alt="在这里插入图片描述"><br>Option-&gt;General-&gt;Disassembly, 将选项Stack pointer打钩<br><img src="https://img-blog.csdnimg.cn/2021060211304858.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后就可以看见汇编窗口汇编指令前面有绿色的SP值<br><img src="https://img-blog.csdnimg.cn/20210602151920853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>找到这串函数的retn指令<br><img src="https://img-blog.csdnimg.cn/20210602151934509.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以发现前面的SP值变成了负数，我们需要修改它成0使得堆栈保持平衡。<br>找到距离retn最近的call指令<br><img src="https://img-blog.csdnimg.cn/20210602152051279.png" alt="在这里插入图片描述"><br>alt+k修改SP值<br><img src="https://img-blog.csdnimg.cn/20210602152114111.png" alt="在这里插入图片描述"><br>修改之后<br><img src="https://img-blog.csdnimg.cn/20210602152139797.png" alt="在这里插入图片描述"><br>然后就可以可以查看<br><img src="https://img-blog.csdnimg.cn/20210602112142582.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>线程2：函数<code>sub_41119F()</code><br><img src="https://img-blog.csdnimg.cn/20210602144619341.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>线程2并不对代码做任何处理，只是调用一次Sleep然后释放线程。</p><p>这里说一个细节，这道题是线程1和线程2 交替执行的，因为函数<code>CreateMutex()</code><br><img src="https://img-blog.csdnimg.cn/20210602145638478.png" alt="在这里插入图片描述"><br>这个函数是创建两个相互排斥的线程的函数，hobject 可以理解为一个“锁”，两个线程依次获取锁(waitforsingleobject)，释放锁(releasemutex)。一个线程开始之后，抢占了锁，这时候另一个线程没抢到，处于等待状态，等待运行线程执行完成之后第一个线程解锁。<br>不能用来控制两个以上的线程，因为剩下的几个线程都有几率抢到，会导致程序逻辑混乱。<br>两个线程时候，第一次抢到锁的线程在释放后也会和第二个线程抢锁，但是由于它此时没有第二个线程快，所以抢不到，就造成了两个线程交替被调用的现状。</p><p>所以这题就是奇数的会被线程1处理而偶数走线程2 不处理（因为是从29往下减的）</p><p>写脚本</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> off1[] = <span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> off2[] = <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">30</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">28</span>;i&gt;<span class="number">-1</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            flag[i] = off1[i];</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">52</span>;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(off1[i] == off2[j])</span><br><span class="line">            &#123;</span><br><span class="line">                flag[i] = j+<span class="number">38</span>;</span><br><span class="line">                <span class="keyword">if</span>(!(flag[i]&gt;=<span class="number">65</span> &amp;&amp;flag[i]&lt;=<span class="number">90</span>))</span><br><span class="line">                    flag[i] = j+<span class="number">96</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210602151002491.png" alt="在这里插入图片描述"><br>这里还有一个问题，就是最后输出flag的函数，它显示的是比较i&lt;29<br>而实际上进程处理的时候是到&gt;-1的，也就是其实应该是30个字符<br>也就是说少了一位我们不知道，需要一个个英文字母试出来，发现是“E”</p><p>flag：flag{ThisisthreadofwindowshahaIsESE}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
</feed>
