<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Nor-ming</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-07-24T14:19:46.100Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Alien Wan（924704640@qq.com)</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HDCTF2019Maze-[FlareOn4]IgniteMe-[MRCTF2020]Xor-[MRCTF2020]hello_world_go</title>
    <link href="http://example.com/2021/07/24/HDCTF2019Maze-[FlareOn4]IgniteMe-[MRCTF2020]Xor-[MRCTF2020]hello_world_go/"/>
    <id>http://example.com/2021/07/24/HDCTF2019Maze-[FlareOn4]IgniteMe-[MRCTF2020]Xor-[MRCTF2020]hello_world_go/</id>
    <published>2021-07-24T14:17:13.104Z</published>
    <updated>2021-07-24T14:19:46.100Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="HDCTF2019-Maze"><a href="#HDCTF2019-Maze" class="headerlink" title="[HDCTF2019]Maze"></a>[HDCTF2019]Maze</h3><p>查壳，存在UPX壳<br><img src="https://img-blog.csdnimg.cn/5479c387ab634da5aedc2576e401adaa.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>kali脱壳，一开始不知道为什么脱不掉，后来重命名了个简短的名字就可以<br><img src="https://img-blog.csdnimg.cn/4ade3ed9d553446382c5face51d9aa45.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida打开，打开之后看到这里有一个花指令<br><img src="https://img-blog.csdnimg.cn/f1e012e538fe4ac0a25d05015c38902c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>关于花指令：<br>花指令是，由设计者特别构思，希望使反汇编的时候出错，让破解者无法清楚正确地反汇编程序的内容，迷失方向。经典的是，目标位置是另一条指令的中间，这样在反汇编的时候便会出现混乱。花指令有可能利用各种指令：jmp, call, ret的一些堆栈技巧，位置运算，等等。</p><p>打开OD，根据ida找到出现花指令位置的地址<br><img src="https://img-blog.csdnimg.cn/bce09d837ac642b0a111d6849e9b5553.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>NOP掉跳转<br>然后保存修改后的程序<br><img src="https://img-blog.csdnimg.cn/32083a8e9c9347179f9b07fcc420c22f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/0ebdbda22e7a40eb8c6b8812d9c95847.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/a6e016de6ebe4e47a631fffc7e971c67.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将保存过后的程序拖进IDA看看<br>字符串中有这样一串*号<br><img src="https://img-blog.csdnimg.cn/4e1d549134a84406ad2dc8e785828c1c.png" alt="在这里插入图片描述"><br>又通过下面的flag提示找到关键函数，可以知道这是一个迷宫题<br><img src="https://img-blog.csdnimg.cn/27ee1b23f6fb451a8e83caf114cd3b17.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>控制的有两个数据，一个是dword_408078，另一个是dword_40807C<br>双击进去查看初始数据。<br>初始状态：<br>dword_408078=7<br>dword_40807C=0<br>经过14次移动需要使<br>dword_408078=5<br>dword_40807C=-4<br>绘制迷宫</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*******+**</span><br><span class="line">******* **</span><br><span class="line">****    **</span><br><span class="line">**   *****</span><br><span class="line">** **F****</span><br><span class="line">**    ****</span><br><span class="line">**********</span><br></pre></td></tr></table></figure><p>行走路径为ssaaasaassdddw<br>flag是：flag{ssaaasaassdddw}</p><h3 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h3><p><img src="https://img-blog.csdnimg.cn/6e45e0230b174c408c52988b5ee45225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/ac31b6456ab042078ff990b5ecd5cb5c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看函数 <code>sub_401050()</code><br><img src="https://img-blog.csdnimg.cn/4041f5cb3f3b456789f8f0902e6045db.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>v0是输入，v4是一个处理函数，然后经过循环的异或脚本，最后和<code>byte_403000</code>比较<br>byte_403000:<br><img src="https://img-blog.csdnimg.cn/65897972b2f5499eb7bd0b55f690eccc.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看一下对v4的处理<br><img src="https://img-blog.csdnimg.cn/ee454f18a8274cfe9f0e9b6dc3fd4f30.png" alt="在这里插入图片描述"><br>不明白，动态调试一下<br><img src="https://img-blog.csdnimg.cn/38eccdfd72de4f38a89deee90abad3ad.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="请添加图片描述"><br>可以看到v4=0x4<br>编写脚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">arr2 = [<span class="number">0x0D</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x2A</span>,<span class="number">0x17</span>,<span class="number">0x78</span>,<span class="number">0x44</span>,<span class="number">0x2B</span>,<span class="number">0x6C</span>,<span class="number">0x5D</span>,<span class="number">0x5E</span>,<span class="number">0x45</span>,<span class="number">0x12</span>,<span class="number">0x2F</span>,<span class="number">0x17</span>,</span><br><span class="line"><span class="number">0x2B</span>,<span class="number">0x44</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x56</span>,<span class="number">0x09</span>,<span class="number">0x5F</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x13</span>,<span class="number">0x17</span>,<span class="number">0x48</span>,</span><br><span class="line"><span class="number">0x42</span>,<span class="number">0x01</span>,<span class="number">0x40</span>,<span class="number">0x4D</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x69</span>]</span><br><span class="line"></span><br><span class="line">arr1 = []</span><br><span class="line">v4 = <span class="number">4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arr2)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    arr1.append(arr2[i] ^ v4)</span><br><span class="line">    v4 = arr1[-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> arr1[::-<span class="number">1</span>]])+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>flag是：flag{R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com}</p><h3 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h3><p><img src="https://img-blog.csdnimg.cn/f4c8c02faf6b48d4be03d1c8a046489a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>通过字符串跳转<br><img src="https://img-blog.csdnimg.cn/dbb10f7641ce41ed9242b02bcef90f1a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>交叉引用，按F5发现无法分析call<br><img src="https://img-blog.csdnimg.cn/a393916abdbd40978913967aeb82597d.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看401095处<br><img src="https://img-blog.csdnimg.cn/2af32d28997b491b8db5e6b6846ebfd7.png" alt="在这里插入图片描述"><br>调用了函数<code>sub_401020</code></p><p>双击函数F5查看，发现它有多个参数<br><img src="https://img-blog.csdnimg.cn/5b684d1c849e4994824435b06db67d05.png" alt="在这里插入图片描述"></p><p>我们返回401095处，看这一行上面的push命令<br><img src="https://img-blog.csdnimg.cn/d4531af40cee444f9d78cf5cdd26847a.png" alt="在这里插入图片描述"><br>只有一个push，是一个字符串的地址，32位，所以只有一个参数<br>回到<code>sub_401020</code>，点击函数名按y键，将参数修改为一个<br><img src="https://img-blog.csdnimg.cn/9d691134877c4f668357f4bca349ad13.png" alt="在这里插入图片描述"><br>现在401095处可以F5了<br><img src="https://img-blog.csdnimg.cn/6dea3808b029443486cbbea514693c18.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>19行可知v0和byte_4212c0进行异或，得到byte_41EA08<br>byte_41EA08函数查看内容<br><img src="https://img-blog.csdnimg.cn/5941d4deac9b4d83bfa720d54819f544.png" alt="在这里插入图片描述"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;MSAWB~FXZ:J:`tQJ\&quot;N@ bpdd&#125;8g&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(i ^<span class="built_in">ord</span>(a[i]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>MRCTF{@_R3@1ly_E2_R3verse!}<br>flag是：flag{@_R3@1ly_E2_R3verse!}</p><h3 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h3><p>64位ida打开<br><img src="https://img-blog.csdnimg.cn/1606ab4050bc4a0fb74ac6324ae921d1.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>搜索main函数，打开main_main<br>go语言写的，看别的师傅都是直接搜到的，我也不知道为什么师傅们知道搜就可以emmm<br>总之标黄的地方<br><img src="https://img-blog.csdnimg.cn/69ca3c541f4f422c8faf080d30966e7c.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/987d1cc3b023415cb2a8d9ae136a7877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：flag{hello_world_gogogo}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(4)</title>
    <link href="http://example.com/2021/07/23/buuctf-misc%E7%BB%83%E4%B9%A0(4)/"/>
    <id>http://example.com/2021/07/23/buuctf-misc%E7%BB%83%E4%B9%A0(4)/</id>
    <published>2021-07-23T07:06:08.782Z</published>
    <updated>2021-07-23T07:11:50.729Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h3><p>爆破出密码<br><img src="https://img-blog.csdnimg.cn/a9a7b96d8608431481a3907be068f21a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>打开，使用<a href="https://tool.bugku.com/brainfuck/?wafcloud=1">此网站</a>解密<br>flag是：flag{e4bbef8bdf9743f8bf5b727a9f6332a8}</p><h3 id="后门查杀"><a href="#后门查杀" class="headerlink" title="后门查杀"></a>后门查杀</h3><p>下载下来的文件解压之后使用D盾扫描<br><img src="https://img-blog.csdnimg.cn/4d7f5963a44b400ea5a02427b870e8b0.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将标红的文件打开，因为提示给了md5，所以搜索md5<br><img src="https://img-blog.csdnimg.cn/ca0e40e2f9ef4a889ebd9fbdadcbc254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>关于md5的都是<code>$k</code>或者<code>$pass</code><br>搜索这两个<br><img src="https://img-blog.csdnimg.cn/b05efef5bc2b491585367ad1a87cdc6e.png" alt="在这里插入图片描述"><br>flag是：flag{6ac45fb83b3bc355c024f5034b947dd3}</p><h3 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h3><p>本题<a href="https://blog.csdn.net/fi0stBlooder/article/details/118398330?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-7.pc_relevant_baidujshouduan&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-7.pc_relevant_baidujshouduan">参考博客</a><br>文件是conf.bin，是宽带数据文件，用RouterPassView打开<br>没有给出flag，猜测是账户名或者是密码<br><img src="https://img-blog.csdnimg.cn/b8884edc6b224cb5b35d0d21cf2ae574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：flag{053700357621}</p><h3 id="数据包中的线索"><a href="#数据包中的线索" class="headerlink" title="数据包中的线索"></a>数据包中的线索</h3><p>过滤http，追踪http最后一个包，发现base64编码<br><img src="https://img-blog.csdnimg.cn/30bd119800dd4cb39ac3c7161e8cf1f6.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/c28ec310db754dc2bf8d8f184cdb63c6.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用<a href="https://the-x.cn/base64">此网站</a>解密<br><img src="https://img-blog.csdnimg.cn/828059cdf1904de9916089a07bcc5e76.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag是：flag{209acebf6324a09671abc31c869de72c}</p><h3 id="来首歌吧"><a href="#来首歌吧" class="headerlink" title="来首歌吧"></a>来首歌吧</h3><p><img src="https://img-blog.csdnimg.cn/971d458416974e90bb29010f26428b08.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>摩斯密码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..... -... -.-. ----. ..--- ..... -.... ....- ----. -.-. -... ----- .---- ---.. ---.. ..-. ..... ..--- . -.... .---- --... -.. --... ----- ----. ..--- ----. .---- ----. .---- -.-.</span><br></pre></td></tr></table></figure><p>5BC925649CB0188F52E617D70929191C</p><p>flag是：flag{5BC925649CB0188F52E617D70929191C}</p><h3 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h3><p>使用binwalk分离文件，得到一个压缩包和一个文件夹，文件夹里面有一个有密码的压缩包和一张图片<br><img src="https://img-blog.csdnimg.cn/f1dfd8ecc85f4fbab15f9f5bc10a773b.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/3b29cb36479a40939b53a2e5844b25cf.png" alt="在这里插入图片描述"><br>使用steghide分析这张图片发现隐藏信息<br>steghide的安装：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install steghide</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/facc34da99104e75b54fd280364b4118.png" alt="在这里插入图片描述"><br>打开ko.txt，得到密码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bV1g6t5wZDJif^J7</span><br></pre></td></tr></table></figure><p>输入即可解压缩，得到flag<br>flag是：flag{1RTo8w@&amp;4nK@z*XL}</p><h3 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h3><p>使用binwalk分离图片，得到虚拟机磁盘文件<br><img src="https://img-blog.csdnimg.cn/2ba51ee2bfb64f3886b7481c8493568f.png" alt="在这里插入图片描述"><br>用以下命令解压</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>z x flag.vmdk -o./</span><br></pre></td></tr></table></figure><p>得到四个文件夹，打开这两个文件夹<br><img src="https://img-blog.csdnimg.cn/28ac4aeb1a24471f8643d1ebc29b0bd1.png" alt="在这里插入图片描述"><br>里面的内容用<a href="https://tool.bugku.com/brainfuck/?wafcloud=1">这个网站</a>解密<br>flag是：flag{N7F5_AD5_i5_funny!}</p><h3 id="webshell后门"><a href="#webshell后门" class="headerlink" title="webshell后门"></a>webshell后门</h3><p>D盾扫一下，打开那个多功能大木马，搜索pass<br>flag是：flag{ba8e6c6f35a53933b871480bb9a9545c}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(3)</title>
    <link href="http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(3)/"/>
    <id>http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(3)/</id>
    <published>2021-07-22T15:04:13.249Z</published>
    <updated>2021-07-22T15:06:51.459Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="镜子里的世界"><a href="#镜子里的世界" class="headerlink" title="镜子里的世界"></a>镜子里的世界</h3><p>因为是镜子里的世界，所以模糊一些，所以像素低，所以是LSB<br><img src="https://img-blog.csdnimg.cn/img_convert/37d93a7c439d4aa56d91a6120c112144.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-a4MYbgry-1626942462358)(https://csdn-img-blog.oss-cn-beijing.aliyuncs.com/e295f60bb66349cfad19648bc573c8de.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70)]"><br>flag是：flag{st3g0_saurus_wr3cks}</p><h3 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h3><p>binwalk分离出来一个压缩包，爆破密码<br><img src="https://img-blog.csdnimg.cn/img_convert/944c148d9d1252838966cf00d11e9c86.png" alt="在这里插入图片描述"><br>flag是：flag{75a3d68bf071ee188c418ea6cf0bb043}</p><h3 id="爱因斯坦"><a href="#爱因斯坦" class="headerlink" title="爱因斯坦"></a>爱因斯坦</h3><p>Stegsolve扫出来两个文件，binwalk分离，需要密码，爆破不出来，在属性里面发现密码<br><img src="https://img-blog.csdnimg.cn/img_convert/07654442b44c84a5699830065304d7d0.png" alt="在这里插入图片描述"></p><p>flag是：flag{dd22a92bf2cceb6c0cd0d6b83ff51606}</p><h3 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h3><p>打开之后发现都是TCP包，所以直接追踪TCP流量<br><img src="https://img-blog.csdnimg.cn/img_convert/100de17ae40997ba444d0c197f741b68.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/25ab31df68529a5ed39c83f6f41b978a.png" alt="在这里插入图片描述"><br>flag是：flag{385b87afc8671dee07550290d16a8071}</p><h3 id="另外一个世界"><a href="#另外一个世界" class="headerlink" title="另外一个世界"></a>另外一个世界</h3><p>WinHEX打开，最后又一串二进制数字<br><img src="https://img-blog.csdnimg.cn/img_convert/e241c3c9f2647b324139cd5adef98675.png" alt="在这里插入图片描述"><br>八个数字一组转ASCII码<br><img src="https://img-blog.csdnimg.cn/img_convert/d7522752c8b714155870fc2fd190539a.png" alt="在这里插入图片描述"><br>flag是：flag{koekj3s}</p><h3 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h3><p>WinHEX打开，搜索flag<br><img src="https://img-blog.csdnimg.cn/caa42108730043dc8fe9d6647df85c6c.png" alt="在这里插入图片描述"><br>base64解密<br>flag是：flag{377cbadda1eca2f2f73d36277781f00a}</p><h3 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h3><p>LSB，发现为zip文件，将它导出<br><img src="https://img-blog.csdnimg.cn/fb70715b7b034908bbc8fb889dccb2a7.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>导出之后发现zip文件损坏，使用<a href="http://forspeed.onlinedown.net/down/95222_20170619151215.zip">修复软件</a><br><img src="https://img-blog.csdnimg.cn/d8ce27e2996946069a4d986d4152061f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>修复完成，解压，有一个文件，改后缀为.txt<br>搜索flag没有，搜索  {  符号，得到<br><img src="https://img-blog.csdnimg.cn/217af219f4e640ee86f7b920f4743850.png" alt="在这里插入图片描述"><br>flag是：flag{dd0gf4c3tok3yb0ard4g41n~~~}</p><h3 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h3><p>有一串盲文，对照翻译得到kmdonowg<br>用这个来解压压缩包，是一个音频，听一下是摩斯密码的声音，听不清可以使用Audacity来看<br><img src="https://img-blog.csdnimg.cn/e98bc931cf4f44de92691fe7d7dc64fe.png" alt="在这里插入图片描述"><br>这样方便分析<br>得到</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-.-. - ..-. .-- .--. . .. ----- ---.. --... ...-- ..--- ..--.. ..--- ...-- -.. --..</span><br></pre></td></tr></table></figure><p><a href="http://www.metools.info/other/o105.html">网站</a><br><img src="https://img-blog.csdnimg.cn/aa902cd782a14a6c84788df870e998ae.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提交不对，改成小写字母即可<br>flag是：flag{wpei08732?23dz}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(2)</title>
    <link href="http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(2)/"/>
    <id>http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(2)/</id>
    <published>2021-07-22T08:13:01.302Z</published>
    <updated>2021-07-22T08:14:37.696Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>既然是LSB<br>使用Stegsolve<br><img src="https://img-blog.csdnimg.cn/img_convert/452ac2d6adff729f81eb08fcf7c3eb20.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/d2d24741676aee0013ced6a9705d86ce.png" alt="在这里插入图片描述"><br>得到二维码，扫一扫即可<br><img src="https://img-blog.csdnimg.cn/img_convert/c1281bc6749dc1d02fb01926f6fab148.png" alt="在这里插入图片描述"><br>flag是：flag{1sb_i4_s0_Ea4y}</p><h3 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h3><p>右键属性详细信息<br><img src="https://img-blog.csdnimg.cn/img_convert/ea9beb738791736736766cf6de3e34b9.png" alt="在这里插入图片描述"><br>flag是：flag{870c5a72806115cb5439345d8b014396}</p><h3 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h3><p>给了提示是登录登录方法，就直接过滤搜</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.request.method==POST</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/d029384b2b1b2ba0958ddb9dd8374894.png" alt="在这里插入图片描述"><br>flag是：flag{ffb7567a1d4f4abdffdb54e022f8facd}</p><h3 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h3><p>4位数字爆破<br><img src="https://img-blog.csdnimg.cn/img_convert/84b5bbe196b16c4f438f6c40b1940ced.png" alt="在这里插入图片描述"><br>flag是：flag{1773c5da790bd3caff38e3decd180eb7}</p><h3 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/9ddc024cf7ae2b60723dab00477a53fe.png" alt="在这里插入图片描述"><br>flag是：flag{878865ce73370a4ce607d21ca01b5e59}</p><h3 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h3><p>Winhex打开，看到是zip伪加密<br><img src="https://img-blog.csdnimg.cn/img_convert/95cb7ac1a816bde1d5d58eb3e6943062.png" alt="在这里插入图片描述"><br>使用工具ZipCenOp，把它和压缩包放在同一个文件夹里，打开cmd切换到ZipCenOp的文件夹执行：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ZipCenOp.jar r 文件名.zip </span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/d371deda28690f5bff41861e5988bb37.png" alt="在这里插入图片描述"><br>现在可以正常解压了，打开就有flag了<br>flag是：flag{Adm1N-B2G-kU-SZIP}</p><h3 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h3><p>binwalk分离一下，然后爆破密码<br><img src="https://img-blog.csdnimg.cn/img_convert/c64c133715ccdcee565f4fe9c1926687.png" alt="在这里插入图片描述"><br>flag是：flag{b025fc9ca797a67d2103bfbc407a6d5f}</p><h3 id="被嗅探的能量"><a href="#被嗅探的能量" class="headerlink" title="被嗅探的能量"></a>被嗅探的能量</h3><p>因为题目说抓取的文件，所以直接搜索flag就好了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains <span class="string">&quot;flag&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/370250d1eb7c7ad85f0553e26a75fefc.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/img_convert/6724af088214fad026a5fc33a26d7537.png" alt="在这里插入图片描述"><br>flag是：flag{da73d88936010da1eeeb36e945ec4b97}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>buuctf-misc练习(1)</title>
    <link href="http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(1)/"/>
    <id>http://example.com/2021/07/22/buuctf-misc%E7%BB%83%E4%B9%A0(1)/</id>
    <published>2021-07-22T02:27:02.431Z</published>
    <updated>2021-07-22T02:38:13.706Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h3><p>图片隐写，使用Stegsolve<br><img src="https://img-blog.csdnimg.cn/img_convert/9875d9b601f0b2165fb649e1d313b300.png" alt="在这里插入图片描述"><br>左右移动看到<br><img src="https://img-blog.csdnimg.cn/img_convert/7ffa777615512af3e657a9111fe5135c.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/6d5dc630f59fce50b77506aa3fbbc8cb.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/087df19e333f81021885d069394ebc25.png" alt="在这里插入图片描述"><br>flag是：flag{he11ohongke}</p><h3 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h3><p>一张二维码，扫一扫没有flag<br>使用binwalk分离<br><img src="https://img-blog.csdnimg.cn/img_convert/496d8344261f7d2f691dae94881f5bcf.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/3a7106b0067aa71da6c8effeab71adf1.png" alt="在这里插入图片描述"><br>得到的文件里面有一个压缩包<br><img src="https://img-blog.csdnimg.cn/img_convert/13c340dc9feb260213d80bcf06de7146.png" alt="在这里插入图片描述"><br>需要密码，有文件名可知密码是四个数字，可以采用下面显示的软件爆破<br><img src="https://img-blog.csdnimg.cn/img_convert/dbf599981a471e2daa2862221b7bb4ac.png" alt="在这里插入图片描述"><br>输入解压，打开文本文件<br>flag是：flag{vjpw_wnoei}</p><h3 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h3><p>一个exe文件，无法运行，改后缀为txt，打开看到base64提示，全选复制</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/<span class="number">396</span>Tx564G1UouicKg19hwPCDcrMJ9m7/<span class="number">7</span>n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+<span class="number">3</span>pnDp9yF7tneQvvmcZu/<span class="number">2l</span>f78zhU+<span class="number">5</span>i9yxv4T3T2O0/<span class="number">7</span>eud68OT2H3LCft0l/ae9ZlTo+<span class="number">23</span>pPvX7/rwJHbfcsI+<span class="number">3</span>aW9Z33m1Gj7Len+<span class="number">9b</span>s+PIndt5ywT3dp71mfOTXafku6f/<span class="number">2u</span>D09i9y0n7NNd2nvWZ06Ntt+S7l+/<span class="number">68</span>MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/<span class="number">68</span>MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/<span class="number">6</span>cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/<span class="number">31</span>rectP0Wu2/<span class="number">5Lu</span>n+<span class="number">9b</span>s+PMnu/XZvfctJ22+x+<span class="number">5b</span>vku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+<span class="number">5l</span>3+tK935vApyd+<span class="number">8</span>y5/<span class="number">29</span>c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/<span class="number">3</span>VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+<span class="number">4b</span>ds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+<span class="number">4b</span>ds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+<span class="number">5</span>RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+<span class="number">2</span>tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/<span class="number">9</span>tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+<span class="number">5</span>M1G+<span class="number">1</span>o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+<span class="number">0</span>xppM32HpfWTIxPbMzeNtJmS3Zyw/<span class="number">7</span>RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+<span class="number">5</span>SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/<span class="number">8</span>Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI<span class="comment">//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==</span></span><br></pre></td></tr></table></figure><p>使用<a href="http://tool.chinaz.com/tools/imgtobase/">在线工具</a>解密<br>得到一张二维码，使用QR Research解密<br><img src="https://img-blog.csdnimg.cn/img_convert/831a832f668b085bcd76160839c5a6f8.png" alt="在这里插入图片描述"><br>flag是：flag{dca57f966e4e4e31fd5b15417da63269}</p><h3 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h3><p>Winhex打开搜索flag<br><img src="https://img-blog.csdnimg.cn/img_convert/858e196e5ade27b1ba264672a7c80c29.png" alt="在这里插入图片描述"><br>flag是：flag{stego_is_s0_bor1ing}</p><h3 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h3><p>根据提示，需要改宽度和高度<br>winhex打开，从第二行开始，前四位是宽，后四位是高<br><img src="https://img-blog.csdnimg.cn/img_convert/7d7ef9f80954f70cea33a5b4539ac753.png" alt="在这里插入图片描述"><br>将01改为02（Edit-Modify Data)<br><img src="https://img-blog.csdnimg.cn/img_convert/7b27cb5465c9528c826d3bd683a14ee5.png" alt="在这里插入图片描述"><br>Save as 保存，查看新图片<br><img src="https://img-blog.csdnimg.cn/img_convert/dad913cb9ff8e385e0e2deddb82ec5cb.png" alt="在这里插入图片描述"><br>flag{He1l0_d4_ba1}</p><h3 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h3><p>有一个压缩包，提示了密码是4位数字，使用[ARCHPR]爆破可得(<a href="http://www.ddooo.com/softdown/176170.htm">http://www.ddooo.com/softdown/176170.htm</a>)<br><img src="https://img-blog.csdnimg.cn/img_convert/aa5e22544adb8500c9b5ae62dadc93b7.png" alt="在这里插入图片描述"><br>压缩包密码为2563，打开有base64加密的字符串<br>ZmxhZ3s3MDM1NDMwMGE1MTAwYmE3ODA2ODgwNTY2MWI5M2E1Y30=<br>解密得到flag<br>flag是：flag{70354300a5100ba78068805661b93a5c}</p><h3 id="乌镇峰会种图"><a href="#乌镇峰会种图" class="headerlink" title="乌镇峰会种图"></a>乌镇峰会种图</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/ac102555a7b306a6bbcfcabc4a26a46e.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/img_convert/123e9ae24394bdb3fd79846eac09f661.png" alt="在这里插入图片描述"><br>flag是：flag{97314e7864a8f62627b26f3f998c37f1}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="MISC" scheme="http://example.com/tags/MISC/"/>
    
  </entry>
  
  <entry>
    <title>实验室暑期CTF训练赛--第一周</title>
    <link href="http://example.com/2021/07/20/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9A%91%E6%9C%9FCTF%E8%AE%AD%E7%BB%83%E8%B5%9B--%E7%AC%AC%E4%B8%80%E5%91%A8/"/>
    <id>http://example.com/2021/07/20/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9A%91%E6%9C%9FCTF%E8%AE%AD%E7%BB%83%E8%B5%9B--%E7%AC%AC%E4%B8%80%E5%91%A8/</id>
    <published>2021-07-20T02:13:32.453Z</published>
    <updated>2021-07-21T12:40:07.420Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>只做了MISC和RE<br>题目和部分需要的工具链接：<br>链接：<a href="https://pan.baidu.com/s/1dwyK4jjlA44fFKZ3oQxQNg">https://pan.baidu.com/s/1dwyK4jjlA44fFKZ3oQxQNg</a><br>提取码：1uat</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="MISC2"><a href="#MISC2" class="headerlink" title="MISC2"></a>MISC2</h3><p>打开文件发现有一个音频，一个文件，文件记事本打开写着 <code>H4vFunWTHthisMP3</code> </p><p>一个音频加一串密钥的方式，所以使用MP3Steno<br><img src="https://img-blog.csdnimg.cn/20210718084454642.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将音频放入MP3Steno的文件夹</p><p>cmd打开，输入命令<br><img src="https://img-blog.csdnimg.cn/20210718084616264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210718084655108.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>生成txt文件，打开有一串字符，包上flag即可</p><p>flag是：flag{07715d8b6390495daa744cc22a62e2ef}</p><h3 id="timg-IN"><a href="#timg-IN" class="headerlink" title="timg_IN"></a>timg_IN</h3><p><img src="https://img-blog.csdnimg.cn/20210718085029287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>只有一张图片，binwalk扫了一下没有隐藏两张，发现也没有改长度和高度</p><p>使用工具Stegsolve.jar</p><p>找到自己java安装地址，cmd窗口打开bin文件，在该目录下输入如下命令<br><img src="https://img-blog.csdnimg.cn/20210718085637640.png" alt="在这里插入图片描述"><br>即可打开Stegsolve<br><img src="https://img-blog.csdnimg.cn/20210718085756889.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>操作图中红框里的按键左右移动</p><p>Blue 0 通道有一个二维码，扫一扫，得到一串字符</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- -.+++ +++.&lt; ++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; ++++[ -&gt;--- -&lt;]&gt;- ----- .&lt;+++ ++++[ -&gt;--- ----&lt; ]&gt;--- .&lt;+++ ++++[ -&gt;+++ ++++&lt; ]&gt;++. ++.&lt;+ +++++ [-&gt;-- ----&lt; ]&gt;--- ----- ---.- ----- .++++ ++++. &lt;++++ ++[-&gt; +++++ +&lt;]&gt;+ +++++ +++.. .---- .+.-- .&lt;+++ +++[- &gt;---- --&lt;]&gt; ----- -.--- .&lt;</span><br></pre></td></tr></table></figure><p>利用这个<a href="https://tool.bugku.com/brainfuck/?wafcloud=1">网站</a><br><img src="https://img-blog.csdnimg.cn/20210718101846818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>可以得到flag的前半段</p><p>通过观察我们发现图片的三色低像素通道都有一些像素块的样子<br>Green 0:<br><img src="https://img-blog.csdnimg.cn/20210718091629946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Red 0:<br><img src="https://img-blog.csdnimg.cn/20210718091726590.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以猜测是lsb </p><p>点这里<br><img src="https://img-blog.csdnimg.cn/20210718091818171.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>按下图设置，然后导出<br><img src="https://img-blog.csdnimg.cn/20210718092349531.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Notepad++打开，左边还有不需要的东西，按住ctrl+alt，拉取删掉，密文中间的空格同理，去掉了每一行的回车<br>得到如下字符</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">..... ..... ..... ...!? !!.?. ..... ..... ..... ..?.? !.?.. ..... </span><br><span class="line">............ ..... ..... ..... !.!.. ..... !.?.. ..... ..... ...!? !!.?! </span><br><span class="line">!!!!!..!!!!! !!!?. ?!.?! !!!!! !.?.. ..... ..... ...!? !!.?. ..... ..... </span><br><span class="line">...?...?!.?. ..... ..!.! !!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? </span><br><span class="line">.?!.?..!.?.. ..... ..... .!?!! .?... ..... ....? .?!.? ..... ..... ..... </span><br><span class="line">...........! .!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? .?!.? !!!!! </span><br><span class="line">.......!.... ..... !.?.. ..... ..... .!?!! .?... ..... ....? .?!.? ..... </span><br><span class="line">............ ..... !.?.. ..... ..... .!?!! .?!!! !!!!! !!!!? .?!.? !!!!! </span><br><span class="line">!!!!!..!!!!! !!.?. ..... ..... ..!?! !.?.. ..... ..... ?.?!. ?.... ..... </span><br><span class="line">.........!.? ..... ..... ..... !?!!. ?!!!! !!!!! !!!!! ?.?!. ?!!!! !!!.? </span><br><span class="line">............ ..... !?!!. ?.... ..... ..... ?.?!. ?..!. ?.... ..... ..!?! </span><br><span class="line">!.?......... ...?. ?!.?. ...!. ?....</span><br></pre></td></tr></table></figure><p>每过几个组就会有一个12个字符为一组的，12个的字符中间都是两个“<code>..</code>“，把他们换成空格<br><img src="https://img-blog.csdnimg.cn/20210718101705463.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后再取消换行，整理好之后的密文是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..... ..... ..... ...!? !!.?. ..... ..... ..... ..?.? !.?.. ..... ..... ..... ..... ..... ..... !.!.. ..... !.?.. ..... ..... ...!? !!.?! !!!!! !!!!! !!!?. ?!.?! !!!!! !.?.. ..... ..... ...!? !!.?. ..... ..... ...?. ?!.?. ..... ..!.! !!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? .?!.? !.?.. ..... ..... .!?!! .?... ..... ....? .?!.? ..... ..... ..... ..... ....! .!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? .?!.? !!!!! ..... !.... ..... !.?.. ..... ..... .!?!! .?... ..... ....? .?!.? ..... ..... ..... ..... !.?.. ..... ..... .!?!! .?!!! !!!!! !!!!? .?!.? !!!!! !!!!! !!!!! !!.?. ..... ..... ..!?! !.?.. ..... ..... ?.?!. ?.... ..... ..... ..!.? ..... ..... ..... !?!!. ?!!!! !!!!! !!!!! ?.?!. ?!!!! !!!.? ..... ..... ..... !?!!. ?.... ..... ..... ?.?!. ?..!. ?.... ..... ..!?! !.?.. ..... ...?. ?!.?. ...!. ?....</span><br></pre></td></tr></table></figure><p>还是使用那个网站<br><img src="https://img-blog.csdnimg.cn/20210718102001457.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>合起来就是flag了<br>flag是：flag{e1df719fffbca74aad0ed3cc026d8d0b}</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="ez-re"><a href="#ez-re" class="headerlink" title="ez_re"></a>ez_re</h3><p>这题有一个虚假的flag，我们可以先来看一看<br>通过搜索字符串我们发现了Game start字符<br>来到main函数<br><img src="https://img-blog.csdnimg.cn/20210720091051382.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>想着这里有一个判断，便跟进去看</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">v4 = <span class="number">99</span>;</span><br><span class="line">  v5 = <span class="number">23</span>;</span><br><span class="line">  v6 = <span class="number">113</span>;</span><br><span class="line">  v7 = <span class="number">2</span>;</span><br><span class="line">  v8 = <span class="number">106</span>;</span><br><span class="line">  v1 = a1 + <span class="number">1</span>;</span><br><span class="line">  v9 = <span class="number">5</span>;</span><br><span class="line">  v10 = <span class="number">114</span>;</span><br><span class="line">  v11 = <span class="number">9</span>;</span><br><span class="line">  v12 = <span class="number">109</span>;</span><br><span class="line">  v13 = <span class="number">2</span>;</span><br><span class="line">  v14 = <span class="number">93</span>;</span><br><span class="line">  v15 = <span class="number">36</span>;</span><br><span class="line">  v16 = <span class="number">75</span>;</span><br><span class="line">  v17 = <span class="number">62</span>;</span><br><span class="line">  v18 = <span class="number">97</span>;</span><br><span class="line">  v19 = <span class="number">13</span>;</span><br><span class="line">  v20 = <span class="number">100</span>;</span><br><span class="line">  v21 = <span class="number">15</span>;</span><br><span class="line">  v22 = <span class="number">106</span>;</span><br><span class="line">  v23 = <span class="number">53</span>;</span><br><span class="line">  v24 = <span class="number">83</span>;</span><br><span class="line">  v25 = <span class="number">50</span>;</span><br><span class="line">  v26 = <span class="number">89</span>;</span><br><span class="line">  v27 = <span class="number">60</span>;</span><br><span class="line">  v28 = <span class="number">3</span>;</span><br><span class="line">  v29 = <span class="number">60</span>;</span><br><span class="line">  v30 = <span class="number">65</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = *v1++;                                 <span class="comment">// v1是输入的字符串</span></span><br><span class="line">    *(v1 - <span class="number">1</span>) = ~(*(v1 - <span class="number">2</span>) &amp; v2) &amp; (*(v1 - <span class="number">2</span>) ^ v2);</span><br><span class="line">  &#125;                                             <span class="comment">// 这段的逻辑就是，v1[i] = ~(v1[i-1]&amp;v1[i])&amp;(v1[i-1]^v1[i])</span></span><br><span class="line">  <span class="keyword">while</span> ( Buf1 + <span class="number">27</span> != v1 );</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">memcmp</span>(Buf1, Buf2, <span class="number">0x1B</span>u) == <span class="number">0</span>;        <span class="comment">// 判断结果是否相等</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>感觉不错，写个脚本爆破，因为是与运算不容易逆回去</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">buf = [<span class="number">99</span>, <span class="number">23</span>, <span class="number">113</span>, <span class="number">2</span>, <span class="number">106</span>, <span class="number">5</span>, <span class="number">114</span>, <span class="number">9</span>, <span class="number">109</span>, <span class="number">2</span>, <span class="number">93</span>, <span class="number">36</span>, <span class="number">75</span>, <span class="number">62</span>, <span class="number">97</span>, <span class="number">13</span>, <span class="number">100</span>, <span class="number">15</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">83</span>, <span class="number">50</span>, <span class="number">89</span>, <span class="number">60</span>, <span class="number">3</span>, <span class="number">60</span>, <span class="number">65</span>]</span><br><span class="line">result = [<span class="number">0</span>] * <span class="number">27</span></span><br><span class="line">result[<span class="number">0</span>] = buf[<span class="number">0</span>]</span><br><span class="line">print(<span class="built_in">len</span>(buf))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(buf)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">        tmp = ~(buf[i-<span class="number">1</span>] &amp; j) &amp; (buf[i-<span class="number">1</span>] ^ j)</span><br><span class="line">        <span class="keyword">if</span> tmp == buf[i]:</span><br><span class="line">            result[i] = j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> result)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>得到ctfshow{do_you_like_fake??}</p><p>假的，都是假的，重新来过</p><p>那只能看main函数的第一个函数了，发现它没什么用<br><img src="https://img-blog.csdnimg.cn/20210720091901526.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>通过交叉引用，发现它还和这个函数有关。<br><img src="https://img-blog.csdnimg.cn/20210720091720827.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>跳转过去，F5<br><img src="https://img-blog.csdnimg.cn/20210720092026964.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>跟进上面红框中的函数<br><img src="https://img-blog.csdnimg.cn/20210720093840366.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>进入分析，发现有一个dword_402010，这里面有几个函数。<br><img src="https://img-blog.csdnimg.cn/20210720093924345.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210720093956158.png" alt="在这里插入图片描述"><br>分析一下是经过改变的RC4<br>本来应该是i，这里改了<br><img src="https://img-blog.csdnimg.cn/20210720094049642.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 我们看一下sub_4012D0函数<br> <img src="https://img-blog.csdnimg.cn/20210720094213375.png" alt="在这里插入图片描述"><br>onexit函数表示的是：在main函数结束之后还可以继续执行一段函数<br><img src="https://img-blog.csdnimg.cn/2021072009532646.png" alt="在这里插入图片描述"><br>将这个byte_403000中的数据拿出来，进行解密。然后再将每个值-7，即可得到flag<br>写脚本：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*key, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> k[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) </span><br><span class="line">&#123;</span><br><span class="line">s[i]=<span class="number">256</span> - i;</span><br><span class="line">k[i]=key[i%Len];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) </span><br><span class="line">&#123;</span><br><span class="line">j=(j+s[i]+k[i])%<span class="number">256</span>;</span><br><span class="line">tmp=s[i];</span><br><span class="line">s[i]=s[j];</span><br><span class="line">s[j]=tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*Data,<span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> k=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp;</span><br><span class="line"><span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;Len;k++)</span><br><span class="line">&#123;</span><br><span class="line">i=(i+<span class="number">1</span>)%<span class="number">256</span>;</span><br><span class="line">j=(j+s[i])%<span class="number">256</span>;</span><br><span class="line">tmp=s[i];</span><br><span class="line">s[i]=s[j];</span><br><span class="line">s[j]=tmp;</span><br><span class="line">t=(s[i]+s[j])%<span class="number">256</span>;</span><br><span class="line">Data[k]^=s[t];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> s[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i,j,k;</span><br><span class="line"><span class="keyword">char</span> key[<span class="number">256</span>] = <span class="string">&quot;keykeykey&quot;</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> data[] =</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">0xDC</span>, <span class="number">0x47</span>, <span class="number">0x7F</span>, <span class="number">0x6E</span>, <span class="number">0x9A</span>, <span class="number">0xD8</span>, <span class="number">0x60</span>, <span class="number">0x77</span>, <span class="number">0xF4</span>, <span class="number">0xB0</span>, </span><br><span class="line"><span class="number">0x8C</span>, <span class="number">0x54</span>, <span class="number">0xB0</span>, <span class="number">0xAA</span>, <span class="number">0x26</span>, <span class="number">0x23</span>, <span class="number">0x02</span>, <span class="number">0x42</span>, <span class="number">0x8E</span>, <span class="number">0xBA</span>, </span><br><span class="line"><span class="number">0x90</span>, <span class="number">0x8C</span>, <span class="number">0xAB</span>, <span class="number">0x86</span>, <span class="number">0x24</span>, <span class="number">0x6E</span>, <span class="number">0xF8</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> data_len = <span class="number">27</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> key_len = <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rc4_init(s,(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)key,key_len);</span><br><span class="line">rc4_crypt(s,(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)data,data_len);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">27</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%x &quot;</span>,data[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210720095837782.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>再做处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">buf2 = [<span class="number">0x6a</span>,<span class="number">0x7b</span>,<span class="number">0x6d</span>,<span class="number">0x7a</span>,<span class="number">0x6f</span>,<span class="number">0x76</span>,<span class="number">0x7e</span>,<span class="number">0x82</span>,<span class="number">0x80</span>,<span class="number">0x37</span>,<span class="number">0x7c</span>,<span class="number">0x66</span>,<span class="number">0x6e</span>,<span class="number">0x37</span>,<span class="number">0x7b</span>,<span class="number">0x66</span>,<span class="number">0x7b</span>,<span class="number">0x3b</span>,<span class="number">0x6c</span>,<span class="number">0x66</span>,<span class="number">0x3c</span>,<span class="number">0x6c</span>,<span class="number">0x6a</span>,<span class="number">0x79</span>,<span class="number">0x6c</span>,<span class="number">0x7b</span>,<span class="number">0x84</span>]</span><br><span class="line">buf = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(buf2)):</span><br><span class="line">    buf.append(buf2[i] - <span class="number">7</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> buf)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>flag是：ctfshow{y0u_g0t_t4e_5ecret}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="比赛" scheme="http://example.com/categories/%E6%AF%94%E8%B5%9B/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>2021CISCN初赛部分RE</title>
    <link href="http://example.com/2021/07/16/2021CISCN%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86RE/"/>
    <id>http://example.com/2021/07/16/2021CISCN%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86RE/</id>
    <published>2021-07-16T06:50:34.009Z</published>
    <updated>2021-07-21T12:40:23.107Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="glass"><a href="#glass" class="headerlink" title="glass"></a>glass</h2><p>题目解压之后发现是apk文件，更改后缀为.zip，再次解压<br><img src="https://img-blog.csdnimg.cn/20210714081212743.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210714081237754.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看到有.dex文件。dex文件是Android系统的可执行文件，包含应用程序的全部操作指令以及运行时数据。我们使用dex2jar反编译该文件。<br>把class.dex复制到dex2jar.bat所在目录，即dex2jar目录下。打开cmd，进入dex2jar所在的目录然后运行dex2jar.bat classes.dex，生成classes-dex2jar.jar就是所要转化jar包。<br><img src="https://img-blog.csdnimg.cn/20210714082432516.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210714082730723.png" alt="在这里插入图片描述"><br>使用jd-gui打开classes-dex2jar.jar</p><p><img src="https://img-blog.csdnimg.cn/20210714083246656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210714083645906.png" alt="在这里插入图片描述"></p><p>我们可以看到函数里面存在native定义，并且，在整个java代码里面没有checkFlag的定义，只有一个声明，这些都说明函数是定义在so文件之中的。<br>我们来寻找需要的so文件。<br>题目的lib文件里面只有一个so文件，正好也是寻找的native的so文件。<img src="https://img-blog.csdnimg.cn/20210714084434689.png" alt="在这里插入图片描述"><br>使用ida对其进行反编译。<br>通过搜索checkFlag函数找到该函数<br><img src="https://img-blog.csdnimg.cn/20210714084953594.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>我们可以知道flag的长度应该是39位的<br>接下来看函数<code>sub_FFC</code>和<code>sub_1088</code><br>sub_FFC:<br><img src="https://img-blog.csdnimg.cn/20210714085334146.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>sub_1088:<br><img src="https://img-blog.csdnimg.cn/20210714085415538.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以很明显的可以看出来是RC4加密，不清楚的同学可以对照<a href="https://baike.baidu.com/item/RC4/3454548?fr=aladdin">百度百科</a>上面的代码比较，会发现非常相像。同时，RC4的加密脚本也就是它的解密脚本。<br>那么checkFlag中的12345678就是key。<br>我们再查看函数<code>sub_10D4</code>：<br>可以看到对RC4处理完成的字符串再次进行处理，先进行异或，后面还有一些处理，看似复杂但是不用太在意，写脚本的时候直接倒回去就可以。<br>返回主checkFlag，我们发现最后得到的字符要和<code>unk_497C</code>进行比较。<br>unk_497C：<br>Shift+E提取一下<br><img src="https://img-blog.csdnimg.cn/20210714092601335.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>写脚本破解</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*key, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> k[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) </span><br><span class="line">&#123;</span><br><span class="line">        s[i]=i;</span><br><span class="line">        k[i]=key[i%Len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) </span><br><span class="line">&#123;</span><br><span class="line">        j=(j+s[i]+k[i])%<span class="number">256</span>;</span><br><span class="line">        tmp=s[i];</span><br><span class="line">        s[i]=s[j];</span><br><span class="line">        s[j]=tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*Data,<span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;Len;k++)</span><br><span class="line">    &#123;</span><br><span class="line">        i=(i+<span class="number">1</span>)%<span class="number">256</span>;</span><br><span class="line">        j=(j+s[i])%<span class="number">256</span>;</span><br><span class="line">        tmp=s[i];</span><br><span class="line">        s[i]=s[j];</span><br><span class="line">        s[j]=tmp;</span><br><span class="line">        t=(s[i]+s[j])%<span class="number">256</span>;</span><br><span class="line">        Data[k]^=s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> s[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i,j,k;</span><br><span class="line"><span class="keyword">char</span> key[<span class="number">256</span>] = <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> data[] =</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">0xA3</span>, <span class="number">0x1A</span>, <span class="number">0xE3</span>, <span class="number">0x69</span>, <span class="number">0x2F</span>, <span class="number">0xBB</span>, <span class="number">0x1A</span>, <span class="number">0x84</span>, <span class="number">0x65</span>, <span class="number">0xC2</span>, </span><br><span class="line"><span class="number">0xAD</span>, <span class="number">0xAD</span>, <span class="number">0x9E</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x1F</span>, <span class="number">0x8E</span>, <span class="number">0x36</span>, <span class="number">0x4F</span>, </span><br><span class="line"><span class="number">0xE1</span>, <span class="number">0xEB</span>, <span class="number">0xAF</span>, <span class="number">0xF0</span>, <span class="number">0xEA</span>, <span class="number">0xC4</span>, <span class="number">0xA8</span>, <span class="number">0x2D</span>, <span class="number">0x42</span>, <span class="number">0xC7</span>, </span><br><span class="line"><span class="number">0x6E</span>, <span class="number">0x3F</span>, <span class="number">0xB0</span>, <span class="number">0xD3</span>, <span class="number">0xCC</span>, <span class="number">0x78</span>, <span class="number">0xF9</span>, <span class="number">0x98</span>, <span class="number">0x3F</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> data_len = <span class="number">39</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> key_len = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; data_len; j += key_len )</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> ( k = <span class="number">0</span>; (key_len &amp; ~(key_len &gt;&gt; <span class="number">31</span>)) != k &amp;&amp; j + k &lt; data_len; ++k )</span><br><span class="line">data[j + k] ^= key[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; data_len;i += <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">data[i+<span class="number">1</span>] = data[i] ^ data[i+<span class="number">1</span>];</span><br><span class="line">data[i+<span class="number">2</span>] = data[i+<span class="number">1</span>] ^ data[i+<span class="number">2</span>];</span><br><span class="line">data[i] = data[i+<span class="number">2</span>] ^ data[i];</span><br><span class="line">&#125;</span><br><span class="line">rc4_init(s,(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)key,key_len);</span><br><span class="line">rc4_crypt(s,(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)data,data_len);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">39</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flag是：CISCN{6654d84617f627c88846c172e0f4d46c}</p><h2 id="baby-bc"><a href="#baby-bc" class="headerlink" title="baby.bc"></a>baby.bc</h2><p>查看文件类型<br><img src="https://img-blog.csdnimg.cn/20210714144413296.png" alt="在这里插入图片描述"><br>LLVM IR bitcode，二进制文件。需要转换成.s，然后再转成可执行文件。<br>在当前目录下打开终端，输入如下命令：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang baby.bc -o baby</span><br></pre></td></tr></table></figure><p>可以看到生成的文件已经是可执行文件了<br><img src="https://img-blog.csdnimg.cn/20210714150655595.png" alt="在这里插入图片描述"><br>将该生成的文件使用IDA打开<br>查看main函数<br><img src="https://img-blog.csdnimg.cn/20210714154407888.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>那么接下来就查看<code>fill_number</code>和<code>docheck</code>两个函数了<br>fill_number():</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">fill_number</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v2; <span class="comment">// [rsp+1h] [rbp-69h]</span></span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// [rsp+11h] [rbp-59h]</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [rsp+21h] [rbp-49h]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [rsp+31h] [rbp-39h]</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+40h] [rbp-2Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+41h] [rbp-29h]</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 v8; <span class="comment">// [rsp+4Ah] [rbp-20h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+52h] [rbp-18h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+5Ah] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = v10;</span><br><span class="line">    v8 = <span class="number">5</span> * v10;</span><br><span class="line">    v7 = *(_BYTE *)(a1 + <span class="number">5</span> * v10);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v7 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10] = v7 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = *(_BYTE *)(a1 + v8 + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">1</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v5 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">1</span>] = v5 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v4 = *(_BYTE *)(a1 + v8 + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">2</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">2</span>] = v4 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v3 = *(_BYTE *)(a1 + v8 + <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">3</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">3</span>] = v3 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v2 = *(_BYTE *)(a1 + v8 + <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">4</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v2 != <span class="number">48</span> )</span><br><span class="line">        <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">map</span>[<span class="number">5</span> * v10 + <span class="number">4</span>] = v2 - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v10;</span><br><span class="line">    v6 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v9 + <span class="number">1</span> &lt; <span class="number">5</span> );</span><br><span class="line">  <span class="keyword">return</span> v6 &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由这段代码可得，五个字符是一循环，分别判断其每一行的1~5位的数字。分析if/else，主要就是说map[]不为0时，当前的输入字符必须是’0’；如果map[]为0，当前的map字符为输入字符的ASCII码减去48。</p><p>map[]是一个二维数组，我们可以查看它的值。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>,   <span class="number">0</span>,   </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>fill_number函数的功能是：<br>当5*5的map二维矩阵中的值为0时，将该值转化为输入字符的ASCII码减去48；不为0时，对应的输入值为字符一定要为’0’。因为返回的是v6&amp;1，这个值需要返回是真值才可以出flag</p><p>docheck():<br>第一部分就是说map每行和每一列没有重复的数字<br>循环取输入的值，然后将取到值的对应位置写1，然后在后面循环中，如果该位置已经是1了，说明之前有出现过相同的数字，就是这样判断的。<br><img src="https://img-blog.csdnimg.cn/20210716143339279.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>接下来的row和col：<br>我们可以通过分析循环的次数和判断条件来得出如下的结果，代码比较长，需要耐心分析才行<br><img src="https://img-blog.csdnimg.cn/20210715085528211.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210715105804914.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最后得到的应该是如上的数独图<br>数独大佬可以自己解，变成大佬可以写代码用Z3<br>14253</p><p>53142</p><p>35421</p><p>21534</p><p>42315</p><p>根据上面的要求改map[2][2]和map[3][3]为0，md5之后得到flag<br><img src="https://img-blog.csdnimg.cn/20210716104956235.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag:CISCN{8a04b4597ad08b83211d3adfa1f61431}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="比赛" scheme="http://example.com/categories/%E6%AF%94%E8%B5%9B/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>动态分析之OllyDbg</title>
    <link href="http://example.com/2021/07/11/%E5%8A%A8%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8BOllyDbg/"/>
    <id>http://example.com/2021/07/11/%E5%8A%A8%E6%80%81%E5%88%86%E6%9E%90%E4%B9%8BOllyDbg/</id>
    <published>2021-07-11T03:13:49.832Z</published>
    <updated>2021-07-11T03:15:53.318Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="OllyDbg调试器"><a href="#OllyDbg调试器" class="headerlink" title="OllyDbg调试器"></a>OllyDbg调试器</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>使用之前要设置UDD文件和插件的路径，一般设置成绝对路径。</p><p>单击“Options”-“Appearance”打开界面选项对话框，单击“Directories”。<br><img src="https://img-blog.csdnimg.cn/20210711082923320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>主界面：<br><img src="https://img-blog.csdnimg.cn/20210711082441268.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在反汇编面板窗口的列中，双击可以完成如下操作。<br>●Address列:显示被双击行地址的相对地址，再次双击返回标准地址模式。<br>●Hex dump列:设置或取消无条件断点，对应的快捷键是“F2” 键。<br>●Disassembly 列:调用汇编器，可直接修改汇编代码，对应的快捷键是空格键。<br>●Comment 列:允许增加或编辑注释，对应的快捷键是“;”键。</p><p>OllyDbg界面的外观由“Appearance”对话框里的“Fonts” “Colours” “Code highlighting” 标签页控制，可以定制。</p><p>可以将OllyDbg 关联到Windows资源管理器的右键快捷菜单里。关联后，当调试程序时，只需要在EXE或DLL文件上单击右键，就会出现“Open with Ollydbg”菜单项。要想实现关联，只需要先单击“Options” →“Add to Explorer”选项，再单击“Add llyDbg to menu in Windows Explorer”按钮。</p><p>为了让OllyDbg中断在程序的入口点，单击“Options”→“Debugging options” 选项，单击“Event” ，设置<br>OllyDbg对中断入口点、模块加载/卸载、线程创建/结束等事件的处理方式，将断点设置在“WinMain”处。<br><img src="https://img-blog.csdnimg.cn/20210711085408292.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="调试技术"><a href="#调试技术" class="headerlink" title="调试技术"></a>调试技术</h3><p><img src="https://img-blog.csdnimg.cn/20210711090417274.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>“F7”键和“F8”键的主要区别在于，若遇到call、loop等指令，按“F8”键会路过，按“F7”键会跟进。</p><p>当要重复按“F7” 键或“F8” 键时，OllyDbg提供了快捷键“Ctrl+F7” 和“Ctrl+F8”， 直到用户按“Esc”键、F12”键或遇到其他断点时停止。</p><p>若想回看之前单步跟踪的代码，可以按“-” (减号)键;若想让光标回到当前EIP所指向的语句，可以单击C按钮或双击EIP寄存器（EIP指向当前将要执行的指令）。</p><p>当位于某个call 指令中，想返回调用这个call 指令的位置时，可以按“Ctrl+F9” 快捷键执行“Execute till return” 命令, OllyDbg会停在遇到的第1个返回命令处( ret、retf或iret )。</p><p>如果已经进入系统DLL提供的API函数，当要返回应用程序领空（指在某一时刻CPU的CS:EIP指向的某段代码的所有者）时，可以按快捷键“Alt+F9”<br>执行”Execute till user code” 命令。</p><p>程序进入死循环可以按F12暂停程序。</p><p>反汇编窗口右键选择<code>search for（查找）</code>-&gt;<code>Name(label) in current module(当前模块中的名称(标签))</code>。可以查找API函数名下断点。</p><p>API函数大都采用_ stdeall 调用约定，即函数入口参数按从右到左的顺序入栈，由被调用者清理栈中的参数，返回值放在eax寄存器中。因此，对相关的API函数，要分析其前面的push指令,这些指令将参数放入栈，以传送给API调用。</p><p>修改内存中的数据后，为了使修改一直有效，必须将这个变化写进磁盘文件。选中修改后的代码，单击右键，点击“Copy to executable”→“Selection”<br>命令，将会打开文件编辑窗口。单击右键，执行快<br>捷菜单中的“Save File” 命令，即可将修改保存到文件中。</p><p><strong>Hit trace</strong><br>Hit trace能够让调试者辨别哪一部分代码被执行了，哪一部分没有。<br>在选中区域的每一条命令处设置一个INT3断点，当中断发生时，OllyDbg便把它去除。在使用Hit trace时，不能在数据中设置断点，否则程序可能会崩溃。<br>当遇到一段跳转分支比较多的代码，需要了解程序的执行线路时，可以使用Hit trace。选中这段代码，单击右键快捷菜单中的“Hit trace”→“Add selection”命令，将需要监视的代码选中，然后按“F9”键让程序运行，OllyDbg 就会在已被执行的指令前用不同的颜色添加标记。</p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p><strong>1、乱码问题</strong><br>使用OllyDbg跟踪程序时，可能会出现如下情况。<br><img src="https://img-blog.csdnimg.cn/2021071111040597.png" alt="在这里插入图片描述"><br>这是因为OllyDbg将这段代码当成了数据，没有进行反汇编识别。此时，只要执行OllyDbg 右键快捷菜单中的“Analysis” →“Analyse code” (“分析”→“分析代码”)命令或按“Ctrl+A” 快捷键，强迫OllyDbg重新分析代码即可。如果还是无法识别，可以尝试执行右键快捷菜单中的“Analysis”→“Remove analysis from module”(“分析”→“从模块中删除分析”)命令或在UDD目录中删除相应的UDD文件。</p><p><strong>2. OllyDbg 修改EIP</strong><br>将光标移到需要修改的地址上，执行右键快捷菜单中的“New origin here” (在此处新建EIP )命<br>令或使用快捷键“Ctrl+*” 即可修改EIP。</p><p><strong>3.已经删除了断点，OllyDbg重新加载时这些断点重新出现</strong><br>将配置文件olydbg.ini中的相应内容改成“ Backup UDD files=1”即可解决。</p><p><strong>4.在OllyDbg反汇编窗口输入“push E000”会提示未知标识符</strong><br>这是因为OllyDbg的反汇编引擎不能正确识别字符“E000” 中的“E”是字母还是数字。解决方法是:在字母前加一个“0”， 表示这是数字，即“push 0E000”。<br><img src="https://img-blog.csdnimg.cn/20210711110919295.png" alt="在这里插入图片描述"><br><strong>5. OllyDbg 出现“假死”现象</strong><br>用OllyDbg调试一些加壳程序，程序运行到断点(包括硬件断点)时，OllyDbg 会出现“假死”现象。解决方法是:打开配置文件ollydbgini,如果“ Restore windows“是一个很大的值，就设置“Restore windows 0”。</p><p><strong>6.执行复制到可执行文件时，提示错误信息“Unable to locate data in executable file”</strong><br>这里要修改的地方不在RawSize范围内。修改PE文件，使“RawSize = VirtualSize”。</p><p><strong>7.把call调用改成函数名的形式</strong><br>例如“call 401496”,假设401496h处是amsg_ exit 函数,将光标停在该处，按“Shift +;”快捷键，会弹出一个标签框，在其中输人字符“amsg _exit”, 所有调用401496h处的call指令都会变成“call <amsg _exit>““的形式。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="逆向学习笔记" scheme="http://example.com/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>MRCTF2020Transform-[WUSTCTF2020]level1-[WUSTCTF2020]level2-[GWCTF 2019]xxor</title>
    <link href="http://example.com/2021/06/04/[MRCTF2020]Transform-[WUSTCTF2020]level1-[WUSTCTF2020]level2-[GWCTF%202019]xxor/"/>
    <id>http://example.com/2021/06/04/[MRCTF2020]Transform-[WUSTCTF2020]level1-[WUSTCTF2020]level2-[GWCTF%202019]xxor/</id>
    <published>2021-06-04T01:23:29.114Z</published>
    <updated>2021-06-04T01:26:44.851Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="MRCTF2020-Transform"><a href="#MRCTF2020-Transform" class="headerlink" title="[MRCTF2020]Transform"></a>[MRCTF2020]Transform</h2><p><img src="https://img-blog.csdnimg.cn/20210603202732366.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida64打开，找到main函数<br><img src="https://img-blog.csdnimg.cn/20210603204022765.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>dword_40F040：<img src="https://img-blog.csdnimg.cn/20210603204049211.png" alt="在这里插入图片描述"><br>注意：<br><img src="https://img-blog.csdnimg.cn/20210603204128108.png" alt="在这里插入图片描述"><br>所以上面<code>dword_40f040</code>最后那个 <code>8 dup(0)</code> 的数据不是8，而是0</p><p>byte_40F0E0：<br><img src="https://img-blog.csdnimg.cn/20210603204410995.png" alt="在这里插入图片描述"><br>倒回去就行了，写脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dword_40F040 = [<span class="number">0x9</span>, <span class="number">0x0A</span>, <span class="number">0x0F</span>, <span class="number">0x17</span>, <span class="number">0x7</span>, <span class="number">0x18</span>, <span class="number">0x0C</span>, <span class="number">0x6</span>, <span class="number">0x1</span>, <span class="number">0x10</span>, <span class="number">0x3</span>, <span class="number">0x11</span>, <span class="number">0x20</span>, <span class="number">0x1D</span>, <span class="number">0x0B</span>, <span class="number">0x1E</span>, <span class="number">0x1B</span>, <span class="number">0x16</span>, <span class="number">0x4</span>, <span class="number">0x0D</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x2</span>, <span class="number">0x19</span>, <span class="number">0x5</span>, <span class="number">0x1F</span>, <span class="number">0x8</span>, <span class="number">0x12</span>, <span class="number">0x1A</span>, <span class="number">0x1C</span>, <span class="number">0x0E</span>, <span class="number">0</span>]</span><br><span class="line">byte_40F0E0 = [<span class="number">0x67</span>, <span class="number">0x79</span>, <span class="number">0x7B</span>, <span class="number">0x7F</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>, <span class="number">0x3C</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x79</span>, <span class="number">0x57</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x42</span>, <span class="number">0x7B</span>, <span class="number">0x2D</span>, <span class="number">0x2A</span>, <span class="number">0x66</span>, <span class="number">0x42</span>, <span class="number">0x7E</span>, <span class="number">0x4C</span>, <span class="number">0x57</span>, <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0x3C</span>, <span class="number">0x5C</span>, <span class="number">0x45</span>, <span class="number">0x6F</span>, <span class="number">0x62</span>, <span class="number">0x4D</span>]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">33</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dword_40F040)):</span><br><span class="line">    byte_40F0E0[i] ^= dword_40F040[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dword_40F040)):</span><br><span class="line">    flag[dword_40F040[i]] = byte_40F0E0[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag]))</span><br></pre></td></tr></table></figure><p>MRCTF{Tr4nsp0sltiON_Clph3r_1s_3z}</p><p>flag是：flag{Tr4nsp0sltiON_Clph3r_1s_3z}</p><h2 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h2><p>两个文件，有一个是OUTPUT，打开发现是一串数字，猜测是程序输出的东西<br><img src="https://img-blog.csdnimg.cn/20210603210415974.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看另外一个文件</p><p><img src="https://img-blog.csdnimg.cn/20210603210442293.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida64打开，看main函数<br><img src="https://img-blog.csdnimg.cn/20210603210734559.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>打开flag文件读取内容，之后将里面的内容按照12行到18行的语句进行处理后输出，输出的按照之前的猜测就是OUTPUT文件里面的内容。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">&#x27;0&#x27;</span>,<span class="number">198</span>,<span class="number">232</span>,<span class="number">816</span>,<span class="number">200</span>,<span class="number">1536</span>,<span class="number">300</span>,<span class="number">6144</span>,<span class="number">984</span>,<span class="number">51200</span>,<span class="number">570</span>,<span class="number">92160</span>,<span class="number">1200</span>,<span class="number">565248</span>,<span class="number">756</span>,<span class="number">1474560</span>,<span class="number">800</span>,<span class="number">6291456</span>,<span class="number">1782</span>,<span class="number">65536000</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    <span class="keyword">if</span> (i &amp; <span class="number">1</span>):</span><br><span class="line">        print(<span class="built_in">chr</span>(a[i] &gt;&gt; (i)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="built_in">chr</span>(a[i] // (i)),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>ctf2020{d9-dE6-20c}</p><p>flag是：flag{d9-dE6-20c}</p><h2 id="WUSTCTF2020-level2"><a href="#WUSTCTF2020-level2" class="headerlink" title="[WUSTCTF2020]level2"></a>[WUSTCTF2020]level2</h2><p><img src="https://img-blog.csdnimg.cn/20210603212204971.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>UPX壳，kali脱壳<br><img src="https://img-blog.csdnimg.cn/20210603213822963.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="https://img-blog.csdnimg.cn/20210603213942818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70"><br>ida64打开<br>不知道为什么64说要用32，32说要用64，只好先查看字符串<br><img src="https://img-blog.csdnimg.cn/20210603214613747.png" alt="在这里插入图片描述"><br>结果在最下面发现了这个，就是flag</p><p>flag是：flag{Just_upx_-d}</p><h2 id="GWCTF-2019-xxor"><a href="#GWCTF-2019-xxor" class="headerlink" title="[GWCTF 2019]xxor"></a>[GWCTF 2019]xxor</h2><p><img src="https://img-blog.csdnimg.cn/20210603220727955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida64<br><img src="https://img-blog.csdnimg.cn/20210603222435517.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>首先输入一个字符串，然后进行中间部分的操作，最后需要满足44行的if判断，看一下函数<code>sub_400770</code><br><img src="https://img-blog.csdnimg.cn/2021060322294313.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到这样的关系式，求解</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a1[<span class="number">2</span>] - a1[<span class="number">3</span>] = <span class="number">2225223423</span></span><br><span class="line">a1[<span class="number">3</span>] + a1[<span class="number">4</span>] = <span class="number">4201428739</span></span><br><span class="line">a1[<span class="number">2</span>] - a1[<span class="number">4</span>] = <span class="number">1121399208</span></span><br><span class="line">a1[<span class="number">0</span>] = <span class="number">3746099070</span> </span><br><span class="line">a1[<span class="number">5</span>] = <span class="number">550153460</span></span><br><span class="line">a1[<span class="number">1</span>] = <span class="number">550153460</span></span><br></pre></td></tr></table></figure><p>利用z3<br>安装z3的命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install z3-solver</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a2,a3,a4 = BitVecs(<span class="string">&#x27;a2 a3 a4&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(a2 - a3 == <span class="number">2225223423</span>)</span><br><span class="line">s.add(a3 + a4 == <span class="number">4201428739</span>)</span><br><span class="line">s.add(a2 - a4 == <span class="number">1121399208</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        print(<span class="string">&quot;%s = %ld&quot;</span> % (i, m[i].as_long()))</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210604090658981.png" alt="在这里插入图片描述"><br>现在a1数组里的值就都知道了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a1=[<span class="number">3746099070</span>, <span class="number">550153460</span>, <span class="number">3774025685</span>, <span class="number">1548802262</span>, <span class="number">2652626477</span>, <span class="number">2230518816</span>]</span><br></pre></td></tr></table></figure><p>程序在main函数的36~43行进行了操作，看一下函数<code>sub_400686</code><br><img src="https://img-blog.csdnimg.cn/20210604090848704.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这是一个利用已知数组unk_601060对我们输入的整型数组进行异或操作，因此只需要将整个过程逆过来，for循环那段，将异或过程看成一个整体，最后就能得到输入的整型数组。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> xorm[<span class="number">6</span>];</span><br><span class="line">xorm[<span class="number">0</span>] = <span class="number">3746099070</span>;</span><br><span class="line">xorm[<span class="number">1</span>] = <span class="number">550153460</span>;</span><br><span class="line">xorm[<span class="number">2</span>] = <span class="number">3774025685</span>;</span><br><span class="line">xorm[<span class="number">3</span>] = <span class="number">1548802262</span>;</span><br><span class="line">xorm[<span class="number">4</span>] = <span class="number">2652626477</span>;</span><br><span class="line">xorm[<span class="number">5</span>] = <span class="number">2230518816</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>,j=<span class="number">0</span>,sum;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> temp[<span class="number">2</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> data[<span class="number">4</span>] = &#123; <span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">temp[<span class="number">0</span>] = xorm[i];</span><br><span class="line">temp[<span class="number">1</span>] = xorm[i + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">sum = <span class="number">0x458BCD42</span> * <span class="number">64</span>;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">temp[<span class="number">1</span>] -= (temp[<span class="number">0</span>] + sum + <span class="number">20</span>) ^ ((temp[<span class="number">0</span>] &lt;&lt; <span class="number">6</span>) + <span class="number">3</span>) ^ ((temp[<span class="number">0</span>] &gt;&gt; <span class="number">9</span>) + <span class="number">4</span>) ^ <span class="number">0x10</span>;</span><br><span class="line">temp[<span class="number">0</span>] -= (temp[<span class="number">1</span>] + sum + <span class="number">11</span>) ^ ((temp[<span class="number">1</span>] &lt;&lt; <span class="number">6</span>) + <span class="number">2</span>) ^ ((temp[<span class="number">1</span>] &gt;&gt; <span class="number">9</span>) + <span class="number">2</span>) ^ <span class="number">0x20</span>;</span><br><span class="line">sum -= <span class="number">0x458BCD42</span>;</span><br><span class="line">&#125;</span><br><span class="line">xorm[i] = temp[<span class="number">0</span>];</span><br><span class="line">xorm[i + <span class="number">1</span>] = temp[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x&quot;</span>,xorm[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210604091455605.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210604091932424.png" alt="在这里插入图片描述"><br>所以要将16进制转换成字符串<br>利用<a href="https://zixuephp.net/tool-str-hex.html">在线工具</a><br><img src="https://img-blog.csdnimg.cn/20210604092125277.png" alt="在这里插入图片描述"><br>flag是：flag{re_is_great!}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>github突然无法使用hexo g上传博客问题的解决</title>
    <link href="http://example.com/2021/06/03/github%E7%AA%81%E7%84%B6%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8hexo%20g%E4%B8%8A%E4%BC%A0%E5%8D%9A%E5%AE%A2%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/"/>
    <id>http://example.com/2021/06/03/github%E7%AA%81%E7%84%B6%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8hexo%20g%E4%B8%8A%E4%BC%A0%E5%8D%9A%E5%AE%A2%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/</id>
    <published>2021-06-03T12:19:56.486Z</published>
    <updated>2021-06-03T12:22:01.437Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>输入<code>hexo g</code>后<br> 报错：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can not read a block mapping entry; a multiline key may not be an implicit key</span><br></pre></td></tr></table></figure><p> 显示文章上传失败</p><p>有可能是因为文章的标题开头使用了不可以放在开头的字符</p><p>例如：<br>本来是：<code>[2021BUUCTF]RE</code><br>改成：<code>2021BUUCTF]RE</code>就可以了</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="学习笔记" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="工具使用" scheme="http://example.com/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>GUET-CTF2019re-[SUCTF2019]SignIn-相册-[ACTF新生赛2020]usualCrypt</title>
    <link href="http://example.com/2021/06/03/[GUET-CTF2019]re-[SUCTF2019]SignIn-%E7%9B%B8%E5%86%8C-[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]usualCrypt/"/>
    <id>http://example.com/2021/06/03/[GUET-CTF2019]re-[SUCTF2019]SignIn-%E7%9B%B8%E5%86%8C-[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]usualCrypt/</id>
    <published>2021-06-03T03:34:20.151Z</published>
    <updated>2021-06-03T12:09:57.971Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="GUET-CTF2019-re"><a href="#GUET-CTF2019-re" class="headerlink" title="[GUET-CTF2019]re"></a>[GUET-CTF2019]re</h2><p><img src="https://img-blog.csdnimg.cn/20210603085928634.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>UPX壳，Kali脱壳<br><img src="https://img-blog.csdnimg.cn/20210603090143551.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210603090357732.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>elf文件，IDA64打开<br>通过字符串找到这里<br><img src="https://img-blog.csdnimg.cn/2021060309053181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看if判断里面的函数<code>sub_4009AE()</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BOOL8 __fastcall <span class="title">sub_4009AE</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">1629056</span> * *a1 != <span class="number">166163712</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6771600</span> * a1[<span class="number">1</span>] != <span class="number">731332800</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3682944</span> * a1[<span class="number">2</span>] != <span class="number">357245568</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">10431000</span> * a1[<span class="number">3</span>] != <span class="number">1074393000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3977328</span> * a1[<span class="number">4</span>] != <span class="number">489211344</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5138336</span> * a1[<span class="number">5</span>] != <span class="number">518971936</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7532250</span> * a1[<span class="number">7</span>] != <span class="number">406741500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5551632</span> * a1[<span class="number">8</span>] != <span class="number">294236496</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3409728</span> * a1[<span class="number">9</span>] != <span class="number">177305856</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">13013670</span> * a1[<span class="number">10</span>] != <span class="number">650683500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6088797</span> * a1[<span class="number">11</span>] != <span class="number">298351053</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7884663</span> * a1[<span class="number">12</span>] != <span class="number">386348487</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8944053</span> * a1[<span class="number">13</span>] != <span class="number">438258597</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5198490</span> * a1[<span class="number">14</span>] != <span class="number">249527520</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4544518</span> * a1[<span class="number">15</span>] != <span class="number">445362764</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3645600</span> * a1[<span class="number">17</span>] != <span class="number">174988800</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">10115280</span> * a1[<span class="number">16</span>] != <span class="number">981182160</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">9667504</span> * a1[<span class="number">18</span>] != <span class="number">493042704</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5364450</span> * a1[<span class="number">19</span>] != <span class="number">257493600</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">13464540</span> * a1[<span class="number">20</span>] != <span class="number">767478780</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5488432</span> * a1[<span class="number">21</span>] != <span class="number">312840624</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">14479500</span> * a1[<span class="number">22</span>] != <span class="number">1404511500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6451830</span> * a1[<span class="number">23</span>] != <span class="number">316139670</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6252576</span> * a1[<span class="number">24</span>] != <span class="number">619005024</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7763364</span> * a1[<span class="number">25</span>] != <span class="number">372641472</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7327320</span> * a1[<span class="number">26</span>] != <span class="number">373693320</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8741520</span> * a1[<span class="number">27</span>] != <span class="number">498266640</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8871876</span> * a1[<span class="number">28</span>] != <span class="number">452465676</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4086720</span> * a1[<span class="number">29</span>] != <span class="number">208422720</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">9374400</span> * a1[<span class="number">30</span>] == <span class="number">515592000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5759124</span> * a1[<span class="number">31</span>] == <span class="number">719890500</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输入的每一位乘上一个数字之后是另一个数字用来检验，那么除回去就行了，记得取整除</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">a0 = <span class="number">166163712</span> // <span class="number">1629056</span></span><br><span class="line">a1 = <span class="number">731332800</span> // <span class="number">6771600</span></span><br><span class="line">a2 = <span class="number">357245568</span> // <span class="number">3682944</span></span><br><span class="line">a3= <span class="number">1074393000</span> // <span class="number">10431000</span></span><br><span class="line">a4= <span class="number">489211344</span> // <span class="number">3977328</span></span><br><span class="line">a5 = <span class="number">518971936</span> // <span class="number">5138336</span></span><br><span class="line">a6=<span class="string">&#x27;_&#x27;</span></span><br><span class="line">a7= <span class="number">406741500</span> // <span class="number">7532250</span></span><br><span class="line">a8= <span class="number">294236496</span> // <span class="number">5551632</span></span><br><span class="line">a9= <span class="number">177305856</span> // <span class="number">3409728</span></span><br><span class="line">a10= <span class="number">650683500</span> // <span class="number">13013670</span></span><br><span class="line">a11= <span class="number">298351053</span> // <span class="number">6088797</span></span><br><span class="line">a12= <span class="number">386348487</span> // <span class="number">7884663</span></span><br><span class="line">a13= <span class="number">438258597</span> // <span class="number">8944053</span></span><br><span class="line">a14= <span class="number">249527520</span> // <span class="number">5198490</span></span><br><span class="line">a15= <span class="number">445362764</span> // <span class="number">4544518</span></span><br><span class="line">a16= <span class="number">981182160</span> //<span class="number">10115280</span></span><br><span class="line">a17= <span class="number">174988800</span> // <span class="number">3645600</span></span><br><span class="line">a18= <span class="number">493042704</span> // <span class="number">9667504</span></span><br><span class="line">a19= <span class="number">257493600</span> // <span class="number">5364450</span></span><br><span class="line">a20= <span class="number">767478780</span> // <span class="number">13464540</span></span><br><span class="line">a21= <span class="number">312840624</span> // <span class="number">5488432</span></span><br><span class="line">a22= <span class="number">1404511500</span> // <span class="number">14479500</span></span><br><span class="line">a23= <span class="number">316139670</span> // <span class="number">6451830</span></span><br><span class="line">a24= <span class="number">619005024</span> // <span class="number">6252576</span></span><br><span class="line">a25= <span class="number">372641472</span> // <span class="number">7763364</span></span><br><span class="line">a26= <span class="number">373693320</span> // <span class="number">7327320</span></span><br><span class="line">a27= <span class="number">498266640</span> // <span class="number">8741520</span></span><br><span class="line">a28= <span class="number">452465676</span> // <span class="number">8871876</span></span><br><span class="line">a29= <span class="number">208422720</span> // <span class="number">4086720</span></span><br><span class="line">a30= <span class="number">515592000</span> // <span class="number">9374400</span></span><br><span class="line">a31= <span class="number">719890500</span> // <span class="number">5759124</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">chr</span>(a0),<span class="built_in">chr</span>(a1),<span class="built_in">chr</span>(a2),<span class="built_in">chr</span>(a3),<span class="built_in">chr</span>(a4),<span class="built_in">chr</span>(a5),a6,<span class="built_in">chr</span>(a7),<span class="built_in">chr</span>(a8),<span class="built_in">chr</span>(a9),<span class="built_in">chr</span>(a10),<span class="built_in">chr</span>(a11),<span class="built_in">chr</span>(a12),<span class="built_in">chr</span>(a13),<span class="built_in">chr</span>(a14),<span class="built_in">chr</span>(a15),<span class="built_in">chr</span>(a16),<span class="built_in">chr</span>(a17),<span class="built_in">chr</span>(a18),<span class="built_in">chr</span>(a19),<span class="built_in">chr</span>(a20),<span class="built_in">chr</span>(a21),<span class="built_in">chr</span>(a22),<span class="built_in">chr</span>(a23),<span class="built_in">chr</span>(a24),<span class="built_in">chr</span>(a25),<span class="built_in">chr</span>(a26),<span class="built_in">chr</span>(a27),<span class="built_in">chr</span>(a28),<span class="built_in">chr</span>(a29),<span class="built_in">chr</span>(a30),<span class="built_in">chr</span>(a31))</span><br></pre></td></tr></table></figure><p>flag{e_65421110ba03099a1c039337}<br>少了第6位，爆破得到1<br>flag是flag{e165421110ba03099a1c039337}</p><h2 id="SUCTF2019-SignIn"><a href="#SUCTF2019-SignIn" class="headerlink" title="[SUCTF2019]SignIn"></a>[SUCTF2019]SignIn</h2><p><img src="https://img-blog.csdnimg.cn/20210603092003666.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这题以前做过，elf文件，ida64打开<br><img src="https://img-blog.csdnimg.cn/20210603092445239.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>程序调用了 <code>__gmpz_init_set_str</code> 函数，这是一个 GNU 高精度算法库，在RSA加密中见过几次，看下格式确定了这是RSA加密</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mpz_init_set_str</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">char</span> *str, <span class="keyword">int</span> base)</span></span></span><br><span class="line">mpz_t rop:多精度整数变量</span><br><span class="line"><span class="keyword">char</span> *str: 字符串</span><br><span class="line"><span class="keyword">int</span> base: 进制</span><br><span class="line">将str按照base进制转换为rop</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">void mpz_powm (mpz_t rop, const mpz_t base, const mpz_t exp, const mpz_t mod) [Function]</span><br><span class="line">函数功能： rop = base^<span class="built_in">exp</span>取余mod</span><br></pre></td></tr></table></figure><p>从题目中得到数据</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span><br><span class="line">N(十进制)：<span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">E：<span class="number">65537</span></span><br></pre></td></tr></table></figure><p>分解N得到p,q，分解教程参考<a href="https://www.mrskye.cn/archives/18/">这个</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">q = <span class="number">282164587459512124844245113950593348271</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line">n = p * q</span><br><span class="line">d = gmpy2.invert(e, (p-<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line">m = gmpy2.powmod(c, d, n)</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]).decode(encoding=<span class="string">&quot;utf-8&quot;</span>))</span><br></pre></td></tr></table></figure><p>suctf{Pwn_@_hundred_years}</p><p>flag是：flag{Pwn_@_hundred_years}</p><h2 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h2><p>apk逆向，打开jeb，通过字符串找到关键函数<br><img src="https://img-blog.csdnimg.cn/20210603094712547.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210603094953889.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最下面有一个函数，跟进去查看<img src="https://img-blog.csdnimg.cn/20210603095104406.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210603095527164.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提示了邮箱，这里有new了新的邮箱，点击MAILUSER那一行跟进去查看<br><img src="https://img-blog.csdnimg.cn/20210603095620911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以看到MAILSERVER，这是是加载外部so文件中NativeMethod.m()函数所返回的值，再进行base64解密。因此我们只需要找到so文件中经过base64加密的字符串。<br><img src="https://img-blog.csdnimg.cn/20210603095856354.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>导出，使用ida打开，通过字符串搜索找到类似base64加密后的字符串<br>有3个都解一下发现第二个是个邮箱地址<br><img src="https://img-blog.csdnimg.cn/20210603100351989.png" alt="在这里插入图片描述"><br>flag是：flag{18218465125@163.com}</p><h2 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h2><p><img src="https://img-blog.csdnimg.cn/20210603110711799.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>找到main函数<br><img src="https://img-blog.csdnimg.cn/2021060311142982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>12 和 26 行的sub_403CF8是输出函数，21 - 25 行的while()是字符串比较的过程，<br>输入 flag 加密验证正确性的模型<br>看19行的函数<code>sub_401080</code><br><img src="https://img-blog.csdnimg.cn/20210603111827795.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>先执行了<code>sub_401000</code>，这是一个改变密钥对应表的函数，后面是base64加密算法，最后还有一个函数<code>sub_401030</code>，这是交换大小写字母的。</p><p>看函数<code>sub_401000</code><br><img src="https://img-blog.csdnimg.cn/20210603112613651.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将两个数组里的数据进行了交换，根据地址两个数组连在一起，也可以当成一个数组看，从下标为6开始到下标为15，往后偏移了10（0xA）位，也就是QRSTUVWXY和GHIJKLMNOP相互交换了一下<br>新的密码表是<code>ABCDEFQRSTUVWXYGHIJKLMNOPZabcdefghijklmnopqrstuvwxyz0123456789+/</code></p><p>逆向推导：<br>首先要对<code>byte_40E0E4</code>数组进行大小写转换；然后是还原经 base64（更改密钥表后）加密字符的原含义；最后得到了真实的加密字符串</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>; <span class="built_in">dict</span> = &#123;&#125;; offset = <span class="number">10</span></span><br><span class="line">orgin = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(orgin)):</span><br><span class="line">    <span class="built_in">dict</span>[orgin[i]] = orgin[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>, <span class="number">15</span>): <span class="comment">#sub_401000()</span></span><br><span class="line">    <span class="built_in">dict</span>[orgin[i]] , <span class="built_in">dict</span>[orgin[i+offset]] = <span class="built_in">dict</span>[orgin[i+offset]] , <span class="built_in">dict</span>[orgin[i]] <span class="comment"># 恢复base64密钥表</span></span><br><span class="line">secret = <span class="string">&#x27;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&#x27;</span>.swapcase() <span class="comment">#sub_401030()</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret)):</span><br><span class="line">    flag += <span class="built_in">dict</span>[secret[i]] </span><br><span class="line">flag = base64.b64decode(flag)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210603113236509.png" alt="在这里插入图片描述"><br>flag是：flag{bAse64_h2s_a_Surprise}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>2019红帽杯easyRE-ACTF新生赛2020rome-[FlareOn4]login-Youngterdrive</title>
    <link href="http://example.com/2021/06/03/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020rome-[FlareOn4]login-Youngterdrive/"/>
    <id>http://example.com/2021/06/03/2019%E7%BA%A2%E5%B8%BD%E6%9D%AFeasyRE-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020rome-[FlareOn4]login-Youngterdrive/</id>
    <published>2021-06-02T17:26:51.770Z</published>
    <updated>2021-06-02T17:29:34.155Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>@<a href="BUUCTF">TOC</a></p><h2 id="2019红帽杯-easyRE"><a href="#2019红帽杯-easyRE" class="headerlink" title="[2019红帽杯]easyRE"></a>[2019红帽杯]easyRE</h2><p><img src="https://img-blog.csdnimg.cn/20210602153821792.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>elf文件，ida64打开，感兴趣的同学也可以开Linux系统看一看文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"> v56 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v14 = <span class="number">73</span>;</span><br><span class="line">  v15 = <span class="number">111</span>;</span><br><span class="line">  v16 = <span class="number">100</span>;</span><br><span class="line">  v17 = <span class="number">108</span>;</span><br><span class="line">  v18 = <span class="number">62</span>;</span><br><span class="line">  v19 = <span class="number">81</span>;</span><br><span class="line">  v20 = <span class="number">110</span>;</span><br><span class="line">  v21 = <span class="number">98</span>;</span><br><span class="line">  v22 = <span class="number">40</span>;</span><br><span class="line">  v23 = <span class="number">111</span>;</span><br><span class="line">  v24 = <span class="number">99</span>;</span><br><span class="line">  v25 = <span class="number">121</span>;</span><br><span class="line">  v26 = <span class="number">127</span>;</span><br><span class="line">  v27 = <span class="number">121</span>;</span><br><span class="line">  v28 = <span class="number">46</span>;</span><br><span class="line">  v29 = <span class="number">105</span>;</span><br><span class="line">  v30 = <span class="number">127</span>;</span><br><span class="line">  v31 = <span class="number">100</span>;</span><br><span class="line">  v32 = <span class="number">96</span>;</span><br><span class="line">  v33 = <span class="number">51</span>;</span><br><span class="line">  v34 = <span class="number">119</span>;</span><br><span class="line">  v35 = <span class="number">125</span>;</span><br><span class="line">  v36 = <span class="number">119</span>;</span><br><span class="line">  v37 = <span class="number">101</span>;</span><br><span class="line">  v38 = <span class="number">107</span>;</span><br><span class="line">  v39 = <span class="number">57</span>;</span><br><span class="line">  v40 = <span class="number">123</span>;</span><br><span class="line">  v41 = <span class="number">105</span>;</span><br><span class="line">  v42 = <span class="number">121</span>;</span><br><span class="line">  v43 = <span class="number">61</span>;</span><br><span class="line">  v44 = <span class="number">126</span>;</span><br><span class="line">  v45 = <span class="number">121</span>;</span><br><span class="line">  v46 = <span class="number">76</span>;</span><br><span class="line">  v47 = <span class="number">64</span>;</span><br><span class="line">  v48 = <span class="number">69</span>;</span><br><span class="line">  v49 = <span class="number">67</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v50, <span class="number">0</span>, <span class="keyword">sizeof</span>(v50));</span><br><span class="line">  v51 = <span class="number">0</span>;</span><br><span class="line">  v52 = <span class="number">0</span>;</span><br><span class="line">  v0 = v50;</span><br><span class="line">  sub_4406E0(<span class="number">0LL</span>, v50, <span class="number">37LL</span>);</span><br><span class="line">  v52 = <span class="number">0</span>;</span><br><span class="line">  v1 = v50;</span><br><span class="line">  <span class="keyword">if</span> ( sub_424BA0(v50) == <span class="number">36</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = v50;</span><br><span class="line">      <span class="keyword">if</span> ( i &gt;= (<span class="keyword">unsigned</span> __int64)sub_424BA0(v50) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)(v50[i] ^ i) != *(&amp;v14 + i) )</span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="number">4294967294LL</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_410CC0((__int64)<span class="string">&quot;continue!&quot;</span>);           <span class="comment">// 第一部分处理</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;v53, <span class="number">0</span>, <span class="number">0x40</span>uLL);</span><br><span class="line">    v55 = <span class="number">0</span>;</span><br><span class="line">    v0 = &amp;v53;</span><br><span class="line">    sub_4406E0(<span class="number">0LL</span>, &amp;v53, <span class="number">64LL</span>);</span><br><span class="line">    v54 = <span class="number">0</span>;</span><br><span class="line">    v1 = &amp;v53;</span><br><span class="line">    <span class="keyword">if</span> ( sub_424BA0(&amp;v53) == <span class="number">39</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = sub_400E44((__int64)&amp;v53);           <span class="comment">// 十次base64处理</span></span><br><span class="line">      v4 = sub_400E44(v3);</span><br><span class="line">      v5 = sub_400E44(v4);</span><br><span class="line">      v6 = sub_400E44(v5);</span><br><span class="line">      v7 = sub_400E44(v6);</span><br><span class="line">      v8 = sub_400E44(v7);</span><br><span class="line">      v9 = sub_400E44(v8);</span><br><span class="line">      v10 = sub_400E44(v9);</span><br><span class="line">      v11 = sub_400E44(v10);</span><br><span class="line">      v12 = sub_400E44(v11);</span><br><span class="line">      v0 = off_6CC090;</span><br><span class="line">      v1 = (<span class="keyword">char</span> *)v12;</span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_400360(v12, off_6CC090) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_410CC0((__int64)<span class="string">&quot;You found me!!!&quot;</span>);</span><br><span class="line">        v1 = <span class="string">&quot;bye bye~&quot;</span>;</span><br><span class="line">        sub_410CC0((__int64)<span class="string">&quot;bye bye~&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      result = <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">4294967293LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) != v56 )</span><br><span class="line">    sub_444020(v1, v0);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第一部分的处理是个异或，第二部分打开函数之后发现是base64的运算（10次），而且得到的结果与off_6cc090比较<br>先解出第一部分</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = [<span class="number">73</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">108</span>,<span class="number">62</span>,<span class="number">81</span>,<span class="number">110</span>,<span class="number">98</span>,<span class="number">40</span>,<span class="number">111</span>,<span class="number">99</span>,<span class="number">121</span>,<span class="number">127</span>,<span class="number">121</span>,<span class="number">46</span>,<span class="number">105</span>,<span class="number">127</span>,<span class="number">100</span>,<span class="number">96</span>,<span class="number">51</span>,<span class="number">119</span>,<span class="number">125</span>,<span class="number">119</span>,<span class="number">101</span>,<span class="number">107</span>,<span class="number">57</span>,<span class="number">123</span>,<span class="number">105</span>,<span class="number">121</span>,<span class="number">61</span>,<span class="number">126</span>,<span class="number">121</span>,<span class="number">76</span>,<span class="number">64</span>,<span class="number">69</span>,<span class="number">67</span>]</span><br><span class="line">input1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">str</span>)):</span><br><span class="line">   input1 += <span class="built_in">chr</span>(<span class="built_in">str</span>[i]^i)</span><br><span class="line">print(input1)</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210602235638257.png" alt="在这里插入图片描述"><br>第二部分用在线工具解十次base64，解出来发现是个网站<br><a href="https://bbs.pediy.com/thread-254172.htm">https://bbs.pediy.com/thread-254172.htm</a><br>打开发现没有用，是个干扰项<br>看了其他师傅的wp后才知道，在我们base64加密结束后，下面有调用一个sub_400D35的函数<br><img src="https://img-blog.csdnimg.cn/20210603011038491.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>过去看看<br><img src="https://img-blog.csdnimg.cn/202106030112157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>24行判断第一个和第四个是不是f和g，那就猜测这四个字符是flag。</p><p>然后循环24次做异或操作。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">num2=[<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line">text2=<span class="string">&#x27;flag&#x27;</span></span><br><span class="line">key=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">    key=key+<span class="built_in">chr</span>(<span class="built_in">ord</span>(text2[i])^num2[i])</span><br><span class="line"><span class="built_in">print</span>（key）</span><br></pre></td></tr></table></figure><p>得到v5 == &amp;YA1<br>在求出v2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">num2=[<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line">key=<span class="string">&#x27;&amp;YA1&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):</span><br><span class="line">    flag=flag+<span class="built_in">chr</span>(num2[i]^<span class="built_in">ord</span>(key[i%<span class="number">4</span>]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>flag是：flag{Act1ve_Defen5e_Test}</p><h2 id="ACTF新生赛2020-rome"><a href="#ACTF新生赛2020-rome" class="headerlink" title="[ACTF新生赛2020]rome"></a>[ACTF新生赛2020]rome</h2><p><img src="https://img-blog.csdnimg.cn/20210601200743438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida 32 ，通过main函数或者字符串搜索都可以找到函数<code>func()</code><br>发现其实就是将输入的字符串大写和小写分开进行变换，然后比较输出<br><img src="https://img-blog.csdnimg.cn/20210601202029949.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>写一个脚本跑一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">v15= [<span class="number">81</span>,<span class="number">115</span>,<span class="number">119</span>,<span class="number">51</span>,<span class="number">115</span>,<span class="number">106</span>,<span class="number">95</span>,<span class="number">108</span>,<span class="number">122</span>,<span class="number">52</span>,<span class="number">95</span>,<span class="number">85</span>,<span class="number">106</span>,<span class="number">119</span>,<span class="number">64</span>,<span class="number">108</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        x=j</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(x).isupper():</span><br><span class="line">            x=(x-<span class="number">51</span>)%<span class="number">26</span>+<span class="number">65</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(x).islower():</span><br><span class="line">            x=(x-<span class="number">79</span>)%<span class="number">26</span>+<span class="number">97</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(x)==<span class="built_in">chr</span>(v15[i]):</span><br><span class="line">            flag+=<span class="built_in">chr</span>(j)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;flag&#123;&#x27;</span>+flag+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>flag{Cae3ar_th4_Gre@t}</p><h2 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="[FlareOn4]login"></a>[FlareOn4]login</h2><p>网页打开，F12查看HTML源码<br><img src="https://img-blog.csdnimg.cn/20210601203029493.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><code>var rotFlag = flag.replace(/[a-zA-Z]/g, function(c)&#123;return String.fromCharCode((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13) ? c : c - 26);&#125;);</code>这句代码的意思就是将字符后移13位，越界了就转回字母开头，最后得到了字符串<code>PyvragFvqrYbtvafNerRnfl@syner-ba.pbz</code><br>其实就是ROT13，找一个在线网站解一下，得到：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ClientSideLoginsAreEasy@flare-on.com</span><br></pre></td></tr></table></figure><p>flag是：flag{ClientSideLoginsAreEasy@flare-on.com}</p><h2 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h2><p><img src="https://img-blog.csdnimg.cn/20210601204809958.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>kali脱壳<br><img src="https://img-blog.csdnimg.cn/2021060121331293.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210601213425335.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida打开，找到主函数<br><img src="https://img-blog.csdnimg.cn/20210602111549876.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>大致是这样，我们依次看一下<br>函数<code>sub_4110FF()</code><br><img src="https://img-blog.csdnimg.cn/2021060211165982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>输出部分：函数<code>sub_411190()</code><br><img src="https://img-blog.csdnimg.cn/20210602112248690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后着重看一下两个线程的处理<br>线程1：<code>StartAddress</code><br><img src="https://img-blog.csdnimg.cn/20210602111914328.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看函数<code>sub_41112C</code>，函数<code>sub_411940</code><br>这里会出现报错，函数<code>sub_411940</code>无法反编译<br><img src="https://img-blog.csdnimg.cn/20210602151817781.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>是由于堆栈不平衡的问题，一般是程序有一些干扰代码，让IDA的反汇编分析出现错误。比如用push + n条指令 + retn来跳转。搜索这个函数，看汇编窗口：<br><img src="https://img-blog.csdnimg.cn/202106021518528.png" alt="在这里插入图片描述"><br>Option-&gt;General-&gt;Disassembly, 将选项Stack pointer打钩<br><img src="https://img-blog.csdnimg.cn/2021060211304858.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后就可以看见汇编窗口汇编指令前面有绿色的SP值<br><img src="https://img-blog.csdnimg.cn/20210602151920853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>找到这串函数的retn指令<br><img src="https://img-blog.csdnimg.cn/20210602151934509.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以发现前面的SP值变成了负数，我们需要修改它成0使得堆栈保持平衡。<br>找到距离retn最近的call指令<br><img src="https://img-blog.csdnimg.cn/20210602152051279.png" alt="在这里插入图片描述"><br>alt+k修改SP值<br><img src="https://img-blog.csdnimg.cn/20210602152114111.png" alt="在这里插入图片描述"><br>修改之后<br><img src="https://img-blog.csdnimg.cn/20210602152139797.png" alt="在这里插入图片描述"><br>然后就可以可以查看<br><img src="https://img-blog.csdnimg.cn/20210602112142582.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>线程2：函数<code>sub_41119F()</code><br><img src="https://img-blog.csdnimg.cn/20210602144619341.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>线程2并不对代码做任何处理，只是调用一次Sleep然后释放线程。</p><p>这里说一个细节，这道题是线程1和线程2 交替执行的，因为函数<code>CreateMutex()</code><br><img src="https://img-blog.csdnimg.cn/20210602145638478.png" alt="在这里插入图片描述"><br>这个函数是创建两个相互排斥的线程的函数，hobject 可以理解为一个“锁”，两个线程依次获取锁(waitforsingleobject)，释放锁(releasemutex)。一个线程开始之后，抢占了锁，这时候另一个线程没抢到，处于等待状态，等待运行线程执行完成之后第一个线程解锁。<br>不能用来控制两个以上的线程，因为剩下的几个线程都有几率抢到，会导致程序逻辑混乱。<br>两个线程时候，第一次抢到锁的线程在释放后也会和第二个线程抢锁，但是由于它此时没有第二个线程快，所以抢不到，就造成了两个线程交替被调用的现状。</p><p>所以这题就是奇数的会被线程1处理而偶数走线程2 不处理（因为是从29往下减的）</p><p>写脚本</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> off1[] = <span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> off2[] = <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">30</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">28</span>;i&gt;<span class="number">-1</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            flag[i] = off1[i];</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">52</span>;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(off1[i] == off2[j])</span><br><span class="line">            &#123;</span><br><span class="line">                flag[i] = j+<span class="number">38</span>;</span><br><span class="line">                <span class="keyword">if</span>(!(flag[i]&gt;=<span class="number">65</span> &amp;&amp;flag[i]&lt;=<span class="number">90</span>))</span><br><span class="line">                    flag[i] = j+<span class="number">96</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210602151002491.png" alt="在这里插入图片描述"><br>这里还有一个问题，就是最后输出flag的函数，它显示的是比较i&lt;29<br>而实际上进程处理的时候是到&gt;-1的，也就是其实应该是30个字符<br>也就是说少了一位我们不知道，需要一个个英文字母试出来，发现是“E”</p><p>flag：flag{ThisisthreadofwindowshahaIsESE}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>刮开有奖-[GXYCTF2019]luck_guy-findit-简单注册机-[BJDCTF2020]JustRE</title>
    <link href="http://example.com/2021/06/01/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96-[GXYCTF2019]luck_guy-findit-%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E6%9C%BA-[BJDCTF2020]JustRE/"/>
    <id>http://example.com/2021/06/01/%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96-[GXYCTF2019]luck_guy-findit-%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E6%9C%BA-[BJDCTF2020]JustRE/</id>
    <published>2021-05-31T16:45:41.456Z</published>
    <updated>2021-05-31T16:47:47.432Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape></p><p>@<a href="BUUCTF">TOC</a></p><h2 id="刮开有奖"><a href="#刮开有奖" class="headerlink" title="刮开有奖"></a>刮开有奖</h2><p>运行发现有点劣质的刮奖卡片的感觉<br><img src="https://img-blog.csdnimg.cn/2021042519504377.png" alt="在这里插入图片描述"><br>查壳无壳32位ida打开<br>ctrl+F搜索主函数只看到这个<br><img src="https://img-blog.csdnimg.cn/20210425195139979.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210425195159322.png" alt="在这里插入图片描述"><br>于是shift+F12查看字符串发现这个<br><img src="https://img-blog.csdnimg.cn/20210425195237517.png" alt="在这里插入图片描述"><br>双击过去交叉引用发现是函数<code>DialogFunc</code>刚好对应主函数里调用的函数完美<br><img src="https://img-blog.csdnimg.cn/20210425200156569.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最后有个判断然后得出结果，所以看一下v7之类的是什么<br><img src="https://img-blog.csdnimg.cn/20210425200302378.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以知道输入的String是8个字符，然后v7-v17经过了函数<code>sub_4010F0</code>的处理<br>看一下这个函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">sub_4010F0</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  result = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">4</span> * i;</span><br><span class="line">    v6 = *(_DWORD *)(<span class="number">4</span> * i + a1);</span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; *(_DWORD *)(a1 + <span class="number">4</span> * result) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          *(_DWORD *)(v5 + a1) = *(_DWORD *)(a1 + <span class="number">4</span> * result);</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( *(_DWORD *)(a1 + <span class="number">4</span> * i) &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( ++i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = <span class="number">4</span> * i;</span><br><span class="line">          *(_DWORD *)(a1 + <span class="number">4</span> * result) = *(_DWORD *)(<span class="number">4</span> * i + a1);</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4</span> * result) = v6;</span><br><span class="line">    sub_4010F0(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = a3;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参数齐全很清晰，可以改一下数组然后用C语言跑出来</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> v7[<span class="number">11</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_4010F0</span><span class="params">(<span class="keyword">int</span> a1[], <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span>;</span><br><span class="line">v7[<span class="number">0</span>] = <span class="number">90</span>;</span><br><span class="line">v7[<span class="number">1</span>] = <span class="number">74</span>;</span><br><span class="line">v7[<span class="number">2</span>] = <span class="number">83</span>;</span><br><span class="line">v7[<span class="number">3</span>] = <span class="number">69</span>;</span><br><span class="line">v7[<span class="number">4</span>] = <span class="number">67</span>;</span><br><span class="line">v7[<span class="number">5</span>] = <span class="number">97</span>;</span><br><span class="line">v7[<span class="number">6</span>] = <span class="number">78</span>;</span><br><span class="line">v7[<span class="number">7</span>] = <span class="number">72</span>;</span><br><span class="line">v7[<span class="number">8</span>] = <span class="number">51</span>;</span><br><span class="line">v7[<span class="number">9</span>] = <span class="number">110</span>;</span><br><span class="line">v7[<span class="number">10</span>] = <span class="number">103</span>;</span><br><span class="line">sub_4010F0(v7, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">11</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,v7[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">sub_4010F0</span><span class="params">(<span class="keyword">int</span> a1[], <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line"><span class="keyword">int</span> i; <span class="comment">// esi</span></span><br><span class="line"><span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line"><span class="keyword">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">result = a3;                                  <span class="comment">// result = 10</span></span><br><span class="line"><span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )               <span class="comment">// i=0;i&lt;=10;a2=i</span></span><br><span class="line">&#123;</span><br><span class="line">v5 = i;</span><br><span class="line">v6 = a1[i];                                 <span class="comment">// 遍历a1对应地址的元素</span></span><br><span class="line"><span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )            <span class="comment">// a2&lt;10  并且 i&lt;10</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> ( v6 &gt; a1[result] )                  <span class="comment">// 如果a1[i] &gt; a1[result]</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line"><span class="keyword">break</span>;                              <span class="comment">// 如果i&gt;=result则退出循环</span></span><br><span class="line">++i;                                  <span class="comment">// 给i+1</span></span><br><span class="line">a1[v5] = a1[result];                  <span class="comment">// 让a1[1] = a1[result]</span></span><br><span class="line"><span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line"><span class="keyword">break</span>;                              <span class="comment">// 如果i&gt;=result则退出循环           重复</span></span><br><span class="line"><span class="keyword">while</span> ( a1[i] &lt;= v6 )                 <span class="comment">// 当a1[i] &lt;= v6           此循环一定成立</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> ( ++i &gt;= result )                <span class="comment">// 如果i = result - 1</span></span><br><span class="line"><span class="keyword">goto</span> LABEL_13;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">v5 = i;</span><br><span class="line">a1[result] = a1[i];</span><br><span class="line">&#125;</span><br><span class="line">--result;                               <span class="comment">// result减一</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">&#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">a1[result] = v6;                            <span class="comment">// 让a1[result] = 之前的a1[i]</span></span><br><span class="line">sub_4010F0(a1, a2, i - <span class="number">1</span>);                  <span class="comment">// 进行递归……</span></span><br><span class="line">result = a3;</span><br><span class="line">++i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：<br><img src="https://img-blog.csdnimg.cn/20210425215727658.png" alt="在这里插入图片描述"><br>可以使用Python改成字符</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">51</span>,<span class="number">67</span>,<span class="number">69</span>,<span class="number">72</span>,<span class="number">74</span>,<span class="number">78</span>,<span class="number">83</span>,<span class="number">90</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">110</span>]</span><br><span class="line">x = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(arr)):</span><br><span class="line">    x+=<span class="built_in">chr</span>(arr[i])</span><br><span class="line">print(x)</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210425215909303.png" alt="在这里插入图片描述"></p><p>这就是新的v7到v17的值3CEHJNSZagn<br>我们回到函数<code>DialogFunc</code>，接着往后面看<br><img src="https://img-blog.csdnimg.cn/20210425212444160.png" alt="在这里插入图片描述"><br>双击v23，v25之类的发现都会跳到这里<br><img src="https://img-blog.csdnimg.cn/20210425212517468.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可知v23为string[5],快捷键N依次修改<br><img src="https://img-blog.csdnimg.cn/20210425212843443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>后面的if判断有v4,v5，这里可以看到v4,v5经过了函数sub_4010001的处理，分析sub_401000函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a1 为 v26的地址   a2 为 v26的长度</span></span><br><span class="line"><span class="function">_BYTE *__cdecl <span class="title">sub_401000</span><span class="params">(<span class="keyword">int</span> *a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">size_t</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  _BYTE *v5; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v8; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v10; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v12; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v13; <span class="comment">// esi</span></span><br><span class="line">  _BYTE *result; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v15; <span class="comment">// [esp+Ch] [ebp-10h]</span></span><br><span class="line">  _BYTE *v16; <span class="comment">// [esp+10h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// [esp+14h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v18[<span class="number">4</span>]; <span class="comment">// [esp+18h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = a2 / <span class="number">3</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 % <span class="number">3</span> &gt; <span class="number">0</span> )</span><br><span class="line">    ++v2;</span><br><span class="line">  v4 = <span class="number">4</span> * v2 + <span class="number">1</span>;                              <span class="comment">// v4为长度</span></span><br><span class="line">                                                <span class="comment">// </span></span><br><span class="line">                                                <span class="comment">// 当进行编码的数据长度是3的倍数时，len=strlen(str_in)/3*4;</span></span><br><span class="line">                                                <span class="comment">// 当进行编码的数据长度不是3的倍数时，len=(strlen(str_in)/3+1)*4;</span></span><br><span class="line">                                                <span class="comment">// 为Base64加密</span></span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v4);</span><br><span class="line">  v6 = v5;                                      <span class="comment">// v6指向分配的动态内存空间</span></span><br><span class="line">  v15 = v5;                                     <span class="comment">// v15指向分配的动态内存空间</span></span><br><span class="line">  <span class="keyword">if</span> ( !v5 )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);                                    <span class="comment">// 动态分配内存失败，退出</span></span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, v4);                            <span class="comment">// 给分配的v5清零</span></span><br><span class="line">  v7 = a2;</span><br><span class="line">  v8 = v6;                                      <span class="comment">// v8指向分配的动态内存空间</span></span><br><span class="line">  v16 = v6;                                     <span class="comment">// v16指向分配的动态内存空间</span></span><br><span class="line">  <span class="keyword">if</span> ( a2 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = <span class="number">0</span>;</span><br><span class="line">      v10 = <span class="number">0</span>;</span><br><span class="line">      v18[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 &gt;= v7 )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        ++v10;</span><br><span class="line">        v9 = *(a1 + v3++) | (v9 &lt;&lt; <span class="number">8</span>);          <span class="comment">// 将v9左移8位，然后与v9各个位二进制求或</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v10 &lt; <span class="number">3</span> );</span><br><span class="line">      v11 = v9 &lt;&lt; <span class="number">8</span> * (<span class="number">3</span> - v10);                <span class="comment">// v9向左移8的倍数位</span></span><br><span class="line">      v12 = <span class="number">0</span>;</span><br><span class="line">      v17 = v3;</span><br><span class="line">      v13 = <span class="number">18</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v10 &gt;= v12 )</span><br><span class="line">        &#123;</span><br><span class="line">          *(v18 + v12) = (v11 &gt;&gt; v13) &amp; <span class="number">63</span>;</span><br><span class="line">          v8 = v16;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          *(v18 + v12) = <span class="number">64</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        *v8++ = byte_407830[*(v18 + v12)];      </span><br><span class="line">        v13 -= <span class="number">6</span>;</span><br><span class="line">        ++v12;</span><br><span class="line">        v16 = v8;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v13 &gt; <span class="number">-6</span> );</span><br><span class="line">      v3 = v17;</span><br><span class="line">      <span class="keyword">if</span> ( v17 &gt;= a2 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v7 = a2;</span><br><span class="line">    &#125;</span><br><span class="line">    v6 = v15;</span><br><span class="line">  &#125;</span><br><span class="line">  result = v6;</span><br><span class="line">  *v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再看<code>byte_407830</code>的值，刚好是<br><img src="https://img-blog.csdnimg.cn/2021042521403835.png" alt="在这里插入图片描述"><br>符合base64加密规律<br>所以将<br><img src="https://img-blog.csdnimg.cn/20210425214151765.png" alt="在这里插入图片描述"><br>base64解密为jMp和WP1</p><p>再推上面的<br><img src="https://img-blog.csdnimg.cn/20210425220227763.png" alt="在这里插入图片描述"><br>而且是8位<br>所以对比可知道string = “UJWP1jMp”</p><p>flag:flag{UJWP1jMp}</p><h2 id="GXYCTF2019-luck-guy"><a href="#GXYCTF2019-luck-guy" class="headerlink" title="[GXYCTF2019]luck_guy"></a>[GXYCTF2019]luck_guy</h2><p><img src="https://img-blog.csdnimg.cn/20210531111612465.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida64<br><img src="https://img-blog.csdnimg.cn/20210531112946880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将用户输入的字符串存到v4中，然后作为函数<code>patch_me()</code>的参数<br><img src="https://img-blog.csdnimg.cn/20210531113032560.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看函数<code>get_flag()</code><br><img src="https://img-blog.csdnimg.cn/20210531113940831.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>取0~199的随机数，<code>case1 case4 case5</code>才是有效路径，并且需要按照一定顺序才能得出结果。<br>根据判断顺序应该为<code>case4 case5 case1</code><br>flag是由f1和f2拼接而成，f1已知，f2在case4中，但是f2形式不太对，观察case5的代码，是对长度为8的字符串进行操作，f2（0x7F666F6067756369两位一划分）的长度正好也是8，猜测用来与f1进行拼接形成flag的字符串是f2进行了case5操作后的数据。<br>分一下f2，再考虑小端序存储，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f2=[<span class="number">0x7F</span>,<span class="number">0x66</span>,<span class="number">0x6F</span>,<span class="number">0x60</span>,<span class="number">0x67</span>,<span class="number">0x75</span>,<span class="number">0x63</span>,<span class="number">0x69</span>][::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>写脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag=<span class="string">&quot;GXY&#123;do_not_&quot;</span></span><br><span class="line">f2=[<span class="number">0x7F</span>,<span class="number">0x66</span>,<span class="number">0x6F</span>,<span class="number">0x60</span>,<span class="number">0x67</span>,<span class="number">0x75</span>,<span class="number">0x63</span>,<span class="number">0x69</span>][::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> j%<span class="number">2</span>==<span class="number">1</span> :</span><br><span class="line">        s=<span class="built_in">chr</span>(f2[j]-<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s=<span class="built_in">chr</span>(f2[j]-<span class="number">1</span>)</span><br><span class="line">    flag+=s</span><br><span class="line"><span class="built_in">print</span> (flag)</span><br></pre></td></tr></table></figure><p>解出来是GXY{do_not_hate_me}</p><p>由于题目要求，所以最后的flag是：flag{do_not_hate_me}</p><h2 id="findit"><a href="#findit" class="headerlink" title="findit"></a>findit</h2><p>题目叙述的有点好笑，看题<br><img src="https://img-blog.csdnimg.cn/20210531115637603.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>APK逆向，上JEB，看主函数有一段可疑的字符串<br><img src="https://img-blog.csdnimg.cn/20210601003422962.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>第五个数据是“{”的asscii，最后一个是“}”的ascii，所以这串数据很可能和flag有关，用脚本跑出字符串。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a=[ <span class="number">0x70</span>,<span class="number">0x76</span>,<span class="number">0x6B</span>,<span class="number">0x71</span>,<span class="number">0x7B</span>,<span class="number">0x6D</span>,<span class="number">0x31</span>,</span><br><span class="line">    <span class="number">0x36</span>,<span class="number">0x34</span>,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x35</span>,<span class="number">0x32</span>,<span class="number">0x36</span>,</span><br><span class="line">    <span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0x33</span>,<span class="number">0x33</span>,<span class="number">0x6C</span>,<span class="number">0x34</span>,<span class="number">0x6D</span>,</span><br><span class="line">    <span class="number">0x34</span>,<span class="number">0x39</span>,<span class="number">0x6C</span>,<span class="number">0x6E</span>,<span class="number">0x70</span>,<span class="number">0x37</span>,<span class="number">0x70</span>,</span><br><span class="line">    <span class="number">0x39</span>,<span class="number">0x6D</span>,<span class="number">0x6E</span>,<span class="number">0x6B</span>,<span class="number">0x32</span>,<span class="number">0x38</span>,<span class="number">0x6B</span>,</span><br><span class="line">    <span class="number">0x37</span>,<span class="number">0x35</span>,<span class="number">0x7D</span>]</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    s+=<span class="built_in">chr</span>(i)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure><p>pvkq{m164675262033l4m49lnp7p9mnk28k75}</p><p>跑出来是上面这个，观察一下特别像凯撒<br>f-&gt;p 10位 后面都是flag移动10位是pvkq<br>使用在线工具移动一下</p><p>flag{c164675262033b4c49bdf7f9cda28a75}</p><h2 id="简单注册机"><a href="#简单注册机" class="headerlink" title="简单注册机"></a>简单注册机</h2><p>APK逆向，上JEB<br><img src="https://img-blog.csdnimg.cn/20210531234858642.png" alt="在这里插入图片描述"><br>tab键反编译，核心代码为这一部分<br><img src="https://img-blog.csdnimg.cn/20210531234938327.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>按照JAVA代码写Python脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=[<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;5&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">str</span>[<span class="number">2</span>]=<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">2</span>])+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">3</span>])-<span class="number">50</span>)</span><br><span class="line"><span class="built_in">str</span>[<span class="number">4</span>]=<span class="built_in">chr</span>( <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">2</span>])+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">5</span>])-<span class="number">0x30</span> )</span><br><span class="line"><span class="built_in">str</span>[<span class="number">30</span>]=<span class="built_in">chr</span>( <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">0x1f</span>])+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">9</span>])-<span class="number">0x30</span>)</span><br><span class="line"><span class="built_in">str</span>[<span class="number">14</span>]=<span class="built_in">chr</span>( <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">27</span>])+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">28</span>])-<span class="number">97</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    x=<span class="built_in">str</span>[<span class="number">0x1f</span>-i]</span><br><span class="line">    <span class="built_in">str</span>[<span class="number">0x1f</span>-i]=<span class="built_in">str</span>[i]</span><br><span class="line">    <span class="built_in">str</span>[i]=x</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">    <span class="built_in">print</span> (i,end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531235056179.png" alt="在这里插入图片描述"><br>flag:flag{59acc538825054c7de4b26440c0999dd}</p><h2 id="BJDCTF2020-JustRE"><a href="#BJDCTF2020-JustRE" class="headerlink" title="[BJDCTF2020]JustRE"></a>[BJDCTF2020]JustRE</h2><p><img src="https://img-blog.csdnimg.cn/20210531235958674.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ida打开，搜素main函数价值不大，搜索字符串，发现一个类似flag的字符串<img src="https://img-blog.csdnimg.cn/20210601001354394.png" alt="在这里插入图片描述"><br>交叉引用过去看函数<br><img src="https://img-blog.csdnimg.cn/20210601001545326.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>第14行代码，sprintf补齐，查看<code>aBjdDD2069a4579</code><br><img src="https://img-blog.csdnimg.cn/20210601001701393.png" alt="在这里插入图片描述"><br>刚好补充19999 和 0<br>flag是：flag{1999902069a45792d233ac}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="BUUCTF" scheme="http://example.com/categories/BUUCTF/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>PE文件格式（一）</title>
    <link href="http://example.com/2021/04/24/PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>http://example.com/2021/04/24/PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%EF%BC%88%E4%B8%80%EF%BC%89/</id>
    <published>2021-04-24T08:39:29.579Z</published>
    <updated>2021-04-25T13:11:19.762Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>PE文件是Windows操作系统下使用的可执行文件格式<br>PE文件指的是32位的可执行文件，也称作PE32；64位的可执行文件称作PE+或PE32+<em>（注意不是PE64）</em>，这是PE文件的一种扩展形式。</p><p><strong>PE文件种类</strong><br>可执行系列：EXE、SCR<br>驱动程序系列：SYS、VXD<br>库系列：DLL、OCX、CPL、DRV<br>对象文件系列：OBJ</p><p>除了OBJ之外的文件都是可执行的，有些虽然不能直接在Shell（Explorer.exe)中运行，但是可以使用调试器等来运行。不过，根据PE文件规范，OBJ也是做是PE文件 （虽然它确实是文件本身不能以任何形式执行）。</p><p>由于文件运行的所以信息，诸如如何加载到内存，何处开始运行以及运行中需要的DLL和多大的堆栈内存等都以结构体的形式存储在PE头中，故而，<strong>学习PE文件格式就是学习PE头中的结构体。</strong></p><p><strong>PE文件基本结构</strong><br>从DOS头到节区头（Section header）是PE头部分，其下的节区合称PE体。</p><p>文件中使用偏移（offset），内存中使用虚拟地址（VA）来表示位置。</p><p>文件的内容一般可以分为代码（.text）、数据（.data）、资源（.rsrc）节，分别保存。各个节区头定义了各节区在文件或内存中的大小、位置、属性等等。</p><p>PE头与各节区的尾部存在NULL填充，因为文件/内存中节区的起始位置应该在各文件/内存最小单位的倍数位置上，空白区域将用NULL填充。<br><img src="https://img-blog.csdnimg.cn/20210406165312595.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>VA&amp;RVA</strong><br>VA指的是进程虚拟内存的绝对地址，RVA（相对虚拟地址）指的是从某个基准位置（ImageBase）开始的相对地址。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RVA+ImageBase&#x3D;VA</span><br></pre></td></tr></table></figure><p>PE头内部信息大多是以RVA形式存在，因为重定位的原因。</p><h2 id="PE头"><a href="#PE头" class="headerlink" title="PE头"></a>PE头</h2><h3 id="DOS头"><a href="#DOS头" class="headerlink" title="DOS头"></a>DOS头</h3><p>PE头的最前面添加了一个<code>IMAGE_DOS_HEADER</code>结构体，用来扩展已有的DOS EXE头<br><img src="https://img-blog.csdnimg.cn/20210407210655269.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>IMAGE_DOS_HEADER结构体的大小为40个字节，结构体中有两个重要成员<br><code>e_magic</code>:DOS签名（4D5A–&gt;ASCII值“MZ”）<br><code>e_lfanew</code>:指示NT头的偏移（根据不同文件拥有可变值）</p><p>我们把记事本拖进WinHEX看一看<br><img src="https://img-blog.csdnimg.cn/20210408170940179.png" alt="在这里插入图片描述"><br>64字节（共4行）的DOS头，第一个成员两个字节是可执行文件的标志信息；最后一个成员4字节是PE头的偏移地址为000000F8H，我们可以根据000000F8H来获取PE头的地址。<br>可见开头的e_magic：MZ，以及e_lfanew的值为000000F8（因为Intel系列的CPU以逆序存储数据，小端序）</p><p>这里说一下为什么MZ没有倒着读<br>再写PE文件查看器的时候，根据Windows的宏定义</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IMAGE_DOS_SIGNATURE = <span class="number">0x5A4D</span></span><br></pre></td></tr></table></figure><p>所以查看的时候自己倒过来了成了4D 5A，故而我们直接读MZ作为标志就行了</p><h3 id="DOS存根"><a href="#DOS存根" class="headerlink" title="DOS存根"></a>DOS存根</h3><p>DOS存根在DOS头下方，是个可选项，即使没有，文件也能够运行，它的大小不固定<br><img src="https://img-blog.csdnimg.cn/20210408212456672.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以利用DOSBOX运行这段-u查看汇编指令<br><img src="https://img-blog.csdnimg.cn/20210408212910478.png" alt="在这里插入图片描述"></p><h3 id="NT头"><a href="#NT头" class="headerlink" title="NT头"></a>NT头</h3><p>NT头IMAGE_NT_HEADERS<br><img src="https://img-blog.csdnimg.cn/20210408213526301.png" alt="在这里插入图片描述"><br>这个结构体由3个成员组成，第一个是签名，值为50450000H（“PE”00），另外两个分别是文件头和可选头<br><img src="https://img-blog.csdnimg.cn/20210408221120863.png" alt="在这里插入图片描述"><br>IMAGE_NT_HEADERS结构体大小为F8</p><h4 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h4><p>文件头是表现文件大致属性的IMAGE_FILE_HEADER结构体<br>它有4类重要成员，如果它们设置的不正确，将导致文件无法正常运行<br>包括PE头在内的24个字节</p><p><strong>Machine</strong><br>每个CPU都有唯一的Machine码，不同的表示可以运行在什么样的CPU上<br>兼容32位Intel  x86  的是14C x64:8664<br><a href="https://roov.org/2010/03/ia64-x86-64/">关于CPU型号的疑惑看这里</a><br><img src="https://img-blog.csdnimg.cn/20210408215212163.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408215222384.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>64位 winhex 打开如下图为 8664，即为 x64程序。<br><img src="https://img-blog.csdnimg.cn/20210422205731747.png" alt="在这里插入图片描述"><br><strong>NumberOfEsctions</strong><br>NumberOfEsctions指文件中存在的节区数量，也就是节表中的项数。该值一定要大于0，且当定义的节区数与实际不符时，将发生运行错误。</p><p>值为 0070，代表有 7 个节表<br><img src="https://img-blog.csdnimg.cn/20210422210107908.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>SizeOfOptionalHeader</strong><br>SizeOfOptionalHeader用来指出<code>IMAGE_OPTIONAL_HEADER32</code>结构体的长度。PE装载器需要查看SizeOfOptionalHeader的值，从而识别<code>IMAGE_OPTIONAL_HEADER32</code>结构体的大小。<br>PE32+格式文件中使用的是<code>IMAGE_OPTIONAL_HEADER64</code>结构体，这两个结构体尺寸是不相同的，所以需要在SizeOfOptionalHeader中指明大小。<br>借助DOS头中的e_lfanew和文件头中的SizeOfOptionalHeader可以创建一种脱离常规的PE文件（PE Patch）</p><p>00f0 ,即为64位程序。<br><img src="https://img-blog.csdnimg.cn/20210422210501808.png" alt="在这里插入图片描述"><br>若为32位，则是00E0<br><strong>Characteristics</strong><br>该段用于标识文件的属性，文件是否是可运行的状态，是否为DLL文件等信息。<br><img src="https://img-blog.csdnimg.cn/20210408220816511.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210408220833142.png" alt="在这里插入图片描述"><br><strong>TimeDateStamp</strong><br>这个成员不影响文件的运行，是用来记录编译器创建文件的时间的。</p><h4 id="可选头"><a href="#可选头" class="headerlink" title="可选头"></a>可选头</h4><p>IMAGE_OPTIONAL_HEADER32是PE头结构体中最大的<br>需要关注下列成员，这些值是文件运行必需的，设置错误将导致程序无法正常运行。<br>文件头往后224个字节（.text之前）<br>最后一个成员是16个结构体数组，每个宽度8字节<br><img src="https://img-blog.csdnimg.cn/20210424160851386.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>导入表的位置可以查看可选头的最后一个成员数组的第二个结构体（JIMAGE_OPTIONAL_HEADER32.DataDirectory[1]）（都是小端序的）</p><p>导出表的位置可以查看可选头的最后一个成员数组的第一个结构体（JIMAGE_OPTIONAL_HEADER32.DataDirectory[0]）（都是小端序的）<br><img src="https://img-blog.csdnimg.cn/20210425210305589.png" alt="在这里插入图片描述"></p><p>这里给一个示例，红色前面是导入表RVA，后面是导入表大小，蓝色表示导出表同理。此处是用WinHex打开的，只是做一个演示，由于WinHex显示的是文件偏移地址，所以上面的数值并不代表RVA</p><p>exe文件往往没有导出表</p><p>我们查看导入导出表以及后面所讲到的IAT可以使用PEiD等工具，非常方便<br><img src="https://img-blog.csdnimg.cn/2021042521085882.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>顺便普及一个知识点：<br>文件偏移地址是指数据在PE文件中的地址，是文件在磁盘上存放时相对于文件开头的偏移。文件偏移地址从pe文件的第一个字节开始计数，起始值为0。用十六进制工具（如WINHEX）打开文件所显示的地址就是文件偏移地址。</p><p>IDA Pro虽然是静态反汇编工具，不过出来的是VA。</p><p>装载基址（Image Base）：PE文件装入内存的 基地址。默认情况下，EXE文件的基址为0x00400000，DLL文件的基址为0x10000000。</p><p>虚拟内存地址（VA）：PE文件中的指令被装入内存后的地址，OllyDbg动态反汇编产生。</p><p>相对虚拟地址（RVA）：内存地址相对与映射基址的偏移量。</p><p><strong>Magic</strong><br>为IMAGE_OPTIONAL_HEADER32时，magic码为10B，为IMAGE_OPTIONAL_HEADER64时，magic码为20B</p><p><strong>AddressOfEntryPoint</strong><br>AddressOfEntryPoint持有EP的RVA值。该值指出程序最先执行的代码起始地址。</p><p><strong>ImageBase</strong><br>一般来说，使用开发工具创建好EXE文件后，其ImageBase值为00400000，DLL文件的ImageBase值为10000000（也可以指定其他值）。<br>执行PE文件时，PE装载器先创建进程，再将文件载入内存，然后把EIP寄存器的值设置为ImageBase+AddressOfEntryPoint</p><p><strong>SectionAlignment，FileAlignment</strong><br>PE文件的Body部分被划分成若干节段，这些节段储存着不同类别的数据。<br>FileAlignment指定了节区在磁盘文件中的最小单位，而SectionAlignment则指定了节区在内存中的最小单位（SectionAlignment必须大于或者等于FileAlignment）<br>磁盘文件或者内存的节区带下必定是FileAlignment或SectionAlignment值的整数倍。</p><p><strong>SizeOfImage</strong><br>当PE文件加载到内存时，SizeOfImage指定了PE Image在虚拟内存中所占用的空间大小，一般文件大小与加载到内存中的大小是不同的（节段头中定义了各节装载的位置与占有内存的大小）</p><p><strong>SizeOfHeader</strong><br>SizeOfHeader用来指出整个PE头大小。该值必须是FileAlignment的整数倍。第一节段所在位置与SizeOfHeader距文件开始偏移的量相同。</p><p><strong>Subsystem</strong><br>用来区分系统驱动文件<code>（*.sys）</code>与普通的可执行文件<code>(*.exe,*.dll)</code><br><img src="https://img-blog.csdnimg.cn/20210420102314423.png" alt="在这里插入图片描述"><br><strong>NumberOfRvaAndSizes</strong><br>NumberOfRvaAndSizes用来指定DataDirectory( IMAGE_OPTIONAL_HEADER32结构体的最后一个成员）数组的个数。</p><p><strong>DataDirectory</strong><br>DataDirectory是由IMAGE_DATA_DIRECTORY结构体组成的数组，数组的每项都有被定义的值。将Directory想成某个结构体数组即可。重点关注EXPORT/IMPORT/RESOURCE、TLS Direction。特别需要注意的是IMPORT与EXPORT Directory，它们是PE头中非常重要的部分</p><h3 id="节区头"><a href="#节区头" class="headerlink" title="节区头"></a>节区头</h3><p>节区头中定义了各个节区的属性，PE文件中的code(代码)、data(数据)、resource(资源）等按照属性分类存储在不同节区。把PE文件创建成多个节区结构的好处是，这样可以保证程序的安全性。若把code与data放在一个节区中相互纠缠很容易引发安全问题。</p><p>节区头是由<code>IMAGE_SECTION_HEADER</code>结构体组成的数组，每个结构体对应一个节区。<br><img src="https://img-blog.csdnimg.cn/20210420104158828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>IMAGE_SECTION_HEADER结构体的重要成员项目</strong><br>virtualSize 内存中节区所占大小<br>VirtualAddress  内存中节区起始地址(RVA)<br>SizcOfRawData  磁盘文件中节区所占大小<br>PointerToRawData  磁盘文件中节区起始位置<br>Charateristics  节区属性(bit OR)</p><p><strong>Name字段：</strong><br>Name成员不像C语言中的字符串一样以NULL结束，并且没有“必须使用ASCII值”的限制。PE规范未明确规定节区的Name，所以可以向其中放入任何值，甚至可以填充NULL值。所以节区的Name仅供参考，不能保证其百分之百地被用作某种信息（数据节区的名称也可叫做.code )。</p><p><strong>映像( Image）：</strong><br>PE文件加载到内存时，文件不会原封不动地加载，而要根据节区头中定义的节区起始地址、节区大小等加载。因此，磁盘文件中的PE与内存中的PE具有不同形态。故而将装载到内存中的形态称为“映像”。<br><img src="https://img-blog.csdnimg.cn/20210422205442410.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>我们可以在WINHEX里面看各个节区头数组，每个大小40字节<br><img src="https://img-blog.csdnimg.cn/20210422205239614.png" alt="在这里插入图片描述"></p><h2 id="RVA-to-RAW（FOA"><a href="#RVA-to-RAW（FOA" class="headerlink" title="RVA to RAW（FOA)"></a>RVA to RAW（FOA)</h2><p>RAW ADRRESS，或者FILE OSSFET ADRRESS，一般称文件偏移</p><p>完成从内存地址到文件偏移之间的映射称为RVA to RAW</p><p>RVA+ImageBase=VA</p><p>计算方法：<br>1.判断 RVA 是否位于 PE 头，如果是 FOA=RVA,</p><p>2.判断 RVA 位于哪个节<br>RVA &gt;= 节.VirtualAddress<br>RVA &lt;= 节.VirtualAddress + 当前内存对齐后的大小</p><p>3.FOA = RVA - 节.VirtualAddress +节.PointerToRawData </p><p>示例题目：<br><img src="https://img-blog.csdnimg.cn/20210420161828101.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210420161856257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="IAT（导入地址表）"><a href="#IAT（导入地址表）" class="headerlink" title="IAT（导入地址表）"></a>IAT（导入地址表）</h2><p>IAT是一种表格，用来记录程序正在使用哪些库中的函数<br>注意：导入地址表和导入表是两个东西，导出地址表和导出表也是。</p><h3 id="DLL（动态链接库）"><a href="#DLL（动态链接库）" class="headerlink" title="DLL（动态链接库）"></a>DLL（动态链接库）</h3><ul><li>不要把库包含到程序中，单独组成DLL文件，需要时调用即可。</li><li> 内存映射技术使加载后的DLL代码、资源在多个进程中实现共享。</li><li>更新库时只要替换相关DLL文件即可，简便易行。</li></ul><p><strong>加载DLL的方式:</strong><br>“显式链接”(Explicit Linking )，程序使用DLL时加载，使用完毕后释放内存;<br>“隐式链接”( Implicit Linking )，程序开始时即一同加载DLL，程序终止时再释放占用的内存。<br>IAT提供的机制即与隐式链接有关。</p><p><strong>DLL重定位：</strong><br>DLL文件的ImageBase值一般为10000000。比如某个程序使用a.dll与b.dll时，PE装载器先把a.dll装载到内存的10000000( ImageBase)处，然后尝试把b.dl也装载到该处。但是由于该地址处已经装载了a.dl，所以PE装载器查找其他空白的内存空间（ ex:3EO00000 )，然后将b.dll装载进去。这就构成了DLL重定位，它使我们不能对实际地址硬编码<br><em>注：实际操作中无法保证DLL一定会被加载到PE头内指定的ImageBase处。但是EXE文件（生成进程的主体）却能准确加载到自身的ImageBase 中，因为它拥有自己的虚拟空间。</em></p><h3 id="IMAGE-IMPORT-DESCRIPTOR"><a href="#IMAGE-IMPORT-DESCRIPTOR" class="headerlink" title="IMAGE_IMPORT_DESCRIPTOR"></a>IMAGE_IMPORT_DESCRIPTOR</h3><p>该结构体记录着PE文件要导入的库文件，它在PE体中，但是查找它的位置的信息在PE头中。<br>执行一个普通程序往往需要导入许多库，导入多少库就存在多少个IMAGE_IMPORT_DESCRIPTOR结构体，这些结构体形成了数组，且最后以NULL结构体结束。<br>20字节，一个union相当于是一个<br><img src="https://img-blog.csdnimg.cn/20210420172736904.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>其中比较重要的成员有：<br>OriginalFirstThunk   INT的地址(RVA)<br>Name   库名称字符串的地址（RVA)<br>FirstThunk   IAT的地址（RVA)</p><p>INT是一个包含导入函数信息（ Ordinal，Name)的结构体指针数组。</p><p>INT与IAT的大小应该相同，都是长整型（4个字节数据类型），以NULL结束</p><h2 id="EAT（导出地址表）"><a href="#EAT（导出地址表）" class="headerlink" title="EAT（导出地址表）"></a>EAT（导出地址表）</h2><p>EAT可以用来求取相应库中导出函数的起始地址的。它记录了导出符号的地址,名称,与序号 (提示:exe文件中很少有导出表的，大多数dll都有导出表，某些存放资源文件的dll就没有导出表)通过结构体IMAGE_EXPORT_DIRECTORY<br><img src="https://img-blog.csdnimg.cn/2021042416142992.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>IMAGE_EXPORT_DIRECTORY中的重要成员（地址都是RVA）<br><img src="https://img-blog.csdnimg.cn/20210422201929436.png" alt="在这里插入图片描述"><br>附：从库中获得函数地址的API为GetProcAddress()函数，这个API函数引用EAT来获取指定API的地址。</p><p><strong>GetProcAddress()操作原理：</strong><br>(1)利用AddressOfNames成员转到“函数名称数组”。<br>(2)“函数名称数组”中存储着字符串地址。通过比较（ strcmp）字符串，查找指定的函数名称（此时数组的索引称为name_index )。<br>(3)利用AddressOfNameOrdinals成员，转到orinal数组。(4)在ordinal数组中通过name_index查找相应ordinal值。<br>(5)利用AddressOfFunctions成员转到“函数地址数组”(EAT )。<br>(6)在“函数地址数组”中将刚刚求得的ordinal用作数组索引，获得指定函数的起始地址。</p><p>一般导出函数均有相应名称，AddressOfNameOrdinals数组的值以index=ordinal的形式存在。但并不是所有的DLL文件都如此。导出函数中也有一些函数没有名称（仅通过ordinal导出)，AddressOfNameOrdinals数组的值为index!=ordinal。所以只有按照上面的顺序才能获得准确的函数地址。</p><p>对于没有函数名称的导出函数，可以通过Ordinal查找到它们的地址。从 Ordinal值中减去IMAGE_EXPORT_DIRECTORY.Base成员后得到一个值，使用该值作为“函敖地址数组”的索引。即可查找到相应函数的地址。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>PE规范只是一个标准，文件符合PE规范就是PE文件，有一额很有创意不符合常规的PE文件，我们称之为Patched PE，这也是PE文件，且在逆向当中很重要。总之，多学多练很重要，愿与诸君共勉！！</p><p>参考资料：<br>《逆向工程核心原理》<br><a href="https://www.bilibili.com/video/BV18r4y1K7sa?p=1">https://www.bilibili.com/video/BV18r4y1K7sa?p=1</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="逆向学习笔记" scheme="http://example.com/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>虎符杯-逆向-redemption_code</title>
    <link href="http://example.com/2021/04/06/%E8%99%8E%E7%AC%A6%E6%9D%AF-%E9%80%86%E5%90%91-redemption_code/"/>
    <id>http://example.com/2021/04/06/%E8%99%8E%E7%AC%A6%E6%9D%AF-%E9%80%86%E5%90%91-redemption_code/</id>
    <published>2021-04-06T07:52:29.315Z</published>
    <updated>2021-07-21T12:41:21.887Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape><br>早上洗了一早上衣服突然想起虎符杯的事情，匆匆开了电脑啥也没解出来，对着大佬的WP复现。<br>S1lenc3师傅带带我~~</p><p>无壳，32位<br>MIPS的，使用ida7.5打开<br>ctrl+f搜索main，跳转到主函数F5反编译查看<br><img src="https://img-blog.csdnimg.cn/20210406145321730.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">这有个判断函数，后面v10等于7有提到flag<br>看看函数<code>server_check_redemption_code()</code><br><img src="https://img-blog.csdnimg.cn/20210406145548354.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最后写着<code>return k - v10 + 1;</code><br>那说明v10(新）==k - v10（旧） + 1;<br>v10（新）==7已经知道，现在需要找的是v10（旧）和k<br>还是看函数<code>server_check_redemption_code()</code><br>跟着v10发现v10=v3,v3又是a2的长度，a2来自传参<br><img src="https://img-blog.csdnimg.cn/2021040615042647.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>回到main函数看<br>a2对应的是v14，v14来自v11,v11又经过了<code>pre()</code>函数的处理<br>看看<code>pre();</code><br><img src="https://img-blog.csdnimg.cn/20210406151905296.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>有一个判断，输入的字符串长度为0xE（14），然后v10和a1有关，，所以知道v10（旧）=14，那么k就是20了，然后发现又调用了函数<code>server_check_redemption_code()</code>，并且还写到了v9，所以可以知道取了字符串<code>Ninja Must Die 3 Is A Cruel Game, So Hard For Me</code>的前14位<br>也就是<code>Ninja Must Die</code><br>我们发现从main函数调用的函数<code>server_check_redemption_code()</code>还有一个v13没有看<br><img src="https://img-blog.csdnimg.cn/20210406153127783.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>顺着看过去发现了字符串<code>I Love Ninja Must Die 3. Beautiful Art And Motive Operation Is Creative.</code><br>作为a1传过去，发现最后有一个检查v7和a1的第二十位是不是一样的<br><img src="https://img-blog.csdnimg.cn/20210406154048244.png" alt="在这里插入图片描述"><br>发现字符串<code>I Love Ninja Must Die 3. Beautiful Art And Motive Operation Is Creative.</code>的第二十位和<code>Ninja Must Die</code>的第十四位都是e</p><p>所以 flag是：flag{Ninja Must Die}</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="比赛" scheme="http://example.com/categories/%E6%AF%94%E8%B5%9B/"/>
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>函数调用约定</title>
    <link href="http://example.com/2021/04/04/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A/"/>
    <id>http://example.com/2021/04/04/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A/</id>
    <published>2021-04-04T12:48:00.289Z</published>
    <updated>2021-04-04T12:49:40.501Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>函数调用约定:是对函数调用时如何传递参数的一种约定。</p><p>调用函数前要先把参数压入栈然后再传递给函数，栈就是定义在进程中的一段内存空间，    其大小被记录在PE头中，进程运行时确定栈内存的大小（与malloc/new动态分配内存不同）</p><p><strong>函数执行完成后，栈中的参数不用处理</strong><br>因为只是临时存储在栈中的值，清除会浪费CPU资源，直接下一次向栈中存入其他值自然覆盖就行了，而且栈的内存是固定的，所以不能也不用释放内存。</p><p><strong>函数执行完毕之后，ESP值如何变化？</strong><br>ESP的值要恢复到函数调用之前，这样可引用的栈大小才不会被缩减。如何处理ESP，就要用到函数调用约定。</p><p>调用者：调用函数的一方<br>被调用者：被调用的函数<br>例如，main函数中调用printf()函数，调用者为main（），被调用者为printf()。</p><h2 id="主要函数调用约定"><a href="#主要函数调用约定" class="headerlink" title="主要函数调用约定"></a>主要函数调用约定</h2><h3 id="cdecl"><a href="#cdecl" class="headerlink" title="cdecl"></a>cdecl</h3><p>调用者直接清理其压入栈的函数参数。主要在C语言中使用。</p><p>优点：可以向被调用函数传递长度可变的参数。这种长度可变的参数在其它调用约定中很难实现。</p><h3 id="stdcall"><a href="#stdcall" class="headerlink" title="stdcall"></a>stdcall</h3><p>常用于Win32 API,该方式由被调用者清理栈，C语言默认的函数调用方式为cdecl，若想要使用stdcall方式编译源码，只要使用_stdcall关键字就可以<br>示例代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> _stdcall <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (a+b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>优点：通过被调用者清理栈，和cdecl相比代码尺寸要小。</p><h3 id="fastcall"><a href="#fastcall" class="headerlink" title="fastcall"></a>fastcall</h3><p>与stdcall方式基本类似，但该方式通常会使用寄存器（而非栈内存）去传递需要传递给函数的部分参数（前2个），若某函数有4个参数，则前两个参数分别使用ECX、EDX寄存器传递<br>优点：速度快，实现对函数的快速调用<br>缺点：可能会增加系统开销，还可能需要备份ECX和EDX中的数据。</p><h3 id="三种调用约定对比图"><a href="#三种调用约定对比图" class="headerlink" title="三种调用约定对比图"></a>三种调用约定对比图</h3><p><img src="https://img-blog.csdnimg.cn/20210404113147470.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="逆向学习笔记" scheme="http://example.com/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>栈-栈帧</title>
    <link href="http://example.com/2021/04/04/%E6%A0%88-%E6%A0%88%E5%B8%A7/"/>
    <id>http://example.com/2021/04/04/%E6%A0%88-%E6%A0%88%E5%B8%A7/</id>
    <published>2021-04-04T02:40:40.947Z</published>
    <updated>2021-04-04T02:42:37.076Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h2 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h2><p>栈：一种由高地址向低地址扩展的数据结构<br><img src="https://img-blog.csdnimg.cn/20210404101239647.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>作用：<br>1.暂时保存函数内的局部变量<br>2.调用函数时传递参数<br>3.保存函数返回后的地址</p><p>先进后出原则<br>一个进程中，栈顶指针(ESP)初始状态指向栈底端，执行PUSH将数据压入栈，栈顶指针就会上移到栈顶端，若栈为空，则栈顶指针重新移动到栈底端。<br>EBP：存放栈底地址</p><p>向栈中压入数据时，栈顶指针减小，向低地址移动；弹出数据时，栈顶指针增加，向高地址移动。</p><h2 id="栈帧"><a href="#栈帧" class="headerlink" title="栈帧"></a>栈帧</h2><p>栈帧就是利用EBP（栈帧指针）寄存器访问栈内局部变量、参数、函数返回地址等的手段。</p><p>因为ESP的值一直在变化，使用ESP为基准很难指引CPU找到准确的地址，所以，先把用作基准点（函数起始地址）的ESP值保存到EBP，并维持在函数内部，这样可以很好的管理函数调用。</p><p>参数入栈的顺序和C语言源码中参数入栈的顺序是相反的，这叫做函数参数的逆向存储。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="逆向学习笔记" scheme="http://example.com/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>调试HELLO,WORLD-小端序标记法</title>
    <link href="http://example.com/2021/04/04/%E8%B0%83%E8%AF%95HELLO,WORLD-%E5%B0%8F%E7%AB%AF%E5%BA%8F%E6%A0%87%E8%AE%B0%E6%B3%95/"/>
    <id>http://example.com/2021/04/04/%E8%B0%83%E8%AF%95HELLO,WORLD-%E5%B0%8F%E7%AB%AF%E5%BA%8F%E6%A0%87%E8%AE%B0%E6%B3%95/</id>
    <published>2021-04-04T01:54:32.615Z</published>
    <updated>2021-04-04T02:42:15.292Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>逆向分析代码，一般先静态分析收集代码相关信息，通过收集到的信息推测程序的结构与行为机，然后动态。动静结合。</p><h2 id="调试hello，world"><a href="#调试hello，world" class="headerlink" title="调试hello，world"></a>调试hello，world</h2><p>我们需要编写一个可执行文件：hello.exe<br>如图，当在编译器中写好程序后（VS2010）<br><img src="https://img-blog.csdnimg.cn/20210404091251497.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">按照如图操作，relsease模式将.cpp文件生成.exe，然后点“生成”-&gt;”生成hello”即可，然后我们将这个程序拖进OD（注意不要将程序窗口关掉，最小化即可，否则会造成程序进程结束无法单步调试）<br><img src="https://img-blog.csdnimg.cn/20210404091350818.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210404091407876.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>调试器停止的地方为程序执行的起始地址即EP（Entry Point入口点）</p><h2 id="小端序标记法"><a href="#小端序标记法" class="headerlink" title="小端序标记法"></a>小端序标记法</h2><p>字节序：多字节数据在计算机内存中存储或网络传输时各字节的存储顺序。</p><p>分类：<br>大端序：内存地址低位存储数据的高位，内存地址高位存储数据的低位。<br>小端序：内存地址低位存储数据的低位，内存地址高位存储数据的高位。<br><img src="https://img-blog.csdnimg.cn/20210404093045241.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210404091909662.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210404095202260.png" alt="在这里插入图片描述"><br>数据为单一字节时，字节存储顺序不受影响，多字节数据会导致存储顺序不同，字符串被保存在一个字符数组中，字符数组在内存中是连续的，此时向字符数组存放数据，无论大端序还是小端序，存储顺序都相同。</p><p>应用：<br>大端序：UNIX服务器的RISC系列CPU、网络协议<br>小端序：X86CPU（Windows逆向分析必须掌握）</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="逆向学习笔记" scheme="http://example.com/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="逆向" scheme="http://example.com/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>Python-03improve</title>
    <link href="http://example.com/2021/04/01/Python-03improve/"/>
    <id>http://example.com/2021/04/01/Python-03improve/</id>
    <published>2021-04-01T13:45:29.585Z</published>
    <updated>2021-04-01T13:46:32.147Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><h3 id="模块（import）"><a href="#模块（import）" class="headerlink" title="模块（import）"></a>模块（import）</h3><p>利用模块可以更加方便的使用Python实现一些功能<br>a)自定义模块<br>在Pycharm中新建一个Python文件，注意给它的命名最好是英文，否则可能Pycharm不识别。<br>如图所示：新建了一个文件，在其中写下自定义模块的内容<br><img src="https://img-blog.csdnimg.cn/20210401212943284.png" alt="在这里插入图片描述"><br>作用为打招呼<br>然后再新建一个Python文件，这个命名好像没有要求了<br>在第二个文件中输入import + 模块名，例如<br><img src="https://img-blog.csdnimg.cn/20210401213011128.png" alt="在这里插入图片描述"><br>运行即可调用之前写的自定义模块<br><img src="https://img-blog.csdnimg.cn/20210401213037580.png" alt="在这里插入图片描述"><br>也可以进行更改<br><img src="https://img-blog.csdnimg.cn/20210401213058698.png" alt="在这里插入图片描述"><br>运行结果为<br><img src="https://img-blog.csdnimg.cn/20210401213128234.png" alt="在这里插入图片描述"><br>自定义模块和路径查找有关通过</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">print(sys.path)</span><br></pre></td></tr></table></figure><p> 可以看等等<br>b)第三方模块<br>安装：文件–设置–如图所示，点+号，搜索库<br><img src="https://img-blog.csdnimg.cn/20210401213227648.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210401213346162.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>安装，<br>即可看到<br><img src="https://img-blog.csdnimg.cn/20210401213410283.png" alt="在这里插入图片描述">安装成功<br>可能会遇到的问题：</p><ul><li>如，可能会发现没有pip，那么，如上下载pip就可以</li><li>如，可能会发现搜不到库，这是因为源的问题，可能是网络限制了，方法是在“Manage<br>Repositories”中，修改数据来源，默认的是“<a href="https://pypi.python.org/simple%E2%80%9D%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E5%B0%86%E5%85%B6%E6%9B%BF%E6%8D%A2%E4%B8%BA%E5%A6%82%E4%B8%8B%E7%9A%84%E5%87%A0%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90%EF%BC%8C%E8%BF%99%E4%BA%9B%E9%83%BD%E6%98%AF%E5%9B%BD%E5%86%85%E7%9A%84pip%E9%95%9C%E5%83%8F%EF%BC%9A">https://pypi.python.org/simple”，我们可将其替换为如下的几个数据来源，这些都是国内的pip镜像：</a></li></ul><p>清华：<a href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a><br>阿里：<a href="http://mirrors.aliyun.com/pypi/simple/">http://mirrors.aliyun.com/pypi/simple/</a><br>豆瓣：<a href="http://pypi.douban.com/simple/">http://pypi.douban.com/simple/</a><br>华中理工大学：<a href="http://pypi.hustunique.com/">http://pypi.hustunique.com/</a><br>山东理工大学：<a href="http://pypi.sdutlinux.org/">http://pypi.sdutlinux.org/</a><br>中国科学技术大学：<a href="http://pypi.mirrors.ustc.edu.cn/">http://pypi.mirrors.ustc.edu.cn/</a><br><img src="https://img-blog.csdnimg.cn/20210401213629700.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210401213643907.png" alt="在这里插入图片描述"><br>嗯…当然也许这样也不行，，我挂着校园网就下载不下来，得用实验室的网…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip -V     //在cmd中查看pip是否安装完成和版本</span><br></pre></td></tr></table></figure><p>如果出现了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;pip&#x27;</span> 不是内部或外部命令，也不是可运行的程序</span><br><span class="line">或批处理文件。</span><br></pre></td></tr></table></figure><p>则是因为没有配置环境，找到python目录下的Scripts文件夹，复制路径<br>在环境变量中添加<br><img src="https://img-blog.csdnimg.cn/20210401213750744.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后再查即可</p><ul><li>如，搜到了库但是安装不上，出现了如图所示的报错</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Try to run this command <span class="keyword">from</span> the system terminal. </span><br><span class="line">Make sure that you use the correct version of <span class="string">&#x27;pip&#x27;</span> installed <span class="keyword">for</span> your Python interpreter located at</span><br><span class="line"> <span class="string">&#x27;C:\Users\86135\Desktop\Python\python.exe&#x27;</span>.</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210401213845502.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsaWVuRW93eW5XYW4=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可能因为pip的版本不对<br>我们在cmd中输入</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip show pip</span><br></pre></td></tr></table></figure><p>即会出现<br><img src="https://img-blog.csdnimg.cn/20210401213942598.png" alt="在这里插入图片描述"><br>按照提示操作解决就可以<br><strong>from … import 语句</strong><br>Python 的 from 语句让你从模块中导入一个指定的部分到当前命名空间中，语法如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> modname <span class="keyword">import</span> name1[, name2[, ... nameN]]</span><br></pre></td></tr></table></figure><p>例如，要导入模块 fibo 的 fib 函数，使用如下语句：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fibo <span class="keyword">import</span> fib, fib2</span><br><span class="line">fib(<span class="number">500</span>)</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">5</span> <span class="number">8</span> <span class="number">13</span> <span class="number">21</span> <span class="number">34</span> <span class="number">55</span> <span class="number">89</span> <span class="number">144</span> <span class="number">233</span> <span class="number">377</span></span><br></pre></td></tr></table></figure><p>这个声明不会把整个fibo模块导入到当前的命名空间中，它只会将fibo里的fib函数引入进来。<br>输出base64格式转换过后的字符串（使用pybase64库）（t为待输出的变量值）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(pybase64.b64encode(t.encode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br></pre></td></tr></table></figure><h3 id="PY3的输入输出"><a href="#PY3的输入输出" class="headerlink" title="PY3的输入输出"></a>PY3的输入输出</h3><p>Python两种输出值的方式: 表达式语句和 print() 函数。<br>第三种方式是使用文件对象的 write() 方法，标准输出文件可以用 sys.stdout 引用。<br>如果你希望输出的形式更加多样，可以使用 str.format() 函数来格式化输出值。<br>如果你希望将输出的值转成字符串，可以使用 repr() 或 str() 函数来实现。</p><ul><li>str()： 函数返回一个用户易读的表达形式。</li><li>repr()： 产生一个解释器易读的表达形式。<h3 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h3>a)Python eval() 函数<br>eval() 函数用来执行一个字符串表达式，并返回表达式的值。<br>以下是 eval() 方法的语法:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(expression[, <span class="built_in">globals</span>[, <span class="built_in">locals</span>]])</span><br></pre></td></tr></table></figure><ul><li>expression – 表达式。</li><li>globals – 变量作用域，全局命名空间，如果被提供，则必须是一个字典对象。</li><li>locals – 变量作用域，局部命名空间，如果被提供，可以是任何映射对象。</li></ul><p>返回表达式计算结果。<br>以下展示了使用 eval() 方法的实例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">7</span></span><br><span class="line"><span class="built_in">eval</span>( <span class="string">&#x27;3 * x&#x27;</span> )</span><br><span class="line"><span class="number">21</span></span><br></pre></td></tr></table></figure><p>b)Python format 格式化函数<br>Python2.6 开始，新增了一种格式化字符串的函数 str.format()，它增强了字符串格式化的功能。<br>基本语法是通过 {} 和 : 来代替以前的 % 。<br>format 函数可以接受不限个参数，位置可以不按顺序。<br>实例</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>)    <span class="comment"># 不设置指定位置，按默认顺序</span></span><br><span class="line"><span class="string">&#x27;hello world&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;0&#125; &#123;1&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>)  <span class="comment"># 设置指定位置</span></span><br><span class="line"><span class="string">&#x27;hello world&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;1&#125; &#123;0&#125; &#123;1&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>)  <span class="comment"># 设置指定位置</span></span><br><span class="line"><span class="string">&#x27;world hello world&#x27;</span></span><br></pre></td></tr></table></figure><p>C)Python异常</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        x = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入一个数字: &quot;</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        print(<span class="string">&quot;您输入的不是数字，请再次尝试输入！&quot;</span>)</span><br></pre></td></tr></table></figure><p>例如</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        num=<span class="built_in">float</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入一个数字：&#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> num==<span class="number">0</span>:</span><br><span class="line">            print(<span class="string">&#x27;输入的数字是零&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> num&gt;<span class="number">0</span>:</span><br><span class="line">            print(<span class="string">&#x27;输入的数字是正数&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;输入的数字是负数&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        print(<span class="string">&#x27;输入无效，需要输入一个数字&#x27;</span>)</span><br></pre></td></tr></table></figure><p>d)Python ASCII码与字符相互转换<br>以下代码用于实现ASCII码与字符相互转换：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Filename : test.py</span></span><br><span class="line"><span class="comment"># author by : www.runoob.com</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 用户输入字符</span></span><br><span class="line">c = <span class="built_in">input</span>(<span class="string">&quot;请输入一个字符: &quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 用户输入ASCII码，并将输入的数字转为整型</span></span><br><span class="line">a = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入一个ASCII码: &quot;</span>))</span><br><span class="line"> </span><br><span class="line">print( c + <span class="string">&quot; 的ASCII 码为&quot;</span>, <span class="built_in">ord</span>(c))</span><br><span class="line">print( a , <span class="string">&quot; 对应的字符为&quot;</span>, <span class="built_in">chr</span>(a))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>执行以上代码输出结果为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python3 test.py </span><br><span class="line">请输入一个字符: a</span><br><span class="line">请输入一个ASCII码: <span class="number">101</span></span><br><span class="line">a 的ASCII 码为 <span class="number">97</span></span><br><span class="line"><span class="number">101</span>  对应的字符为 e</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="Python" scheme="http://example.com/categories/Python/"/>
    
    
    <category term="Python" scheme="http://example.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Python-02Start</title>
    <link href="http://example.com/2021/04/01/Python-02Start/"/>
    <id>http://example.com/2021/04/01/Python-02Start/</id>
    <published>2021-04-01T13:23:37.861Z</published>
    <updated>2021-04-01T13:24:44.535Z</updated>
    
    <content type="html"><![CDATA[<p><escape><a id="more"></a></escape> </p><p>学习资料来自于菜鸟教程，做个学习记录<br>1）if 语句<br>Python中if语句的一般形式如下所示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> condition_1:</span><br><span class="line">    statement_block_1</span><br><span class="line"><span class="keyword">elif</span> condition_2:</span><br><span class="line">    statement_block_2</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    statement_block_3</span><br></pre></td></tr></table></figure><p>2）while 循环<br>Python 中 while 语句的一般形式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> 判断条件(condition)：</span><br><span class="line">    执行语句(statements)……</span><br></pre></td></tr></table></figure><p>在 Python 中没有 do..while 循环。<br>3）while 循环使用 else 语句<br>在 while … else 在条件语句为 false 时执行 else 的语句块。<br>语法格式如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> &lt;expr&gt;:</span><br><span class="line">    &lt;statement(s)&gt;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    &lt;additional_statement(s)&gt;</span><br></pre></td></tr></table></figure><p>4）for 语句<br>Python for循环可以遍历任何序列的项目，如一个列表或者一个字符串。<br>for循环的一般格式如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> &lt;variable&gt; <span class="keyword">in</span> &lt;sequence&gt;:</span><br><span class="line">    &lt;statements&gt;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    &lt;statements&gt;</span><br></pre></td></tr></table></figure><p>5）range()函数<br>如果需要遍历数字序列，可以使用内置range()函数。它会生成数列。<br>可以结合range()和len()函数以遍历一个序列的索引,如下所示:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Baidu&#x27;</span>, <span class="string">&#x27;Runoob&#x27;</span>, <span class="string">&#x27;Taobao&#x27;</span>, <span class="string">&#x27;QQ&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">     print(i, a[i])</span><br><span class="line"> </span><br><span class="line"><span class="number">0</span> Google</span><br><span class="line"><span class="number">1</span> Baidu</span><br><span class="line"><span class="number">2</span> Runoob</span><br><span class="line"><span class="number">3</span> Taobao</span><br><span class="line"><span class="number">4</span> QQ</span><br></pre></td></tr></table></figure><p>6）break和while<br>break 语句可以跳出 for 和 while 的循环体。如果你从 for 或 while 循环中终止，任何对应的循环 else 块将不执行。<br>continue 语句被用来告诉 Python 跳过当前循环块中的剩余语句，然后继续进行下一轮循环。<br>while 中使用 break：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">5</span></span><br><span class="line"><span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">    n -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(n)</span><br><span class="line">print(<span class="string">&#x27;循环结束。&#x27;</span>)</span><br></pre></td></tr></table></figure><p>输出结果为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line">循环结束。</span><br></pre></td></tr></table></figure><p>while 中使用 continue：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">5</span></span><br><span class="line"><span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">    n -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    print(n)</span><br><span class="line">print(<span class="string">&#x27;循环结束。&#x27;</span>)</span><br></pre></td></tr></table></figure><p>输出结果为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">循环结束。</span><br></pre></td></tr></table></figure><p>7）函数<br>Python 定义函数使用 def 关键字，一般格式如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> 函数名（参数列表）:</span></span><br><span class="line">    函数体</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算面积函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">area</span>(<span class="params">width, height</span>):</span></span><br><span class="line">    <span class="keyword">return</span> width * height</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_welcome</span>(<span class="params">name</span>):</span></span><br><span class="line">    print(<span class="string">&quot;Welcome&quot;</span>, name)</span><br><span class="line"> </span><br><span class="line">print_welcome(<span class="string">&quot;Runoob&quot;</span>)</span><br><span class="line">w = <span class="number">4</span></span><br><span class="line">h = <span class="number">5</span></span><br><span class="line">print(<span class="string">&quot;width =&quot;</span>, w, <span class="string">&quot; height =&quot;</span>, h, <span class="string">&quot; area =&quot;</span>, area(w, h))</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;escape&gt;</summary>
    
    
    
    <category term="Python" scheme="http://example.com/categories/Python/"/>
    
    
    <category term="Python" scheme="http://example.com/tags/Python/"/>
    
  </entry>
  
</feed>
